<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Connect IQ Core Topics</title>
	<meta name="author" content="Garmin International"/>
	<meta name="date" content="July 10, 2020"/>
	<link type="text/css" rel="stylesheet" href="resources/programmers-guide/style.css"/>
	<meta name="copyright" content="Connect IQ Core Topics version 3.2, Copyright 2020 Garmin, International."/>
</head>
<body>

<link href="resources/programmers-guide/google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
<script src="resources/programmers-guide/jquery-1.11.3.min.js"></script>
<script>
    $(document).ready( function() {
        $( 'pre' ).addClass( 'prettyprint' );
    } );
</script>
<script src="resources/programmers-guide/google-code-prettify/run_prettify.js"></script>
<div id="connect_iq_logo">
<figure>
<img src="resources/programmers-guide/connect_iq_logo.png" style="max-width:471px;" title="Powered by Garmin" />
</figure>
</div>
<div id="title">Connect IQ Core Topics</div>
<div id="tagline">Fundamentals of the Connect IQ Platform</div>
<div class="clear"></div>

<h1 id="tableofcontents">Table of Contents</h1>
<div id="toc">

<p>{{core_topics_toc.md}}</p>
</div>

<h1 id="overview">Overview</h1>

<p>This section covers the core topics of the Connect IQ platform.</p>

<h2 id="connectiqsystem">Connect IQ System</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Application Manifest</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#manifestfileandpermissions">Manifest</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Application Permissions</td>
	<td style="text-align:center;"><a href="#permissions">Permissions</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Application Module</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#applicationandsystemmodules">Application Module</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Application/AppBase.html"><code>Application.AppBase</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">System Module</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#system">System</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/System.html">Toybox.System</a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Properties</td>
	<td style="text-align:center;"><a href="#properties">Properties</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Application/Properties.html"><code>Application.Properties</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Settings</td>
	<td style="text-align:center;"><a href="#settings">Settings</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Application/Properties.html"><code>Application.Properties</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Persisting Data</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#persistingdata">Persisting Data</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Application/Properties.html"><code>Application.Properties</code></a>, <a href="./doc/Toybox/Application/Storage.html"><code>Application.Storage</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Build Configuration</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#buildconfiguration">Build Configuration</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Security</td>
	<td style="text-align:center;"><a href="#security">Security</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Intents</td>
	<td style="text-align:center;"><a href="#intents">Intents</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/System.html"><code>Toybox.System</code></a></td>
	<td style="text-align:center;">2.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Background Services</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#backgroundservices">Background Services</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Background.html"><code>Toybox.Background</code></a>, <a href="./doc/Toybox/System/ServiceDelegate.html"><code>System.ServiceDelegate</code></a></td>
	<td style="text-align:center;">2.3.0</td>
</tr>
</tbody>
</table>

<h2 id="userinterface">User Interface</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Views</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#viewsdrawablesandlayers">Views</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/View.html"><code>WatchUi.View</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Drawables</td>
	<td style="text-align:center;"><a href="#drawables">Drawables</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Drawable.html"><code>WatchUi.Drawable</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Resources</td>
	<td style="text-align:center;"><a href="#resources">Resources</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/BitmapResource.html"><code>WatchUi.BitmapResource</code></a>, <a href="./doc/Toybox/WatchUi/FontResource.html"><code>WatchUi.FontResource</code></a>, <a href="./doc/Toybox/WatchUi/AnimationResource.html"><code>WatchUi.AnimationResource</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Localized Strings</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#strings">Strings</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Graphics</td>
	<td style="text-align:center;"><a href="#graphics">Graphics</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Graphics.html"><code>Toybox.Graphics</code></a> <a href="./doc/Toybox/Graphics/Dc.html"><code>Graphics.Dc</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Input Handling</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#inputhandling">Input Handling</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/InputDelegate.html"><code>WatchUi.InputDelegate</code></a>, <a href="./doc/Toybox/WatchUi/BehaviorDelegate.html"><code>WatchUi.BehaviorDelegate</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Selectables and Buttons</td>
	<td style="text-align:center;"><a href="#selectables">Selectables</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Selectable.html"><code>WatchUi.Selectable</code></a>, <a href="./doc/Toybox/WatchUi/Button.html"><code>WatchUi.Button</code></a></td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Layers</td>
	<td style="text-align:center;"><a href="#layers">Layers</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Layer.html"><code>WatchUi.Layer</code></a></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Animations</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#animationlayer">Animation</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/AnimationLayer.html"><code>WatchUi.AnimationLayer</code></a></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Watch Face and Data Field on Device Settings</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#ondevicewatchfaceanddatafieldsettings">On Device Settings</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Application/AppBase.html#getSettingsView-instance_function"><code>WatchUi.getSettingsView</code></a></td>
	<td style="text-align:center;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Antialiased Draw Primitives</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#anti-aliasing">Antialiasing</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Graphics/Dc.html#setAntiAlias-instance_function"><code>Dc.setAntiAlias()</code></a></td>
	<td style="text-align:center;">3.2.0</td>
</tr>
</tbody>
</table>

<h2 id="layouts">Layouts</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Creating a Layout</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#layouts">Creating a Layout</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Label</td>
	<td style="text-align:center;"><a href="#label">Label</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Text.html"><code>WatchUi.Text</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Drawables</td>
	<td style="text-align:center;"><a href="#drawables">Drawables</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Drawable.html"><code>WatchUi.Drawable</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Drawable Lists</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#drawablelist">Drawable Lists</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Drawable.html"><code>WatchUi.Drawable</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Shapes</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#shape">Shapes</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Drawable.html"><code>WatchUi.Drawable</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Bitmaps</td>
	<td style="text-align:center;"><a href="#bitmaps">Bitmaps</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Bitmap.html"><code>WatchUi.Bitmap</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Custom Drawables</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#customdrawables">Custom Drawables</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Drawable.html"><code>WatchUi.Drawable</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Text Area</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#textarea">Text Area</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/TextArea.html"><code>WatchUi.TextArea</code></a></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
</tbody>
</table>

<h2 id="views">Views</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Views</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#viewsdrawablesandlayers">Views</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/View.html"><code>WatchUi.View</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Confirmation Dialog</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#confirmationdialog">Confirmation Dialog</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Confirmation.html"><code>WatchUi.Confirmation</code></a>, <a href="./doc/Toybox/WatchUi/ConfirmationDelegate.html"><code>WatchUi.ConfirmationDelegate</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Generic Picker</td>
	<td style="text-align:center;"><a href="#genericpicker">Generic Picker</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Picker.html"><code>WatchUi.Picker</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Progress Bar</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#progressbar">Progress Bar</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/ProgressBar.html"><code>WatchUi.ProgressBar</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Menu</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#menu">Menu</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Menu.html"><code>WatchUi.Menu</code></a>, <a href="./doc/Toybox/WatchUi/MenuInputDelegate.html"><code>WatchUi.MenuInputDelegate</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Menu2</td>
	<td style="text-align:center;"><a href="#menu2">Menu2</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Menu.html"><code>WatchUi.Menu2</code></a>, <a href="./doc/Toybox/WatchUi/MenuInputDelegate.html"><code>WatchUi.Menu2InputDelegate</code></a></td>
	<td style="text-align:center;">3.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Map Views</td>
	<td style="text-align:center;"><a href="#mapping">Mapping</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/MapView.html"><code>WatchUi.MapView</code></a>, <a href="./doc/Toybox/WatchUi/MapTrackView.html"><code>WatchUi.MapTrackView</code></a></td>
	<td style="text-align:center;">3.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Glances</td>
	<td style="text-align:center;"><a href="#glances">Glances</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/GlanceView.html"><code>WatchUi.GlanceView</code></a></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Alerts</td>
	<td style="text-align:center;"><a href="#alerts">Alerts</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/DataFieldAlert.html"><code>WatchUi.DataFieldAlert</code></a></td>
	<td style="text-align:center;">3.2.0</td>
</tr>
</tbody>
</table>

<h2 id="communication">Communication</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Mobile SDK</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#mobilesdkforios">iOS</a>, <a href="./CoreTopics.html#mobilesdkforandroid">Android</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Communications.html#registerForPhoneAppMessages-instance_function"><code>Communications.registerForPhoneAppMessages()</code></a>, <a href="./doc/Toybox/Communications.html#transmit-instance_function"><code>Communications.transmit()</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">JSON REST Requests</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#jsonrestrequests">JSON REST Requests</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Communications.html#makeWebRequest-instance_function"><code>Communications.makeWebRequest()</code></a></td>
	<td style="text-align:center;">1.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">OAUTH</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#authenticatedwebservices">OAUTH</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Communications.html#makeOAuthRequest-instance_function"><code>Communications.makeOAuthRequest()</code></a></td>
	<td style="text-align:center;">1.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Opening Web Pages on Mobile</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#directinguserstowebcontent">Open Web Page</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/WatchUi/Communications.html#openWebPage-instance_function"><code>Communications.openWebPage()</code></a></td>
	<td style="text-align:center;">1.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Downloading Content</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#downloadingcontent">Downloading Content</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/PersistedContent.html"><code>Toybox.PersistedContent</code></a></td>
	<td style="text-align:center;">2.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Downloading over Wi-Fi</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#wifibulkdownloads">Wi-Fi Bulk Downloads</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/SyncDelegate.html"><code>Communications.SyncDelegate</code></a></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
</tbody>
</table>

<h2 id="lowpowerwirelesscommunication">Low Power Wireless Communication</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">ANT</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#genericantchannels">Generic ANT Channels</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Ant.html"><code>Toybox.Ant</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">ANT Burst Data</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#burstdata">Burst Data</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Ant/BurstPayload.html"><code>Ant.BurstPayload</code></a></td>
	<td style="text-align:center;">2.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">ANT Plus</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#antprofiles">Ant Plus</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/AntPlus.html"><code>Toybox.AntPlus</code></a></td>
	<td style="text-align:center;">2.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Bluetooth Low Energy</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#gettingstartedwithconnectiqbledevelopment">Bluetooth Low Energy</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/BluetoothLowEnergy.html"><code>Toybox.BluetoothLowEnergy</code></a></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
</tbody>
</table>

<h2 id="sensors">Sensors</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Activity Recording</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#activityrecording">Activity Recording</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/ActivityRecording.html"><code>Toybox.ActivityRecording</code></a>, <a href="./doc/Toybox/FitContributor.html"><code>Toybox.FitContributor</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">FIT Developer Fields</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#fitdeveloperfields">Developer Fields</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/ActivityRecording.html"><code>Toybox.ActivityRecording</code></a>, <a href="./doc/Toybox/FitContributor.html"><code>Toybox.FitContributor</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Heart Rate</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensors">Sensors</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensor.html#enableSensorEvents-instance_function"><code>Sensor.enableSensorEvents()</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Temperature</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensors">Sensors</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensor.html#enableSensorEvents-instance_function"><code>Sensor.enableSensorEvents()</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Altitude</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensors">Sensors</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensor.html#enableSensorEvents-instance_function"><code>Sensor.enableSensorEvents()</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Pressure</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensors">Sensors</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensor.html#enableSensorEvents-instance_function"><code>Sensor.enableSensorEvents()</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Oxygen Saturation</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensors">Sensors</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensor.html#enableSensorEvents-instance_function"><code>Sensor.enableSensorEvents()</code></a></td>
	<td style="text-align:center;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Body Battery</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensorhistory">Body Battery</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/SensorHistory.html#getBodyBatteryHistory-instance_function"><code>SensorHistory.getBodyBatteryHistory()</code></a></td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Stress</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#sensorhistory">Stress</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/SensorHistory.html#getStressHistory-instance_function"><code>SensorHistory.getStressHistory()</code></a></td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Positioning</td>
	<td style="text-align:center;"><a href="#positioning">Positioning</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Positioning.html"><code>Toybox.Positioning</code></a></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Accelerometer</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#highfrequencydata">Accelerometer</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensors.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a></td>
	<td style="text-align:center;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Magnetometer</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#highfrequencydata">Magnetometer</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensors.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a></td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Gyroscope</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#highfrequencydata">Gyroscope</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Sensors.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a></td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Weather</td>
	<td style="text-align:center;"><a href="#weather">Weather</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Weather.html"><code>Toybox.Weather</code></a></td>
	<td style="text-align:center;">3.2.0</td>
</tr>
</tbody>
</table>

<h2 id="developerlifecycle">Developer Lifecycle</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Topic</th>
	<th style="text-align:center;">Section</th>
	<th style="text-align:center;">API</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Libraries (Monkey Barrels)</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#shareablelibraries">Shareable Libraries</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Debugging</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#testinganddebugging">Testing and Debugging</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Unit Testing</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#unittesting">Unit Testing</a></td>
	<td style="text-align:center;"><a href="./doc/Toybox/Test.html"><code>Toybox.Test</code></a></td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Publishing to the Store</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#publishingtotheconnectiqstore">Publishing to the Store</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Beta Apps</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#betaapps">Beta Apps</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Trial Apps</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#apptrials">Trial Apps</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Exception Reporting</td>
	<td style="text-align:center;"><a href="./CoreTopics.html#errorreportingtoolera">Exception Reporting Tool</a></td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;">3.1.0</td>
</tr>
</tbody>
</table>

<h1 id="manifestfileandpermissions">Manifest File and Permissions</h1>
<figure>
<img src="./resources/programmers-guide/wizard-monkey.png" style="max-width:300px;" title="Sometimes fixing bugs requires a little magic." />
</figure>

<p>All Connect IQ apps require a manifest file. The manifest file is an XML file that specifies application properties like the application type and the supported products. The manifest file is generated automatically when you create a project.</p>

<p>All the sections of the <code>manifest.xml</code> can be edited in the Monkey C Extension manifest editor. The <em>Edit as XML</em> option will allow you access to the underlying definitions.</p>

<h2 id="applicationattributes">Application Attributes</h2>

<p>The <code>application</code> element has a number of important attributes. The <code>id</code> field is a 128-bit UUID identifier. Unique identifiers can be generated with the <a href="http://www.uuidgenerator.net/version4">UUID Generator</a> or with standard tools.</p>

<p>The <code>entry</code> attribute must specify the <a href="./doc/Toybox/Application/AppBase.html"><code>Application.AppBase</code></a> object for your application.</p>

<p>The <code>name</code> and <code>launcherIcon</code> attributes must specify a resource ID that is defined in the app resources. The <code>name</code> must reference a <code>string</code> entry in your strings resources, and the <code>launcherIcon</code> must reference a bitmap resource. See the <a href="./CoreTopics.html#resources">Resources</a> for more information. Note that the icon resource should not be re-used within your application; use a duplicate resource if you want to use the icon within the app.</p>

<p>If you specify a <code>launcherIcon</code>, the system will resource compiler will auto size the resource to match the product icon size. If a <code>launcherIcon</code> isn&#8217;t specified, a default icon will be compiled into the application.</p>

<p>The <code>type</code> field specifies what kind of application you are developing. Currently, Connect IQ supports five types of apps:</p>

<ol>
<li><code>watchface</code></li>
<li><code>datafield</code></li>
<li><code>widget</code></li>
<li><code>watch-app</code></li>
<li><code>audio-content-provider-app</code></li>
</ol>

<p>The app type specified in the manifest file determines where your app appears on the device and which APIs the app can use.</p>

<p>The <code>minApiLevel</code> field specifies the minimum Connect IQ API level that your app is compatible with. It serves to prevent you from targeting incompatible devices. The Monkey C extension allows you to select a minimum API level when creating a new app or editing the properties of an existing one. The micro version is written out to the manifest at version 1 (1.2.1 for example), but only the major and minor versions are considered when determining device support.</p>

<p>Every application must include an <a href="./doc/Toybox/Application/AppBase.html"><code>AppBase</code></a> object, which serves as the entry point for your application. The Monkey C extension will generate an <a href="./doc/Toybox/Application/AppBase.html"><code>AppBase</code></a> object when a project is created.</p>

<p>An <a href="./doc/Toybox/Application/AppBase.html"><code>AppBase</code></a> object should override <a href="./doc/Toybox/Application/AppBase.html#getInitialView-instance_function"><code>AppBase.getInitialView()</code></a> to provide the view object to initially push. An array must be returned with either a view and a delegate, or just a one element array with the <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a> object:</p>

<pre><code class="java">return [ new MyView(), new MyDelegate() ];
</code></pre>

<h2 id="products">Products</h2>

<p>Garmin makes a wide variety of products for many use cases, and Monkey C makes it easy to write for all our Connect IQ compatible devices. Monkey C asks the developer which Connect IQ devices they choose to support because it is impossible to know whether a future product may be incompatible with your app. As new Connect IQ compatible products appear on the market, the simulator will be updated to support them so developers can decide whether to support them.</p>

<p>Products supported by an app are listed in the <code>products</code> block of the manifest file:</p>

<pre><code class="xml">&lt;iq:products&gt;
    &lt;iq:product id=&quot;round-watch&quot;/&gt;
&lt;/iq:products&gt;
</code></pre>

<h2 id="permissions">Permissions</h2>

<p>Certain modules expose personal information about the user or expose communication to the internet. To use these modules, permission must be requested from the user at the time of installation. To request permission, the module name must be added to the permissions list of the manifest file.</p>

<p>More modules may be added to this list as modules are added to the API. To request permission, use the following syntax in the manifest file:</p>

<pre><code class="xml">&lt;iq:permissions&gt;
    &lt;iq:uses-permission id=&quot;Sensor&quot;/&gt;
&lt;/iq:permissions&gt;
</code></pre>

<p>The following permissions are available:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Permission</th>
	<th>Applicable Modules</th>
	<th>API Level</th>
	<th>Watch Face</th>
	<th>Data Field</th>
	<th>Widget</th>
	<th>App</th>
	<th>Audio Content Provider</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Ant</td>
	<td><a href="./doc/Toybox/Ant.html"><code>Ant</code></a></td>
	<td>1.0.0</td>
	<td></td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>Background</td>
	<td><a href="./doc/Toybox/Background.html"><code>Background</code></a></td>
	<td>2.3.0</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>BluetoothLowEnergy</td>
	<td><a href="./doc/Toybox/BluetoothLowEnergy.html"><code>BluetoothLowEnergy</code></a></td>
	<td>3.1.0</td>
	<td></td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>Communications</td>
	<td><a href="./doc/Toybox/Communications.html"><code>Communications</code></a>, <a href="./doc/Toybox/Authentication.html"><code>Authentication</code></a></td>
	<td>1.0.0</td>
	<td>x<a href="#fn:1" id="fnref:1" title="see footnote" class="footnote">[1]</a></td>
	<td>x<a href="#fn:1" title="see footnote" class="footnote">[1]</a></td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>ComplicationProvider</td>
	<td><a href="./doc/Toybox/Complications.html"><code>Complications</code></a></td>
	<td>4.1.0</td>
	<td></td>
	<td></td>
	<td></td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>ComplicationSubscriber</td>
	<td><a href="./doc/Toybox/Complications.html"><code>Complications</code></a></td>
	<td>4.1.0</td>
	<td>x</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Data Field Alert</td>
	<td><a href="./doc/Toybox/WatchUi/DataFieldAlert.html"><code>DataFieldAlert</code></a></td>
	<td>3.2.0</td>
	<td></td>
	<td>x</td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>Fit</td>
	<td><a href="./doc/Toybox/ActivityRecording.html"><code>ActivityRecording</code></a>, <a href="./doc/Toybox/FitContributor.html"><code>FitContributor</code></a></td>
	<td>1.0.0</td>
	<td></td>
	<td></td>
	<td></td>
	<td>x</td>
	<td></td>
</tr>
<tr>
	<td>PersistedContent</td>
	<td><a href="./doc/Toybox/PersistedContent.html"><code>PersistedContent</code></a></td>
	<td>2.2.0</td>
	<td></td>
	<td></td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>Positioning</td>
	<td><a href="./doc/Toybox/Position.html#getInfo-instance_method"><code>Positioning.getInfo()</code></a>, <a href="./doc/Toybox/Position.html#enableLocationEvents-instance_method"><code>Positioning.enableLocationEvents()</code></a></td>
	<td>1.0.0</td>
	<td>x<a href="#fn:2" id="fnref:2" title="see footnote" class="footnote">[2]</a></td>
	<td>x<a href="#fn:2" title="see footnote" class="footnote">[2]</a></td>
	<td>x</td>
	<td>x</td>
	<td>x<a href="#fn:2" title="see footnote" class="footnote">[2]</a></td>
</tr>
<tr>
	<td>Sensor</td>
	<td><a href="./doc/Toybox/Sensor.html"><code>Sensor</code></a></td>
	<td>1.0.0</td>
	<td></td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>SensorHistory</td>
	<td><a href="./doc/Toybox/SensorHistory.html"><code>SensorHistory</code></a></td>
	<td>2.1.0</td>
	<td></td>
	<td></td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
<tr>
	<td>SensorLogging</td>
	<td><a href="./doc/Toybox/SensorLogging.html"><code>SensorLogging</code></a></td>
	<td>2.3.0</td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
</tr>
<tr>
	<td>UserProfile</td>
	<td><a href="./doc/Toybox/UserProfile.html"><code>UserProfile</code></a></td>
	<td>1.0.0</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
	<td>x</td>
</tr>
</tbody>
</table>

<p>Some products provide separation between activities and apps. If your app has the <code>Fit</code> permission, it will show in the Activities list.</p>

<h2 id="languages">Languages</h2>

<p>Connect IQ apps can be localized across over 30 languages, and the languages your app support can impact what regions of the world your app is available in. In the manifest you can declare the languages your app supports, which will be used when exporting your application to the store. See <a href="./CoreTopics.html#strings">Resources</a> for more information.</p>

<h2 id="dependencies">Dependencies</h2>

<p>If your app links to other libraries, they must be declared in the manifest:</p>

<pre><code class="xml">&lt;iq:barrels&gt;
    &lt;iq:depends name=&quot;Barcode&quot; version=&quot;2.0.0&quot;/&gt;
&lt;/iq:barrels&gt;
</code></pre>

<p>The options for each barrel are as follows:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Option</th>
	<th style="text-align:center;">Type</th>
	<th style="text-align:left;">Value</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>name</code></td>
	<td style="text-align:center;"><code>string</code></td>
	<td style="text-align:left;">The declared namespace Module name for the monkey barrel.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>version</code></td>
	<td style="text-align:center;"><code>a.b.c.d</code> (Optional)</td>
	<td style="text-align:left;">The declared version number for the monkey barrel.</td>
</tr>
</tbody>
</table>

<p><code>a</code>, <code>b</code> and <code>c</code> must be numbers. <code>d</code> is an optional alpha-numeric string of <code>A-Z</code>, <code>a-z</code>, <code>0-9</code>, and <code>_</code>.</p>

<p>If a version is specified, the build system will enforce that library version being used. These rules can be modified with the following options:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Format</th>
	<th style="text-align:left;">Meaning</th>
	<th style="text-align:left;">Example</th>
	<th style="text-align:left;">Valid Version</th>
	<th style="text-align:left;">Invalid Version</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Exact</td>
	<td style="text-align:left;">An application links to a specific version of a library</td>
	<td style="text-align:left;"><code>version=&quot;1.2.3&quot;</code></td>
	<td style="text-align:left;">Version <code>1.2.3</code></td>
	<td style="text-align:left;">Any other version</td>
</tr>
<tr>
	<td style="text-align:left;">Greater or Equal</td>
	<td style="text-align:left;">An application links to a library that matches or exceeds the version.</td>
	<td style="text-align:left;"><code>version=&quot;&gt;=1.2.3&quot;</code></td>
	<td style="text-align:left;">Version <code>1.2.3</code> or greater.</td>
	<td style="text-align:left;">Versions <code>1.2.2</code> or less.</td>
</tr>
<tr>
	<td style="text-align:left;">Pessimistic</td>
	<td style="text-align:left;">The application links to a library with a matching major and minor version, but the micro version must match or be greater than the specified version.</td>
	<td style="text-align:left;"><code>version=&quot;~&gt;1.2.3&quot;</code></td>
	<td style="text-align:left;">Versions <code>1.2.3</code>, <code>1.2.4</code>, <code>1.2.5</code>, etc.</td>
	<td style="text-align:left;">Versions <code>1.2.2</code>, <code>1.3.1</code>, etc.</td>
</tr>
<tr>
	<td style="text-align:left;">Whatever</td>
	<td style="text-align:left;">The version of the link library will not be enforced at build time.</td>
	<td style="text-align:left;">No version attribute specified.</td>
	<td style="text-align:left;">Any</td>
	<td style="text-align:left;">N/A</td>
</tr>
</tbody>
</table>

<p>The version can be prefixed with <code>&gt;=</code> to indicate a minimum supported version.</p>

<p>See <a href="./CoreTopics.html/#shareablelibraries">Shareable Libraries</a> for more information.</p>

<h1 id="applicationandsystemmodules">Application and System Modules</h1>

<p>Every application has to have a class that extends <a href="./doc/Toybox/Application/AppBase.html"><code>Application.AppBase</code></a>. This object, known as the application object, is the handler for application lifecycle events.</p>

<p>The Application object must be specified in the application <code>manifest.xml</code>. This is used by the build tools to denote which class to load at startup. See the <a href="./CoreTopics.html#manifestfileandpermissions">Manifest and Permissions</a> section for more information.</p>

<h2 id="installanduninstall">Install and Uninstall</h2>

<p><em>Since API level 3.0.0</em></p>

<p>Your <a href="./doc/Toybox/Application/AppBase.html"><code>AppBase</code></a> has two handlers that are called on during installations and updates:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#onAppInstall-instance_function"><code>AppBase.onAppInstall()</code></a></td>
	<td style="text-align:left;">Callback method that is triggered in the background when the app is installed</td>
	<td style="text-align:left;">3.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#onAppUpdate-instance_function"><code>AppBase.onAppUpdate()</code></a></td>
	<td style="text-align:left;">Callback method that is triggered in the background when the app is updated</td>
	<td style="text-align:left;">3.0.0</td>
</tr>
</tbody>
</table>

<p>Both of these require that your application has the <code>Background</code> permission. Potential use cases include registering a background service on install or starting an authentication method.</p>

<p>These methods are not guaranteed to run. Do not depend on them for essential functionality.</p>

<h2 id="applicationlifecycle">Application Lifecycle</h2>

<p><em>Since API level 4.2.0</em>
There are four main application lifecycle states: launched, active, inactive, and suspended</p>
<figure>
<img src="./resources/programmers-guide/app-lifecycle.png" style="max-width:624px;" title="Life. Death. Monkeys." />
</figure>

<h3 id="launch">Launch</h3>

<p>After your application is loaded, your application object will be instantiated. From that point forward it will be available throughout the application by calling <a href="./doc/Toybox/Application.html#getApp-instance_function"><code>Application.getApp()</code></a>.</p>

<p>After you application object is instantiated, the <a href="./doc/Toybox/Application/AppBase.html#onStart-instance_function"><code>AppBase.onStart(state)</code></a> function will be called. This is your opportunity to initialize the application and restore state.</p>

<p>If your application is launched via an <a href="./doc/Toybox/System/Intent.html"><code>System.Intent</code></a>, the state parameter will contain arguments passed via the intent. Do not attempt to push a <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> instance at this time. See the <a href="./CoreTopics.html#intents">Intents</a> section for more information.</p>

<p>Once your application is loaded, the system will request the initial view for your application. Depending on what functionality your application implements, you may have to implement several of the following handlers:</p>

<ul>
<li><a href="./doc/Toybox/Application/AppBase.html#getInitialView-instance_function"><code>AppBase.getInitialView()</code></a>: The primary method for app startup. Return the base view for your watch face, data field, widget, or device app.</li>
<li><a href="./doc/Toybox/Application/AppBase.html#getGlanceView-instance_function"><code>AppBase.getGlanceView()</code></a>: If your are implementing a widget that has a glance, this will be called when the user goes to browse your glance in the glance list. See the <a href="./CoreTopics.html/#glances">Glances</a> section for more information.</li>
<li><a href="./doc/Toybox/Application/AppBase.html#getGoalView-instance_function"><code>AppBase.getGoalView()</code></a>: If your watch face is overriding the goal views, this gives you an opportunity to present your goal view.</li>
<li><a href="./doc/Toybox/Application/AppBase.html#getPlaybackConfigurationView-instance_function"><code>AppBase.getPlaybackConfigurationView()</code></a>: If you are implementing an audio content provider, this method is called when you need to present playback options to the user.</li>
</ul>

<p>All of these functions return an array: The first item is the <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> instance, and the second is the <a href="./doc/Toybox/WatchUi/InputDelegate.html"><code>WatchUi.InputDelegate</code></a> instance that handles the input for the view.</p>

<p>Apps will behave differently when they are launched from the glance list versus the activity menu. If an app is launched from the glance list, a timeout will be applied to the app. If the user does not exit the app within a given time frame, the system will terminate the app and return to the home screen. If an app is launched from the activity menu, however, it will not time out, and the user must explicitly exit your application.</p>

<p>You can detect which way the user enters your application using the following method:</p>

<pre><code class="typescript">class MySuperApp extends Application.AppBase {
    // if state contains the :resume key and the value
    // is true, then restore app state

    function onStart(state) {
         if ((state != null) &amp;&amp; (state.get(:launchedFromGlance)) {
            // Launched from glance
        } else {
            // Launched from activity menu
        }
    }
}
</code></pre>

<h3 id="activeinactiveandsuspended">Active, Inactive, and Suspended</h3>

<p><em>Since API level 4.2.0</em></p>

<p>Some devices have a task switcher that makes it easy to switch between activities and apps on the device. This can switch your app from <em>active</em> to <em>inactive</em>. To take full advantage of the task switcher, you need to utilize the full app lifecycle.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">State</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Active</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#onActive-instance_function"><code>AppBase.onActive()</code></a> is called when your app is transitioning from the inactive to active state. Active apps have access defined by the app type. When transitioning from inactive to active, access to sensors, ANT/BLE, will be restored.</td>
</tr>
<tr>
	<td style="text-align:left;">Inactive</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#onInactive-instance_function"><code>AppBase.onInactive()</code></a> is called when transitioning from the active to inactive state.</td>
</tr>
</tbody>
</table>

<p>Based on the state your app is running in, you will have different levels of access to system resources:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">State</th>
	<th style="text-align:left;">Active</th>
	<th style="text-align:left;">Inactive</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Activity</td>
	<td style="text-align:left;">With permission, you may be allowed to start and stop activity recording.</td>
	<td style="text-align:left;">If the app is recording an activity, recording will continue. If the app is not recording, it is not allowed to start or stop activity recording.</td>
</tr>
<tr>
	<td style="text-align:left;">GPS</td>
	<td style="text-align:left;">GPS access may be denied if another app is recording an activity.</td>
	<td style="text-align:left;">If the app is recording an activity and receiving position events, it will continue to receive events in the inactive state. If the app is not recording an activity, it is blocked from modifying the GPS state.</td>
</tr>
<tr>
	<td style="text-align:left;">ANT</td>
	<td style="text-align:left;">ANT access may be denied if another app is recording an activity.</td>
	<td style="text-align:left;">If the app is recording an activity, ANT access is permitted. If the app is not recording an activity, all open channels will be closed and will be reopened when transitioning from inactive to active.</td>
</tr>
<tr>
	<td style="text-align:left;">High Frequency Sensors (Accelerometer, Magnetometer, Gyro)</td>
	<td style="text-align:left;">If the app is recording an activity, access is permitted. If the app is not recording an activity, access may fail in a non-fatal way.</td>
	<td style="text-align:left;">If the app is recording an activity, access will be permitted. Otherwise, measurements can be retrieved at a maximum of 10 hz.</td>
</tr>
<tr>
	<td style="text-align:left;">Sensors</td>
	<td style="text-align:left;">If the app is recording an activity, access is permitted. If the app is not recording an activity, access may fail in a non-fatal way.</td>
	<td style="text-align:left;">If the app is recording an activity, access will be permitted. Otherwise, sensor access will be limited.</td>
</tr>
<tr>
	<td style="text-align:left;">Attention</td>
	<td style="text-align:left;">Access is allowed.</td>
	<td style="text-align:left;">Access is denied.</td>
</tr>
</tbody>
</table>

<p>There may be scenarios where the user has launched more apps than the system has resources to support. If your app is not active but is still running, the system may terminate your app to free up resources.</p>

<p>When this happens, your <a href="./doc/Toybox/Application/AppBase.html#onStop-instance_function"><code>AppBase.onStop()</code></a> will be called with a :suspend option to inform you that you are being terminated. You can use this call to persist your state for when you are resumed. When the user returns to your application, you will be called with a <code>:resume</code> option on your <a href="./doc/Toybox/Application/AppBase.html#onStart-instance_function"><code>AppBase.onStart()</code></a>. You can then restore your state from storage:</p>

<pre><code class="typescript">class MyApp  extends Application.AppBase {
    // if state contains the :resume key and the value is true
    // then restore app state
    function onStart(state) {
        if ((state != null) &amp;&amp; (state.get(:resume)) {
                restoreState();
        }
    }

    // if state contains the :suspend key and the value is
    // true, then save app state
     function onStop(state) {
        if ((state != null) &amp;&amp; (state.get(:suspend)) {
            saveState();
        }
    }
}
</code></pre>

<p>If you do nothing, the user will return to your app as if it was just launched.</p>

<h3 id="apptermination">App Termination</h3>

<p>When your application is terminated, the <a href="./doc/Toybox/Application/AppBase.html#onStop-instance_function"><code>AppBase.onStop()</code></a> function is called. This gives your application the option to save state before termination.</p>

<h2 id="system">System</h2>

<p>The <a href="./doc/Toybox/System.html"><code>Toybox.System</code></a> module provides access to the device state, settings, and metadata<a href="#fn:3" id="fnref:3" title="see footnote" class="footnote">[3]</a>. Here you can get runtime information about the device that is running your app, and exercise some execution control.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#error-instance_function"><code>System.error()</code></a></td>
	<td style="text-align:left;">Write an error to the console and exit the system</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#exit-instance_function"><code>System.exit()</code></a></td>
	<td style="text-align:left;">End execution of the current app</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#exitTo-instance_function"><code>System.exitTo()</code></a></td>
	<td style="text-align:left;">Exit the current app and launch a new app</td>
	<td style="text-align:left;">2.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#getClockTime-instance_function"><code>System.getClockTime()</code></a></td>
	<td style="text-align:left;">Get the current clock time</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#getDeviceSettings-instance_function"><code>System.getDeviceSettings()</code></a></td>
	<td style="text-align:left;">Get the user settings for the device as well as the device metadata<a href="#fn:4" id="fnref:4" title="see footnote" class="footnote">[4]</a></td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#getSystemStats-instance_function"><code>System.getSystemStats()</code></a></td>
	<td style="text-align:left;">Get runtime statistics for your current runtime</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#isAppInstalled-instance_function"><code>System.isAppInstalled()</code></a></td>
	<td style="text-align:left;">Query the system to see if another app is installed</td>
	<td style="text-align:left;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/System.html#print-instance_function"><code>System.print()</code></a>, <a href="./doc/Toybox/System.html#println-instance_function"><code>System.println()</code></a></td>
	<td style="text-align:left;">Writes a message to the console or application log</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
</tbody>
</table>

<h1 id="persistingdata">Persisting Data</h1>

<p>Connect IQ is also able to save data from within an app at runtime. For example, an app may need to obtain or calculate data and store it for later use. This is accomplished by the use of Storage, Properties, and Settings.</p>

<ul>
<li><em>Storage</em> represents data written to disk so it may persist across executions of an application.</li>
<li><em>Properties</em> are constant values defined at build time and included in the executable that are useful for product-specific values that shouldn&#8217;t be defined in code. Properties may also define the default Settings values.</li>
<li><em>Settings</em> are user-editable values modified through Garmin Connect Mobile and Garmin Express. Default settings values are defined by Properties.</li>
</ul>

<h2 id="storage">Storage</h2>

<p>Storage is used for saving and retrieving data from the file system of the device at run time as defined by the developer. This data is only available to the application and is not accessible by the end user. For example, this feature could be used to store a location from when an app was last used. The next time the app is launched, Storage can provide the last known location to the app.</p>

<p>The following data types may be stored:</p>

<ul>
<li><a href="./doc/Toybox/Lang/Number.html"><code>Number</code></a></li>
<li><a href="./doc/Toybox/Lang/Float.html"><code>Float</code></a></li>
<li><a href="./doc/Toybox/Lang/Long.html"><code>Long</code></a></li>
<li><a href="./doc/Toybox/Lang/Double.html"><code>Double</code></a></li>
<li><a href="./doc/Toybox/Lang/Char.html"><code>Char</code></a></li>
<li><a href="./doc/Toybox/Lang/String.html"><code>String</code></a></li>
<li><a href="./doc/Toybox/Lang/Boolean.html"><code>Boolean</code></a></li>
<li><a href="./doc/Toybox/Lang/Array.html"><code>Array</code></a></li>
<li><a href="./doc/Toybox/Lang/Dictionary.html"><code>Dictionary</code></a></li>
</ul>

<p>It is important to note that an <a href="./doc/Toybox/Lang/Array.html"><code>Array</code></a> or <a href="./doc/Toybox/Lang/Dictionary.html"><code>Dictionary</code></a> may only contain the data types listed above. For example, it is not possible to store a <a href="./doc/Toybox/Lang/Symbol.html"><code>Symbol</code></a> in an <a href="./doc/Toybox/Lang/Array.html"><code>Array</code></a> or <a href="./doc/Toybox/Lang/Dictionary.html"><code>Dictionary</code></a> in Storage.</p>

<h2 id="accessingpropertiesandsettings:objectstore">Accessing Properties and Settings: Object Store</h2>

<p>Prior to API level 2.4.0, all content was persisted in the object store. If your app runs on Connect IQ System 1 devices, you will need to use <a href="./doc/Toybox/Application/AppBase.html#getProperty-instance_function"><code>AppBase.getProperty()</code></a> and <a href="./doc/Toybox/Application/AppBase.html#setProperty-instance_function"><code>AppBase.setProperty()</code></a> to persist data. These functions allow access to both settings and persisted data.</p>

<p>The object store is a <a href="./doc/Toybox/Lang/Dictionary.html"><code>Dictionary</code></a> that lives in memory until your app terminates, at which point it is saved to disk. Because the object store costs against your runtime memory, do not use these methods unless you are running on System 1 devices.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#setProperty-instance_function"><code>AppBase.getProperty()</code></a></td>
	<td style="text-align:left;">Retrieve information by key from the object store</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#getProperty-instance_function"><code>AppBase.setProperty()</code></a></td>
	<td style="text-align:left;">Store information by key in the object store</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
</tbody>
</table>

<h2 id="accessingstorage:application.storage">Accessing Storage: <code>Application.Storage</code></h2>

<p><em>Since API level 2.4.0</em></p>

<p>The <a href="./doc/Toybox/Application/Storage.html"><code>Application.Storage</code></a> module manages persistent key-value pair data storage. Information is automatically saved on disk when <a href="./doc/Toybox/Application/Storage.html#setValue-instance_function"><code>Storage.setValue()</code></a> is called. Keys and values are limited to 8 KB each, and a total of 128 KB of storage is available.</p>

<p>For example, an application might save a location for later use with the code below:</p>

<pre><code class="java">Storage.setValue(&quot;location&quot;, locationValue.toDegrees());
</code></pre>

<p>The next time the application is launched, the stored location value can be retrieved and displayed:</p>

<pre><code class="java">var myLastLocation = Application.Storage.getValue(&quot;location&quot;);
dc.drawText(x, y, Graphics.FONT_SMALL, &quot;Last location: &quot; + myLastLocation, Graphics.TEXT_JUSTIFY_LEFT);
</code></pre>

<p>API level 3.2.0 introduced the ability to access the <a href="./doc/Toybox/Application/Storage.html"><code>Storage</code></a> module from background processes. The background process can modify storage using <a href="./doc/Toybox/Application/Storage.html#setValue-instance_function"><code>Storage.setValue()</code></a>, <a href="./doc/Toybox/Application/Storage.html#deleteValue-instance_function"><code>Storage.deleteValue()</code></a> and <a href="./doc/Toybox/Application/Storage.html#clearValue-instance_function"><code>Storage.clearValue()</code></a>. When the storage is written from the background process, <a href="./doc/Toybox/Application/AppBase.html#onStorageChanged-instance_function"><code>AppBase.onStorageChanged()</code></a> callback will be invoked for the foreground process if the background and foreground process are active at the same time and vice-versa. The application would then have to reload data from storage to reflect updated information.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/Storage.html#getValue-instance_function"><code>Storage.getValue()</code></a></td>
	<td style="text-align:left;">Retrieve information by key from persisted storage</td>
	<td style="text-align:left;">2.4.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/Storage.html#setValue-instance_function"><code>Storage.setValue()</code></a></td>
	<td style="text-align:left;">Store information by key in persisted storage</td>
	<td style="text-align:left;">2.4.0</td>
</tr>
</tbody>
</table>

<h2 id="accessingpropertiesandsettings:application.properties">Accessing Properties and Settings: <code>Application.Properties</code></h2>

<p><em>Since API level 2.4.0</em></p>

<p>The <a href="./doc/Toybox/Application/Properties.html"><code>Application.Properties</code></a> module provides an interface for accessing the values and properties of settings. Information is automatically saved on disk when <a href="./doc/Toybox/Application/AppBase.html#onStop-instance_function"><code>AppBase.onStop()</code></a> is called. To get or set a property value use the <a href="./doc/Toybox/Application/Properties.html#getValue-instance_function"><code>Properties.getValue()</code></a> or <a href="./doc/Toybox/Application/AppBase.html#setValue-instance_function"><code>Properties.setValue()</code></a> methods, respectively:</p>

<pre><code class="java">// Set an Object Store app setting
Properties.setValue(&quot;mySetting&quot;, mySetting);

// Get an Object Store app setting value
var mySetting = Properties.getValue(&quot;mySetting&quot;);
</code></pre>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/Properties.html#getValue-instance_function"><code>Properties.getValue()</code></a></td>
	<td style="text-align:left;">Retrieve information by key from properties. Property values must be defined in a resources xml file in a <code>&lt;properties&gt;</code> element. If a key that is not present in application properties is passed to <a href="./doc/Toybox/Application/Properties.html#getValue-instance_function"><code>Properties.getValue()</code></a>, an exception will be thrown</td>
	<td style="text-align:left;">2.4.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/Properties.html#setValue-instance_function"><code>Properties.setValue()</code></a></td>
	<td style="text-align:left;">Store information by key in persisted storage. Property values must be defined in the resource xml file in a <code>&lt;properties&gt;</code> element. If a key that is not present in application properties is passed to <a href="./doc/Toybox/Application/Properties.html#setValue-instance_function"><code>Properties.setValue()</code></a>, an exception will be thrown</td>
	<td style="text-align:left;">2.4.0</td>
</tr>
</tbody>
</table>

<h2 id="whichapishouldiuse">Which API Should I Use?</h2>

<p>If your app runs on devices at API level 2.4.0 or above, <a href="./doc/Toybox/Application/Storage.html"><code>Storage</code></a> offers a superior solution for persisting application data compared to the Object Store. Using the newer APIs in an existing app is simply a matter of updating code to call the new methods. However, there are a couple of important things of which to be aware:</p>

<ol>
<li><p>Object Store data files are not converted to the new format.</p>

<p>If an app used storage prior to API level 2.4.0, existing properties will not automatically migrate to the new file format used by the <a href="./doc/Toybox/Application/Storage.html"><code>Storage</code></a> module. If a conversion is needed, an app must include a routine to get the data from the old files and store it in the new format.</p></li>
<li><p><a href="./doc/Toybox/Application/Properties.html"><code>Properties</code></a> will throw an exception if attempting to write to an undefined property. Prior to API level 2.4.0, an attempt to write to an undefined property would result in a value written to storage (the .STR file) since <a href="./doc/Toybox/Application/AppBase.html#getProperty-instance_function"><code>getProperty()</code></a> and <a href="./doc/Toybox/Application/AppBase.html#setProperty-instance_function"><code>setProperty()</code></a> were overloaded to function with each of Storage, Properties, and Settings. This behavior will no longer occur when using the <a href="./doc/Toybox/Application/Properties.html"><code>Properties</code></a> module since it is distinct from <a href="./doc/Toybox/Application/Settings.html"><code>Settings</code></a>. Instead, an <a href="./doc/Toybox/Application/Properties/InvalidKeyException.html"><code>InvalidKeyException</code></a> is thrown.</p></li>
</ol>

<p>To maximize the number of supported devices, use a <code>has</code> check to see if the Storage API is available and then call the appropriate methods based on what the device supports:</p>

<pre><code class="typescript">if ( Toybox.Application has :Storage ) {
    // use Application.Storage and Application.Properties methods
} else {
    // use Application.AppBase methods
}
</code></pre>

<p>For more, see the <code>ApplicationStorage</code> sample app distributed with the SDK.</p>

<h1 id="backgroundservices">Background Services</h1>

<p><em>Since API level 2.3.0</em></p>

<p>Applications can register for background services. Services can be registered to run when various events occur. These events include when the user reaches goal targets, when sleep and wake times occur, when a steps threshold is reached, or at a scheduled time. Modules available to background processes differ from those of their parent application.</p>

<p>Services may be terminated at any time free memory for foreground applications. Services will also be terminated automatically if the do not exit properly within 30 seconds of opening.</p>

<h2 id="registeringforevents">Registering for Events</h2>

<p>When your application runs you can register for events your application can subscribe to by using calls in the <a href="./doc/Toybox/Background.html"><code>Toybox.Background</code></a> module.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Event</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:left;">Register With</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Activity Completed</td>
	<td style="text-align:left;">Wakes your background service when the user completes an activity</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForActivityCompletedEvent-instance_method"><code>registerForActivityCompletedEvent</code></a></td>
	<td style="text-align:left;">3.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Goal</td>
	<td style="text-align:left;">Wakes your background service when the user meets one of their activity goals</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForGoalEvent-instance_method"><code>registerForGoalEvent</code></a></td>
	<td style="text-align:left;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">OAUTH Response</td>
	<td style="text-align:left;">Wakes your background service when the user completes the OAUTH flow</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForOauthResponseEvent-instance_method"><code>registerForOauthResponseEvent</code></a></td>
	<td style="text-align:left;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Phone App Message</td>
	<td style="text-align:left;">Wakes your background service when your app receives a message from the Mobile SDK</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForPhoneAppMessageEvent-instance_method"><code>registerForPhoneAppMessageEvent</code></a></td>
	<td style="text-align:left;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Sleep</td>
	<td style="text-align:left;">Wakes your background service at the time the user has configured as their sleep time</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForSleepEvent-instance_method"><code>registerForSleepEvent</code></a></td>
	<td style="text-align:left;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Steps</td>
	<td style="text-align:left;">Wakes your background service every 1000 steps taken by the user</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForStepsEvent-instance_method"><code>registerForStepsEvent</code></a></td>
	<td style="text-align:left;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Temporal</td>
	<td style="text-align:left;">Allows your service to be woken at a specific time or repeatedly at a certain interval (up to every five minutes)</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Background.html#registerForTemporalEvent-instance_method"><code>registerForTemporalEvent</code></a></td>
	<td style="text-align:left;">2.3.0</td>
</tr>
</tbody>
</table>

<h2 id="makingaservicedelegate">Making a <code>ServiceDelegate</code></h2>

<p>When background services are started, the <a href="./doc/Toybox/Application/AppBase.html#getServiceDelegate()"><code>AppBase.getServiceDelegate()</code></a> is called. This method returns a <a href="./doc/Toybox/System/ServiceDelegate.html"><code>System.ServiceDelegate</code></a> and the method corresponding to the event that triggered is invoked. Once a background service has finished any necessary tasks, it should exit using the <a href="./doc/Toybox/Background.html#exit-instance_function"><code>Background.exit()</code></a> method. This method takes a argument containing data to be sent to the main process. Use null to provide no data.</p>

<h3 id="applicationscope">Application Scope</h3>

<p>Background services are allowed to run at any time, including while the user is in an activity. In order to achieve this, the memory pool made available to background services is much smaller than what is available for the application. In many instances, the executable code of your application will be larger than the memory pool available.</p>

<p>The Connect IQ compiler allows you to select what code is necessary for running in the background with the <code>:background</code> annotation. Only modules, classes, functions and member variables decorated with the <code>:background</code> annotation will be compiled into your background service. This means you must decorate all related code with the annotation (including your Application class).</p>

<pre><code class="typescript">import Toybox.Application;
import Toybox.Background;
import Toybox.System;
import Toybox.Time;

// Because this is referenced in the application object
// constructor, it must be marked as background.
(:background)
var globalMember;

// Your application object has to be marked as background
// so that the service delegate can be referenced
(:background)
class MyApp extends Application.AppBase {

    // Constructor. Remember everything referenced in this function
    // must be marked as background
    public function initialize() {
        // Register to run every five minutes
        if(Background.getTemporalEventRegisteredTime() != null) {
            Background.registerForTemporalEvent(new Time.Duration(5 * 60))
        }
        // Initialize a global member
        $.globalMember = true;
    }

    public function getServiceDelegate() as [System.ServiceDelegate] {
        return [new MyServiceDelegate()];
    }

}

// Your service delegate has to be marked as background
// so it can handle your service callbacks
(:background)
class MyServiceDelegate extends System.ServiceDelegate {

    public function onTemporalEvent() as Void {
        // Do fun stuff here
    }

}
</code></pre>

<p>If your type check level is at <code>gradual</code> or above, the compiler will detect if your background service or any objects referenced is attempting to reference something not marked as background. See <a href="./LearningMonkeyC.html/#monkeytypes">Monkey Types</a> for more information.</p>

<p>The resource compiler can control the scope level of your resources as well. See the <a href="./CoreTopics.html#resourcescope">Resources</a> section for more information.</p>

<h2 id="simulatingbackgroundservices">Simulating Background Services</h2>

<p>In the Connect IQ simulator, an option has been added under the Simulation menu, which allows manually triggering background services. When manually triggering a service, the background service for the most recently run application will be loaded, and the corresponding call in the <a href="./doc/Toybox/System/ServiceDelegate.html"><code>ServiceDelegate</code></a> will be triggered regardless of whether the application has registered for that event.</p>

<h1 id="glances">Glances</h1>

<p><em>Since API level 3.1.0</em></p>

<p>The intention of widgets was to make various kinds of information that are important to the user available at a glance. While the app carousel does allow quick navigation, navigating the loop may require launching numerous applications to get to what you&#8217;re looking for. It also dedicates the entire screen for a given context.</p>

<p>Glances, introduced with the fēnix® 6 device, turn the presentation of widgets into a dashboard. Instead of a carousel, the user is presented with a list of metrics. Selecting a list item will launch the widget. API level 3.1.0 added the ability for developers to support this feature.</p>

<h2 id="relevantapis">Relevant APIs</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application/AppBase.html#getGlanceView-instance_function"><code>AppBase.getGlanceView()</code></a></td>
	<td style="text-align:left;">Called by the system to retrieve your glance</td>
	<td style="text-align:left;">3.1.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi/GlanceView.html"><code>WatchUi.GlanceView</code></a></td>
	<td style="text-align:left;">Implementation of your application glance view on the glance list</td>
	<td style="text-align:left;">3.1.0</td>
</tr>
</tbody>
</table>

<h2 id="howtoenableglancesupportinwidget">How to Enable Glance Support in Widget</h2>

<p>The <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>WatchUi.GlanceView</code></a> allows an app to implement a Glance. Think of the <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> as a small canvas to present an executive summary from your widget. The <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> is similar to other <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a> objects but should only be used for implementing a Glance. Override the <a href="./doc/Toybox/Application/AppBase.html#getGlanceView-instance_function"><code>AppBase.getGlanceView()</code></a> and return your implementation of <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a>to add Glance support.</p>

<p>In devices before API level 4.0.0 if a widget doesn&#8217;t override <a href="./doc/Toybox/Application.html#getGlanceView-instance_function"><code>getGlanceView()</code></a>, default <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> will be used, which simply shows the name of the widget. In API level 4.0.0 and above, apps and widgets must implement a glance view to appear in the glance list.</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/glance_page.png" style="max-width:800px;" alt="glance page" />
<figcaption>Glance Page</figcaption>
</figure>
</div>

<h2 id="howwidgetsstartonglancepage">How Widgets Start on &#8220;Glance Page&#8221;</h2>

<p>When a widget is shown as part of the &#8220;Glance Page&#8221;, it will be started in Glance mode with limited memory allocated (32KB for most devices).</p>

<p>Similar to <a href="./CoreTopics.html#backgroundservices">background services</a>, developers can use the <code>:glance</code> annotation to indicate which modules and / or classes are necessary when running a Widget in Glance mode. Just like background services using the annotation selectively allows developers to limit memory usage when running in glance mode.</p>

<p>When designing widgets and widget glances, it&#8217;s best to think of them as somewhat independent items that will function together. There is no guarantee that a widget will always start in glance mode, for example, before transitioning to its standard widget mode.</p>

<h2 id="glancelifecycle">Glance Lifecycle</h2>

<p>Depending on a device&#8217;s resource limitations, <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> can be updated in two different ways.</p>

<h3 id="liveuiupdate">Live UI Update</h3>

<p>Devices that have ample resources <a href="#fn:5" id="fnref:5" title="see footnote" class="footnote">[5]</a> will start the Widget in Glance mode, and keep it alive. The provided <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> will be updated as needed by the system, and calls to <a href="./doc/Toybox/WatchUi.html#requestUpdate-instance_function"><code>WatchUi.requestUpdate()</code></a> will
 trigger a <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> update as expected.</p>

<p>Note: It&#8217;s highly recommended that the update rate should be kept under 1HZ to provide a better scrolling experience.</p>

<h3 id="backgrounduiupdate">Background UI Update</h3>

<p>Devices that have less memory <a href="#fn:6" id="fnref:6" title="see footnote" class="footnote">[6]</a> will start the app only when the system deems it appropriate, and calls to <a href="./doc/Toybox/WatchUi.html#requestUpdate-instance_function"><code>WatchUi.requestUpdate()</code></a> will have no effect. Such a device could update their glance view when it becomes visible (activated) and at least 30 seconds since last update.</p>

<p>During a background update, the Widget and its <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> will run through a complete life cycle. The <a href="./doc/Toybox/Application/AppBase.html"><code>AppBase</code></a> functions <a href="./doc/Toybox/Application/AppBase.html#onStart-instance_function"><code>onStart()</code></a>, <a href="./doc/Toybox/Application/AppBase.html#getGlanceView-instance_function"><code>getGlanceView()</code></a> will be called to start the app and retrieve the view. Once the <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> has been retrieved, the <code>View</code> functions <a href="./doc/Toybox/WatchUi/View.html#onLayout-instance_function"><code>onLayout()</code></a>, <a href="./doc/Toybox/WatchUi/View.html#onShow-instance_function"><code>onShow()</code></a>, <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function"><code>onUpdate()</code></a> and
 <a href="./doc/Toybox/WatchUi/View.html#onHide-instance_function"><code>onHide()</code></a> will be called. The <a href="./doc/Toybox/Application/AppBase.html#onStop-instance_function"><code>AppBase.onStop()</code></a> function will be called upon app termination, and the app will be shut down.</p>

<p>All content that is rendered to the <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a> passed to <a href="./doc/Toybox/View.html#onUpdate-instance_function"><code>View.onUpdate()</code></a> will be cached on the filesystem and used to display until the next time the system decides to do an update.</p>

<h3 id="bestpractices">Best Practices</h3>

<p>Most functionality supported in Widget is still supported when running as a Glance, such as accessing application storage and making web requests. However, developers should focus on making <a href="./doc/Toybox/WatchUi/GlanceView.html"><code>GlanceView</code></a> quick to load and moving CPU intensive work to a Background service.</p>

<h1 id="propertiesandsettings">Properties and Settings</h1>

<p>The app settings framework enables app developers to present options to end users for their apps within Garmin Connect and Garmin Express. This will allow app customization and setup, especially for watch faces and data fields, that have no way to receive user input on Garmin devices.</p>

<h2 id="properties">Properties</h2>

<p>An app property is a key and value that is built into the app at compile time. Properties are defined in application resources, and follow the rules of resource overrides.</p>

<pre><code class="xml">&lt;properties&gt;
    &lt;property id=&quot;appVersion&quot; type=&quot;string&quot;&gt;1.0.0&lt;/property&gt;
&lt;/properties&gt;
</code></pre>

<p>The <code>id</code> is a string identifier. The <code>type</code> must be one of the following:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>number</code>, <code>long</code>, <code>float</code>, <code>double</code></td>
	<td style="text-align:left;">Numeric values</td>
</tr>
<tr>
	<td style="text-align:left;"><code>boolean</code></td>
	<td style="text-align:left;">Boolean value</td>
</tr>
<tr>
	<td style="text-align:left;"><code>string</code></td>
	<td style="text-align:left;">String value</td>
</tr>
<tr>
	<td style="text-align:left;"><code>array</code></td>
	<td style="text-align:left;">Array values cannot be initialized in properties, but defaults can be programmed in app settings</td>
</tr>
</tbody>
</table>

<p>When your app is installed the properties are initialized to the values programmed into resources. The property values can be fetched and modified via the following APIs:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Notes</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/AppBase.html#getProperty-instance_function"><code>AppBase.getProperty()</code></a></td>
	<td style="text-align:left;">Get a property by its name</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/AppBase.html#setProperty-instance_function"><code>AppBase.setProperty()</code></a></td>
	<td style="text-align:left;">Modify a property value</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/AppBase/Properties.html#getValue-instance_function"><code>Properties.getValue()</code></a></td>
	<td style="text-align:left;">Get a property by its name</td>
	<td style="text-align:left;">2.4.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/AppBase/Properties.html#setValue-instance_function"><code>Properties.setValue()</code></a></td>
	<td style="text-align:left;">Modify a property value</td>
	<td style="text-align:left;">2.4.0</td>
</tr>
</tbody>
</table>

<h2 id="settings">Settings</h2>

<p>App settings allow the user to modify app properties using their mobile device. The app settings can be modified in the Connect IQ Store app, the Garmin Connect app, or Garmin Express.</p>

<p>An app setting is composed of a property and an associated setting. The property is used to store the underlying setting value. The setting is used to describe how the property should displayed to the end user. You can define a property as a default value and not define an associated setting but you cannot define a setting without tying it to a property.</p>

<p>Settings are also defined as a resource. Use the <code>&lt;setting&gt;</code> tag to define a setting.</p>

<pre><code class="xml">&lt;settings&gt;

    &lt;setting propertyKey=&quot;@Properties.appVersion&quot; title=&quot;@Strings.AppVersionTitle&quot;&gt;
        &lt;settingConfig type=&quot;alphaNumeric&quot; readonly=&quot;true&quot; /&gt;
    &lt;/setting&gt;

    &lt;setting propertyKey=&quot;@Properties.myString&quot; title=&quot;@Strings.MyStringTitle&quot; prompt=&quot;@Strings.MyStringPrompt&quot;&gt;
        &lt;settingConfig type=&quot;list&quot;&gt;
            &lt;listEntry value=&quot;0&quot;&gt;@Strings.HelloWorld&lt;/listEntry&gt;
            &lt;listEntry value=&quot;1&quot;&gt;@Strings.Ackbar&lt;/listEntry&gt;
            &lt;listEntry value=&quot;2&quot;&gt;@Strings.Garmin&lt;/listEntry&gt;
        &lt;/settingConfig&gt;
    &lt;/setting&gt;

    &lt;setting propertyKey=&quot;@Properties.myNumber&quot; title=&quot;@Strings.MyNumberTitle&quot; prompt=&quot;@Strings.MyNumberPrompt&quot;&gt;
        &lt;settingConfig type=&quot;numeric&quot; errorMessage=&quot;@Strings.MyNumberError&quot; /&gt;
    &lt;/setting&gt;

    &lt;setting propertyKey=&quot;@Properties.screenSleep&quot; title=&quot;@Strings.ScreenSleepTitle&quot;&gt;
        &lt;settingConfig type=&quot;boolean&quot; /&gt;
    &lt;/setting&gt;

    &lt;setting propertyKey=&quot;@Properties.username&quot; title=&quot;@Strings.UsernameTitle&quot;&gt;
        &lt;settingConfig type=&quot;alphaNumeric&quot; required=&quot;true&quot; /&gt;
    &lt;/setting&gt;

&lt;/settings&gt;
</code></pre>

<p>The table below shows all of the valid attributes for a setting.</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>propertyKey</code></td>
	<td style="text-align:left;">The key of the property that this setting will manage. An error will be thrown at compile time if the property key can&#8217;t be found.</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>title</code></td>
	<td style="text-align:left;">The title to display in Garmin Connect Mobile/Garmin Express when displaying the list of settings/value of the setting. This must reference a string resource ID.</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>prompt</code></td>
	<td style="text-align:left;">The message to display when prompting the user to set the value. This must reference a string resource ID.</td>
	<td style="text-align:left;">Optional. Some settings will not display a prompt even if it&#8217;s provided (for example, <code>readonly</code> or <code>boolean</code> settings displayed as an on/off switch).</td>
</tr>
<tr>
	<td style="text-align:center;"><code>helpUrl</code></td>
	<td style="text-align:left;">A URL to a web page which will provide help for the user. <strong>This has been deprecated.</strong></td>
	<td style="text-align:left;">Optional</td>
</tr>
<tr>
	<td style="text-align:center;"><code>maxLength</code></td>
	<td style="text-align:left;">The maximum number of elements allowed in an array setting</td>
	<td style="text-align:left;">Optional</td>
</tr>
</tbody>
</table>

<p>A <code>&lt;settingConfig&gt;</code>, a child element of a <code>&lt;setting&gt;</code>, provides additional details about the setting. The valid attributes are given in the table below.</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>type</code></td>
	<td style="text-align:left;">The display type of the setting.</td>
	<td style="text-align:left;"><code>list</code>, <code>boolean</code>, <code>numeric</code>, <code>alphaNumeric</code>, <code>phone</code>, <code>email</code>, <code>url</code>, <code>date</code> or <code>password</code></td>
	<td style="text-align:left;">A value of <code>list</code> will require child <code>&lt;listEntry&gt;</code> elements to define the options which should be available within the list.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>readonly</code></td>
	<td style="text-align:left;">If the setting is read only or not. This attribute is valid for all types except <code>list</code> and <code>password</code>.</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;">Optional. Defaults to <code>false</code>.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>required</code></td>
	<td style="text-align:left;">If the field is required.</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;">Optional. Defaults to <code>false</code>.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>min</code></td>
	<td style="text-align:left;">The minimum value to allow.</td>
	<td style="text-align:left;">An integer value</td>
	<td style="text-align:left;">Optional. Only valid for a <code>type</code> value of <code>numeric</code> or <code>date</code>.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>max</code></td>
	<td style="text-align:left;">The maximum value to allow.</td>
	<td style="text-align:left;">An integer value</td>
	<td style="text-align:left;">Optional. Only valid for a <code>type</code> value of <code>numeric</code> or <code>date</code>.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>maxLength</code></td>
	<td style="text-align:left;">The maximum allowed value length.</td>
	<td style="text-align:left;">An integer value</td>
	<td style="text-align:left;">Optional. Only valid for settings whose associated property&#8217;s type is <code>string</code>.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>errorMessage</code></td>
	<td style="text-align:left;">An error message to display if the value a user enters isn&#8217;t valid based on the <code>type</code>, <code>min</code>, <code>max</code> and <code>maxLength</code> values.</td>
	<td style="text-align:left;">A reference to a string resource.</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">In array settings, an identifier that is used to mark a field inside the object setting.</td>
	<td style="text-align:left;">A string identifier</td>
	<td style="text-align:left;">This is only used with array settings</td>
</tr>
</tbody>
</table>

<p><code>&lt;settingConfig&gt;</code> types are only valid for certain property types:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Property Type</th>
	<th style="text-align:left;">Valid <code>settingsConfig</code> Types</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>string</code></td>
	<td style="text-align:left;"><code>alphaNumeric</code>, <code>phone</code>, <code>email</code>, <code>url</code>, <code>password</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>number</code></td>
	<td style="text-align:left;"><code>list</code>, <code>numeric</code>, <code>date</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>float</code></td>
	<td style="text-align:left;"><code>numeric</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>long</code></td>
	<td style="text-align:left;"><code>numeric</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>double</code></td>
	<td style="text-align:left;"><code>numeric</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>boolean</code></td>
	<td style="text-align:left;"><code>boolean</code></td>
</tr>
</tbody>
</table>

<p>The <code>&lt;listEntry&gt;</code> element is defined in the table below. Its value must be a reference to a string resource.</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>value</code></td>
	<td style="text-align:left;">The value to save if this item is selected by the user.</td>
	<td style="text-align:left;">The type of the value should match the property it&#8217;s being saved to. If it doesn&#8217;t match a compile time error is thrown.</td>
</tr>
</tbody>
</table>

<p>See the <a href="./CoreTopics.html#accessingpropertiesandstorageobjectstore">Object Store</a> and <a href="./CoreTopics.html#accessingpropertiesandstorageapplicationproperties">Application Properties</a> on how to read these value at runtime.</p>

<h3 id="groups">Groups</h3>

<p>The <code>&lt;group&gt;</code> tag allows settings to be grouped together. This lets you visually separate related settings from non-related ones. A group contains the settings it groups together. A group is not allowed to contain a group.</p>

<p>Here is a simple example of a group definition:</p>

<pre><code class="xml">&lt;settings&gt;
    &lt;group id=&quot;groupName&quot; title=&quot;@Strings.group1Title&quot; description=&quot;@Strings.group1Description&quot;&gt;
        &lt;setting propertyKey=&quot;@Properties.number_prop&quot; title=&quot;@Strings.number_title&quot;&gt;
            &lt;settingConfig type=&quot;numeric&quot; /&gt;
        &lt;/setting&gt;

        &lt;setting propertyKey=&quot;@Properties.long_prop&quot; title=&quot;@Strings.long_title&quot;&gt;
            &lt;settingConfig type=&quot;numeric&quot; /&gt;
        &lt;/setting&gt;
    &lt;/group&gt;
&lt;/settings&gt;
</code></pre>

<p>Here are the options for groups:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Attribute</th>
	<th style="text-align:left;">Values</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>id</code></td>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;">Identifier for the group</td>
</tr>
<tr>
	<td style="text-align:left;"><code>title</code></td>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;">Title for the group. This is shown as a list item in mobile.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>description</code></td>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;">Description text for the group. This should describe the context of the group of settings</td>
</tr>
<tr>
	<td style="text-align:left;"><code>enableIfTrue</code></td>
	<td style="text-align:left;">Property identifier</td>
	<td style="text-align:left;">Allows a group to be disabled if a <code>boolean</code> setting is not checked. This allows for settings to appear if the user enables a feature.</td>
</tr>
</tbody>
</table>

<h3 id="arraysettings">Array Settings</h3>

<p>There are times when it can be helpful to allow the user to manipulate one or more related items. For example, let&#8217;s say that your app can support more than one kind of activity type, and each activity type has a different set of heart rate zones. The user may only have two or three activity types, but your app supports 50 different ones.</p>

<p>Array settings allow you to define a set of settings that are added and removed as a group. This allows the user to create a variable list (up to a maximum size) of objects that can be read at runtime.</p>

<p>To create a variable list, the property referenced must be of type <code>array</code>. The setting definition is then a set of settings<a href="#fn:7" id="fnref:7" title="see footnote" class="footnote">[7]</a>:</p>

<pre><code class="xml">&lt;setting propertyKey=&quot;@Properties.ActivityHrZones&quot; title=&quot;Activities&quot; maxLength=&quot;4&quot;&gt;

    &lt;setting title=&quot;@Strings.activityType&quot; type=&quot;number&quot;&gt;
        &lt;settingConfig id=&quot;activityType&quot; type=&quot;list&quot;&gt;
            &lt;listEntry value=&quot;0&quot;&gt;@Strings.Running&lt;/listEntry&gt;
            &lt;listEntry value=&quot;1&quot;&gt;@Strings.Cycling&lt;/listEntry&gt;
            &lt;listEntry value=&quot;2&quot;&gt;@Strings.Swimming&lt;/listEntry&gt;
        &lt;/settingConfig&gt;
    &lt;/setting&gt;
    &lt;setting title=&quot;@Strings.Zone1&quot;&gt;
       &lt;settingConfig id=&quot;zone1&quot; type=&quot;number&quot;/&gt;
    &lt;/setting&gt;
    &lt;setting title=&quot;@Strings.Zone2&quot;&gt;
       &lt;settingConfig id=&quot;zone2&quot; type=&quot;number&quot;/&gt;
    &lt;/setting&gt;
    &lt;setting title=&quot;@Strings.Zone3&quot;&gt;
       &lt;settingConfig id=&quot;zone3&quot; type=&quot;number&quot;/&gt;
    &lt;/setting&gt;
    &lt;setting title=&quot;@Strings.Zone4&quot;&gt;
       &lt;settingConfig id=&quot;zone4&quot; type=&quot;number&quot;/&gt;
    &lt;/setting&gt;
    &lt;setting title=&quot;@Strings.Zone5&quot;&gt;
       &lt;settingConfig id=&quot;zone5&quot; type=&quot;number&quot;/&gt;
    &lt;/setting&gt;

    &lt;!-- The defaults is where you program the initial values --&gt;
    &lt;defaults&gt;
        &lt;entry&gt;
            &lt;default id=”activityType”&gt;0&lt;/default&gt;
            &lt;default id=&quot;zone1&quot;&gt;89&lt;/default&gt;
            &lt;default id=&quot;zone2&quot;&gt;109&lt;/default&gt;
            &lt;default id=&quot;zone3&quot;&gt;125&lt;/default&gt;
            &lt;default id=&quot;zone3&quot;&gt;144&lt;/default&gt;
            &lt;default id=&quot;zone5&quot;&gt;160&lt;/default&gt;
        &lt;/entry&gt;
    &lt;/defaults&gt;
&lt;/setting&gt;
</code></pre>

<p>When you query the property, it will be an array of <a href="./doc/Toybox/Lang/Dictionary.html"><code>Dictionary</code></a> objects, with each <code>id</code> key associated with the value. You can use <code>maxLength</code> to set an upper bound to the number of elements. Each <code>settingConfig</code> must have an <code>id</code> field.</p>

<p>The <code>&lt;defaults&gt;</code> tag allows you to program the initial value when your app is first installed. Each <code>&lt;default&gt;</code> tag must reference the identifier with the <code>id</code> attribute.</p>

<h2 id="changingsettingswithingarminconnectmobilegarminexpress">Changing Settings Within Garmin Connect Mobile/Garmin Express</h2>

<p>End users will be able to view the settings you define within the Garmin Connect or Garmin Express UI. When app settings are changed while an app is running the <a href="./doc/Toybox/Application/AppBase.html#onSettingsChanged-instance_function"><code>AppBase.onSettingsChanged()</code></a> function is called. Apps can override this function and update accordingly. When dealing with date type settings that are set by Garmin Express or Garmin Connect, one should note that times are stored in UTC and that <a href="./doc/Toybox/Time/Gregorian.html#utcInfo-instance_function"><code>Gregorian.utcInfo()</code></a> should be used in place of <a href="./doc/Toybox/Time/Gregorian.html#info-instance_function"><code>Gregorian.info()</code></a> when working with such values to prevent unnecessary local time conversion.</p>

<h2 id="testingappsettings">Testing App Settings</h2>

<p>An app settings editor tool is available within the Connect IQ simulator. Go to <em>File &gt; Edit Persistent Storage &gt; Edit Application.Properties data</em>. This tool will allow you to view the defined settings for a project, select values for each setting and send them to the simulator for testing.</p>
<figure>
<img src="./resources/programmers-guide/app_settings_editor.png" style="max-width:220px;" title="The App Settings Editor" />
</figure>

<p>The app settings editor requires you to be authenticated in the SDK Manager as well as a internet connection.</p>

<h2 id="ondevicewatchfaceanddatafieldsettings">On Device Watch Face and Data Field Settings</h2>

<p><em>Since API level 3.2.0</em></p>

<p>Device applications, widgets, and audio content providers all accept user input that allow them to implement on-device settings in the app. Watch faces and data fields are not allowed to accept input or push views that would allow on device configuration.</p>

<p>If you want to provide an on-device settings user interface for your watch face or data field, you can implement <a href="./doc/Toybox/Application/AppBase.html#getSettingsView-instance_function"><code>AppBase.getSettingsView()</code></a>. <a href="./doc/Toybox/Application/AppBase.html#getSettingsView-instance_function"><code>getSettingsView()</code></a> functions similarly to <a href="./doc/Toybox/Application/AppBase.html#getInitialView-instance_function"><code>AppBase.getInitialView()</code></a> where you return a <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a> and <a href="./doc/Toybox/WatchUi/InputDelegate.html"><code>WatchUi.InputDelegate</code></a> pair that can serve as the initial view.</p>

<p>Watch face configuration is available to the user in the system Watch Face menu. Data field configuration is available from the activity menu.</p>

<h1 id="intents">Intents</h1>

<p><em>Since API level 2.2.0</em></p>

<p>Intents allow a Connect IQ watch-app or widget to launch another Connect IQ watch-app, Connect IQ widget, or native application (e.g. built in activities like Run, Bike, etc.) by calling <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>System.exitTo()</code></a>:</p>

<p>Calling <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>exitTo()</code></a> will cause a confirmation view to be displayed asking the user whether to exit to the intended app. If the user chooses &#8216;No&#8217; then the app that called <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>exitTo()</code></a> will continue to run. If the user chooses &#8216;Yes&#8217; then the app will exit and the new app will launch. While the confirmation view is shown, the originating app will continue to run.</p>

<h2 id="exitingtoconnectiqapps">Exiting to Connect IQ Apps</h2>

<p>In order to exit to another Connect IQ app, a <a href="./doc/Toybox/System/Intent.html"><code>System.Intent</code></a> must be created, which contains a target app identifier and any arguments you wish to pass to the target app. The target app identifier must be specified using one of two supported URI schemes:</p>

<ul>
<li><code>manifest-id://</code> followed by a valid UUID from the app&#8217;s manifest.xml</li>
<li><code>store-id://</code> followed by a valid app store UUID</li>
</ul>

<p>Arguments are passsed to the target app as a dictionary, which may be empty or <code>null</code>, and are received by the target app&#8217;s <a href="./doc/Toybox/Application/AppBase.html#onStart-instance_function"><code>AppBase.onStart()</code></a> method as a <a href="./doc/Toybox/Lang/Dictionary.html"><code>Dictionary</code></a> object.</p>

<pre><code class="java">import Toybox.System;
...
var intent = new System.Intent(&quot;manifest-id://01234567-89AB-CDEF-0123-456789ABCDEF&quot;, {&quot;lat&quot;=&gt;38.856419, &quot;lon&quot;=&gt;-94.801369});
System.exitTo(intent);
</code></pre>

<p>Assuming the target app is installed on the device, this example launches the app with manifest ID <code>01234567-89AB-CDEF-0123-456789ABCDEF</code> and passes it the <code>&quot;lat&quot;</code> and <code>&quot;lon&quot;</code> arguments.</p>

<h2 id="exitingtonativeapps">Exiting to Native Apps</h2>

<p><a href="./doc/Toybox/System/Intent.html"><code>Intent</code></a> objects to launch native apps deal exclusively with <a href="./doc/Toybox/PersistedContent.html"><code>PersistedContent</code></a> objects, such as <a href="./doc/Toybox/PersistedContent/Waypoint.html"><code>PersistedContent.Waypoint</code></a>, <a href="./doc/Toybox/PersistedContent/Route.html"><code>PersistedContent.Routes</code></a>, and <a href="./doc/Toybox/PersistedContent/Track.html"><code>PersistedContent.Tracks</code></a>. Connect IQ handles most of the <a href="./doc/Toybox/System/Intent.html"><code>Intent</code></a> functionality for native apps behind the scenes, automatically embedding the appropriate native app identifier in the <a href="./doc/Toybox/PersistedContent.html"><code>PersistedContent</code></a> object, which is accessible via the <code>toIntent()</code> method. See the <a href="./CoreTopics.html#persistedcontent2.2">Persisted Content</a> section for more information.</p>

<h2 id="intentexceptions">Intent Exceptions</h2>

<p>Connect IQ includes three exception types related to intents:</p>

<ul>
<li><a href="./doc/Toybox/System/UnexpectedAppTypeException.html"><code>System.UnexpectedAppTypeException</code></a> is thrown if your app tries to exit to a Connect IQ app type other than device app or widget</li>
<li><a href="./doc/Toybox/System/AppNotInstalledException.html"><code>System.AppNotInstalledException</code></a> is thrown if your app tries to exit to an app that is not installed</li>
<li><a href="./doc/Toybox/System/PreviousOperationNotCompleteException.html"><code>System.PreviousOperationNotCompleteException</code></a> is thrown if <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>exitTo()</code></a> is called a while a confirmation view from a previous <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>exitTo()</code></a> call has not been acknowledged by the user</li>
</ul>

<h1 id="buildconfiguration">Build Configuration</h1>

<p>Connect IQ supports a wide variety of Garmin devices, like watches, bike computers and handhelds. Even within these broader categories, devices can have different screen sizes, shapes and resolutions. Application developers may wish to define specific resources, like fonts and bitmap graphics, for certain devices or device families for a better user experience. For example, an app may need to use a round background image for round devices and a square background image for square devices.</p>

<p>Connect IQ offers a few ways to manage app resources: <a href="#devicefamilyandlocalizationqualifiers">device and family qualifiers</a>, <a href="#buildconfigurationviajungles">Jungles</a> and [build exclusions][Build File Exclusions].</p>

<h2 id="devicefamilyandlocalizationqualifiers">Device, Family, and Localization Qualifiers</h2>

<p>The simplest way to override resources is with device, family, and localization qualifiers, which are added to a resources folder by adding a hyphen (<code>-</code>) followed by a valid qualifier value. Let&#8217;s take a look at an example:</p>
<figure style="text-align:left;">
<img src="./resources/programmers-guide/qualifier-project.png" style="max-width:190px;" title="A project structure using a device qualifier" />
<figcaption>Figure 1: A project that uses a f&emacr;nix 5 device resource qualifier</figcaption>
</figure>

<p>Resource qualifiers are applied to the base resources folder, and all resources found within that folder will inherit the qualifiers of the base folder. Resources with more specific qualifiers will always take precedence over less specific ones if they share a resource ID.</p>

<p>In Figure 1, the <code>resources-fenix5</code> directory uses a <code>-fenix5</code> qualifier to segregate resources specifically intended for the f&emacr;nix 5. When this project is built for f&emacr;nix 5, the layout and drawable in the <code>resources-fenix5</code> directory will be used to display a different background image than the one in the more generic <code>resources</code> directory. All other supported products will compile with the default resources.</p>

<p><strong>Note:</strong> Multiple qualifiers separated by hyphens may be used on a single folder, but device qualifiers are not allowed to co-exist with family qualifiers in the same folder name (e.g. <code>resources-round-fenix3</code>) and will be skipped by the resource compiler if encountered.</p>

<h3 id="devicequalifiers">Device Qualifiers</h3>

<p>The device qualifier format allows for resources to target specific devices (as demonstrated in Figure 1). Resources included in a folder with a device qualifier will override the resources with the same ID that are defined in the base resource folder when building for the associated device. Device qualifiers also take precedence over less specific qualifiers, such as family qualifiers.</p>

<h3 id="familyqualifiers">Family Qualifiers</h3>

<p>The family qualifier format allows for resources to target specific device families, which is a group of devices differentiated by shared screen characteristics. There are two family qualifiers:</p>

<ul>
<li><strong>Screen shape:</strong> The shape of the screen (e.g. <code>round</code>, <code>rectangle</code>, etc.)</li>
<li><strong>Screen size:</strong> The physical size of the screen in pixels ( e.g. <code>218x218</code>, <code>148x205</code>, etc.)</li>
</ul>

<p>The screen shape must always be specified when using a family qualifier, and the screen size may be added to further refine the target family. Here are some examples of valid and invalid family qualifier examples:</p>

<ul>
<li><code>resources-round</code>: <em>Valid</em>&mdash;targets round screen devices, like the f&emacr;nix 3 series and f&emacr;nix 5 series</li>
<li><code>resources-round-218x218</code>: <em>Valid</em>&mdash;targets 218px x 218px, round screen screen devices, like the f&emacr;nix 3 and f&emacr;nix 5S (but not the 5 or 5X since they have 240px x 240px screens)</li>
<li><code>resources-218x218</code>: <em>Invalid</em>&mdash;this will be ignored by the resource compiler because no screen shape has been specified</li>
<li><code>resources-218x218-round</code>: <em>Invalid</em>&mdash;the screen shape was not specified first</li>
</ul>

<p>Resources with more specific qualifiers will always take precedence over less specific ones, so on a round, 218px x 218px device, any resources contained in the <code>resources-round-218x218</code> resources folder will be used in place of those in <code>resources-round</code> if they share an ID. In addition any resource folder that carries a family qualifier will always defer to resource folders named with device qualifiers.</p>

<h3 id="localizationqualifiers">Localization Qualifiers</h3>

<p>Localization qualifiers are a way to specify language-specific string resources, and are specified as an <a href="https://www.loc.gov/standards/iso639-2/php/code_list.php">ISO 639–2 language code</a>. These qualifiers may be combined with either device or family qualifiers, and are always specified last in the qualifier naming scheme. For example:</p>

<ul>
<li><code>resources-fre</code>: Provides French language-specific string resources for all devices</li>
<li><code>resources-round-fre</code>: Provides French language-specific string resources for round devices only</li>
<li><code>resources-fenix5s-fre</code>: Provides French language-specific string resources for f&emacr;nix 5 devices only</li>
</ul>

<h2 id="buildconfigurationviajungles">Build Configuration via Jungles</h2>

<p>Connect IQ runs on a diverse set of purpose built devices. Because of the variety of inputs, screen shapes and resources, it often is necessary to include code and resources tailored to specific conditions. For example, on a square device a progress bar may be rectangular, but on a round device it might look better as an arc that orbits the screen.</p>

<p>Jungles allow developers to write custom build configurations for Monkey C projects. With Jungles, developers may:</p>

<ul>
<li>Define per-device or per-device family paths to source and resource directories</li>
<li>Exclude portions of source code with annotations</li>
<li>Specify <a href="./CoreTopics.html#shareablelibraries">Monkey Barrels</a> that should be included when a project is built.</li>
</ul>

<h3 id="perdeviceconfiguration">Per Device Configuration</h3>

<p>Jungles allow for the source path, resource path and exclusions to be set for all products, by screen shape, or for particular products. The following prefixes are allowed:</p>

<table>
<colgroup>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Name</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>base</code></td>
	<td>Configuration applies to all products</td>
</tr>
<tr>
	<td><code>round</code></td>
	<td>Configuration applies to products with round screens</td>
</tr>
<tr>
	<td><code>semiround</code></td>
	<td>Configuration applies to products with semi-round screens</td>
</tr>
<tr>
	<td><code>rectangle</code></td>
	<td>Configuration applies to products with rectangle or square screens</td>
</tr>
<tr>
	<td><code>semioctagon</code></td>
	<td>Configuration applies to products with octagon screens with sub-window</td>
</tr>
<tr>
	<td><code>&lt;product id&gt;</code></td>
	<td>Configuration applies to a specific product. <code>&lt;product id&gt;</code> is the same as what is used in the manifest file</td>
</tr>
</tbody>
</table>

<p>For <code>round</code>, <code>semiround</code>, <code>semi-octagon</code>, and <code>rectangle</code> identifiers, an optional <code>-&lt;width&gt;x&lt;height&gt;</code> suffix can be added for narrow the scope.</p>

<p>Let&#8217;s say you are writing a wearable app that has different resources for round, semi-round and rectangle layouts. The Venu has a AMOLED specific implementation as well. Jungles make it easy to manage project build configurations in one place:</p>

<pre><code>base.sourcePath = source

# Configure paths based on screen shape
round.resourcePath = $(base.resourcePath);resource-round
semiround.resourcePath = $(base.resourcePath);resource-semiround
rectangle.resourcePath = $(base.resourcePath);resource-rectangle

# Set the venu source and resource paths
venu.sourcePath = $(base.sourcePath);source-venu
venu.resourcePath = $(base.resourcePath);resource-venu
</code></pre>

<p>These instructions set the source path for all devices to <code>source</code>. It tells the build system to use the <code>resource-round</code>, <code>resource-semiround</code> and <code>resource-rectangle</code> paths for the round, semi-round and rectangle the devices respectively. Finally, the Venu has an additional source and resource folders added.</p>

<h3 id="feelingexcluded">Feeling Excluded</h3>

<p>Now, let&#8217;s say that we have some code in our application that should only be run on round products, and all the non-round products should use the &#8220;regular&#8221; version:</p>

<pre><code class="typescript">(:roundVersion)
function drawThis(dc) {
    // Implementation
}

(:regularVersion)
function drawThis(dc) {

}
</code></pre>

<p>We don&#8217;t want to include both versions in any executable because one version would just be dead code. Jungles allow us to specify this using exclusions.</p>

<pre><code class="bash"># Say that all products exclude declarations
# with the annotation :roundVersion
base.excludeAnnotations = roundVersion
# Now say that the round products exclude
# the regular version
round.excludeAnnotations = regularVersion
</code></pre>

<p>When building the app for a product, round products will exclude the version of <code>drawThis</code> with the <code>:regularVersion</code> annotation, and the rest of the products will exclude the version of <code>drawThis</code> with the <code>:roundVersion</code> annotation.</p>

<p>For more information on how to use Jungles see the <a href="./ReferenceGuides.html#junglereferenceguide">Jungle Reference Guide</a>.</p>

<h1 id="security">Security</h1>

<p>At Garmin we are focused on the security of our devices and services. The security model in Connect IQ is designed to give the developer and the user the tools to know that their device and their information is safe with Garmin.</p>

<p>Connect IQ has three levels of trust for apps:</p>

<ul>
<li><strong>Trusted</strong> - Content that has been approved by the app store. These apps have passed the Garmin review process and can be downloaded from the Connect IQ store.</li>
<li><strong>Developer</strong> - Content that has been written by an individual developer, but has not been released in the Connect IQ store. This content can be used for testing, but is not an officially released app.</li>
<li><strong>Untrusted</strong> - Content that should not be run on device.</li>
</ul>

<p>These levels of trust are enforced using digital signatures. Key management has been worked into the app store, the device, and the developer SDK. The goal is to make sure that apps loaded from developers only come from two locations - the app store or a trusted developer.</p>

<h2 id="developerkeys">Developer Keys</h2>

<p>The Connect IQ compiler requires a developer key be provided to for signing when compiling and packaging apps. The required key must be a RSA 4096 bit private key.</p>

<p><strong>Note</strong>: It&#8217;s important you keep track of the key you use to sign app packages. You will need to use the same key to sign updates to an existing app on the store. If you lose your original signing key you will not be able to update your app.</p>

<h2 id="generatingakeyusingvisualstudiocode">Generating a Key Using Visual Studio Code</h2>

<p>If you have a developer key you can set the path to it by selecting <em>File &gt; Preferences &gt; Settings &gt; Monkey C</em> and setting the <em>Monkey C: Developer Key Path</em> to your developer key. If you do not have a developer key, you can create one using the <em>Monkey C: Generate Developer Key</em> command in the command palette, or the Monkey C extension will create one when you verify the installation using the <em>Monkey C: Verify Installation</em> command.</p>

<h2 id="generatingakeyusingopenssl">Generating a Key Using OpenSSL</h2>

<p>If you&#8217;re working from the command line you can generate a RSA key using <a href="https://www.openssl.org/">OpenSSL</a>. The following command will generate a valid signing key.</p>

<pre><code class="bash">&gt; openssl genrsa -out developer_key.pem 4096
&gt; openssl pkcs8 -topk8 -inform PEM -outform DER -in developer_key.pem -out developer_key.der -nocrypt
</code></pre>

<p>This developer key, <code>developer_key.der</code>, is passed to the compiler using the <code>-y</code> command line option.</p>

<h2 id="runningondevice">Running on Device</h2>

<p>Apps must be signed to run on a Garmin device, and unsigned apps will be deleted by the device. The Monkey C tool will automatically sign your app based on your key. Your apps will run at the Developer privilege level. Apps signed by the app store run at the Trusted privilege level. The content of their object store will be encrypted and unreadable from the Connect IQ developer tools.</p>

<p>The app store requires IQ files to be digitally signed. Your upload will be rejected If the developer key has changed since your last upload.</p>

<h1 id="viewsdrawablesandlayers">Views, Drawables and Layers</h1>
<figure>
<img src="./resources/programmers-guide/artsy-monkey.png" style="max-width:300px;" title="We're going to put a happy semicolon over here. Happy semicolon..." />
</figure>

<p>The Connect IQ SDK makes it easier to port the user interface to different products. At the resource compiler level, we include a way to define a page in XML as well as specify page definitions per product. These tools make it easy to support multiple devices with a single app.</p>

<h2 id="views-1">Views</h2>

<p>Watch faces and apps have a page stack. A <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a> is an object that represents a page. Views can be pushed onto and popped off of the page stack, or a view can replace another view on the page stack with a transition.</p>

<p>A subclass of <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> usually implements the following functions:</p>

<ul>
<li><a href="./doc/Toybox/WatchUi/View.html#onShow-instance_function"><code>View.onShow()</code></a>: Called when your <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a> is first made visible. A good time to do on demand initialization of resources and timers.</li>
<li><a href="./doc/Toybox/WatchUi/View.html#onLayout-instance_function"><code>View.onLayout(dc)</code></a>: In this function you can load a layout defined in the <a href="./02CoreTopics.html#layouts">Layouts</a> section.</li>
<li><a href="./doc/Toybox/WatchUi/View.html#onUpdate-var"><code>View.onUpdate()</code></a>: Called when your view needs to update the display. The default version of this function will draw the layout elements, but you call <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function"><code>onUpdate()</code></a> to have the system draw the layout and then run your own custom drawing.</li>
<li><a href="./doc/Toybox/WatchUi/View.html#onHide-instance_function"><code>View.onHide()</code></a>: Called when your View is being removed from the view stack.</li>
</ul>

<h3 id="enhancedreadabilitymode">Enhanced Readability Mode</h3>

<p><em>Since API level 4.2.0</em></p>

<p>Some devices have a new setting that enlarges the sizes of fonts in menus, glances and application pages to enhance readability. To add support for enhanced readability mode, check <a href="./doc/Toybox/System/DeviceSettings.html#isEnhancedReadabilityMode-var"><code>DeviceSettings.isEnhancedReadabilityMode</code></a> at runtime to see if you should be using larger fonts. Implementing <a href="./doc/Toybox/Application/AppBase.html#onEnhancedReadabilityModeChanged-instance_function"><code>AppBase.onEnhancedReadabilityModeChanged()</code></a> will let you know if the setting changed while the app was running.</p>

<h2 id="drawables">Drawables</h2>

<p>Each <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> contains a layout. A layout is an array of <a href="./doc/Toybox/WatchUi/Drawable.html"><code>WatchUi.Drawable</code></a> objects. A <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a> can draw itself to a device context through the <a href="./doc/Toybox/WatchUi/Drawable.html#draw-instance_function"><code>Drawable.draw(dc)</code></a> method.</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/layout.png" style="max-width:534px;" alt="An illustration of Layouts, Views, and Drawables" title="An illustration of Layouts, Views, and Drawables" />
<figcaption>An illustration of Layouts, Views, and Drawables</figcaption>
</figure>
</div>

<p>Any object that extends <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a> is a drawable object, expose their properties publicly. (This will become useful when we discuss the animation system.) Monkey C provides the basic drawables <a href="./doc/Toybox/WatchUi/Text.html"><code>WatchUi.Text</code></a> and <a href="./doc/Toybox/WatchUi/Bitmap.html"><code>WatchUi.Bitmap</code></a>, allowing text and bitmap resources to be included in layouts.</p>

<h2 id="layers">Layers</h2>

<p><em>Since API level 3.1.0</em></p>

<p>Layers are used to fuse multiple levels of drawable content belong to the same view. Once added to a view, layers are rendered on the screen automatically in the order they are added. Layers are conceptually closer to the <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>Graphics.BufferedBitmap</code></a> than a <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a>, and come with a similar runtime memory cost.</p>

<p>The following is a code snippet about how to use the <a href="./doc/Toybox/WatchUi/Layer.html"><code>WatchUi.Layer</code></a> system</p>

<pre><code class="typescript">class MyLayerView extends WatchUi.View {

    function initialize() {
        // create a 240x240 layer, at [0,0] offset from the top-left corner of the screen
        var backgroundLayer = new WatchUi.Layer({:x=&gt;0, :y=&gt;0, :width=&gt;240, :height=&gt;240});

        // draw something on the layer
        backgroundLayer.getDc().drawBitmap( ... );
        backgroundLayer.getDc().drawPolyline( ... );

        // add layer to View as background
        addLayer(backgroundLayer);

        // create another 20x20 layer and add it to the view as foreground layer
        var foregroundLayer = new WatchUi.Layer({:x=&gt;10, :y=&gt;10, :width=&gt;20, :height=&gt;20});
        addLayer(foregroundLayer);

        // draw something on the foreground layer
        foregroundLayer.getDc().drawText( ... );
    }
}
</code></pre>

<h3 id="animationlayer">AnimationLayer</h3>

<p>Layers are useful for fusing animations with your <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> content. The <a href="./doc/Toybox/WatchUi/AnimationLayer.html"><code>WatchUi.AnimationLayer</code></a> is a special layer that allows integration of <a href="./doc/Toybox/WatchUi/AnimationResource.html"><code>WatchUi.AnimationResource</code></a> and your <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a>. Using layers, you can overlay animations over your <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a>, or overlay static content over playing animations.</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/layers.png" style="max-width:800px;" alt="glance page" />
<figcaption>Animation WatchFace With 3 Layers</figcaption>
</figure>
</div>

<p>The above screenshot illustrates a 3-layer watch face from the <code>samples/AnimationWatchFace</code> sample app. See the <a href="./CoreTopics.html#animations">Resources</a> section to learn how to embed resources into your app. See the <code>samples/AnimationWatchFace</code> sample to learn more.</p>

<h1 id="layouts-1">Layouts</h1>

<p>The resource compiler allows page layouts to be customized to a particular device without changing any Monkey C code. In addition, drawable List objects can also be defined, which are <a href="./doc/Toybox/WatchUi/Drawable.html"><code>WatchUi.Drawable</code></a> objects that can draw a number of graphics primitives.</p>

<p>When defining a layout in XML, simply list the drawable objects to include in your layout inside a set of layout tags. Each drawable listed will be turned into Monkey C <a href="./doc/Toybox/WatchUi/Drawable.html"><code>WatchUi.Drawable</code></a> objects and drawn one after the other. Because of this, if two drawables in your layout overlap each other the drawable that is defined second will draw on top of the drawable that is defined first. Here is an example of a basic layout:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;layout id=&quot;MainLayout&quot;&gt;
        &lt;drawable id=&quot;MainBackground&quot; /&gt;
        &lt;label text=&quot;Page Heading&quot; x=&quot;10&quot; y=&quot;25&quot; font=&quot;Gfx.FONT_LARGE&quot; color=&quot;Gfx.COLOR_BLACK&quot; /&gt;
        &lt;label text=&quot;Your information goes here.&quot; x=&quot;50%&quot; y=&quot;50%&quot; font=&quot;Gfx.FONT_MEDIUM&quot; color=&quot;Gfx.COLOR_DK_GRAY&quot; /&gt;
    &lt;/layout&gt;
&lt;/resources&gt;
</code></pre>

<p>To use this layout in your code simply call <a href="./doc/Toybox/WatchUi/View.html#setLayout-instance_function"><code>View.setLayout()</code></a> inside the <a href="./doc/Toybox/WatchUi/View.html#onLayout-instance_function"><code>View.onLayout()</code></a> function. Call the parent <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function"><code>View.onUpdate()</code></a> if you plan on using the <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function"><code>onUpdate()</code></a> function to update dynamic values on the screen. For example:</p>

<pre><code class="java">class MainView extends WatchUi.View {
    public function onLayout( dc as Dc ) as Void {
        setLayout( Rez.Layouts.MainLayout( dc ) );
    }

    public function onUpdate( dc as Dc) as Void {
        // Call parent's onUpdate(dc) to redraw the layout
        View.onUpdate( dc );

        // Include anything that needs to be updated here
    }
}
</code></pre>

<h2 id="layout">Layout</h2>

<p>The following attributes are supported by the <code>layout</code> tag:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The handle for the layout. This is used to reference the layout in the Rez module</td>
	<td style="text-align:left;">Any value that starts with a letter</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
</tbody>
</table>

<h2 id="label">Label</h2>

<p>Text can be included in layouts. To include text use the <code>label</code> tag, which supports the following attributes:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The handle for the label. The ID provided here references the label defined in the resource XML file</td>
	<td style="text-align:left;">Any value that starts with a letter</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>text</code></td>
	<td style="text-align:left;">The text to be displayed</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">An empty string</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>font</code></td>
	<td style="text-align:left;">The font to be used when drawing the text</td>
	<td style="text-align:left;">See <a href="#fontreferences">font references</a></td>
	<td style="text-align:left;"><code>Graphics.FONT_MEDIUM</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">The X coordinate of the point that the text will be justified against</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">The Y coordinate of the point that the text will be justified against</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>justification</code></td>
	<td style="text-align:left;">How the text should be justified in relation to the X &amp; Y location</td>
	<td style="text-align:left;"><code>Graphics</code> text justify constant</td>
	<td style="text-align:left;"><code>Graphics.TEXT_JUSTIFY_LEFT</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>color</code></td>
	<td style="text-align:left;">The color of the text</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Graphics.COLOR_WHITE</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>background</code></td>
	<td style="text-align:left;">The background color of the text</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Gfx.COLOR_TRANSPARENT</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>visible</code></td>
	<td style="text-align:left;">The drawable is visible</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;"><code>true</code></td>
	<td style="text-align:left;">Only supported for devices with ConnectIQ 3.3.0 and later</td>
</tr>
</tbody>
</table>

<h2 id="textarea">Text Area</h2>

<p><em>Since API level 3.1.0</em></p>

<p>Text may also be included in a layout as a text area. A text area is similar to a text label, except it will attempt to fit text into the provided area by selecting an appropriate font, adding line breaks, or applying truncation. To include a text area, use a <code>text-area</code> element. The following attributes are permitted:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The handle for the text area. The ID provided here references the text area defined in the resource XML file</td>
	<td style="text-align:left;">Any value that starts with a letter</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>text</code></td>
	<td style="text-align:left;">The text to be displayed</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">An empty string</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>font</code></td>
	<td style="text-align:left;">The font to be used when drawing the text</td>
	<td style="text-align:left;">See <a href="#fontreferences">font references</a></td>
	<td style="text-align:left;"><code>Graphics.FONT_MEDIUM</code></td>
	<td style="text-align:left;">Cannot be used if a font sequence is provided</td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">The X coordinate of the point that the text will be justified against</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">The Y coordinate of the point that the text will be justified against</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>width</code></td>
	<td style="text-align:left;">The width of the area to fit the text into</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>height</code></td>
	<td style="text-align:left;">The height of the area to fit the text into</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>justification</code></td>
	<td style="text-align:left;">How the text should be justified in relation to the X &amp; Y location</td>
	<td style="text-align:left;"><code>Graphics</code> text justify constant</td>
	<td style="text-align:left;"><code>Graphics.TEXT_JUSTIFY_LEFT</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>color</code></td>
	<td style="text-align:left;">The color of the text</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Graphics.COLOR_WHITE</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>background</code></td>
	<td style="text-align:left;">The background color of the text</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Gfx.COLOR_TRANSPARENT</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>visible</code></td>
	<td style="text-align:left;">The drawable is visible</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;"><code>true</code></td>
	<td style="text-align:left;">Only supported for devices with ConnectIQ 3.3.0 and later</td>
</tr>
</tbody>
</table>

<p>A text area can select a font from a sequence to minimize truncation. The text area will try the fonts in the specified order until the text can be drawn in the given area without truncation. If no font is found that avoids truncation, the last font in the sequence will be used and the text will be truncated. Valid values for each font element are the same as that of the <code>font</code> attribute. An example <code>text-area</code> with a font sequence:</p>

<pre><code class="xml">&lt;text-area id=&quot;BlockOfText&quot; text=&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&quot; x=&quot;10%&quot; y=&quot;10%&quot; width=&quot;80%&quot; height=&quot;80%&quot;&gt;
    &lt;fonts&gt;
        &lt;font&gt;Gfx.FONT_MEDIUM&lt;/font&gt;
        &lt;font&gt;@Rez.Fonts.MySmallFont&lt;/font&gt;
        &lt;font&gt;Gfx.FONT_XTINY&lt;/font&gt;
    &lt;/fonts&gt;
&lt;/text-area&gt;
</code></pre>

<h3 id="fontreferences">Font References</h3>

<p>In layout definitions, there are three ways to refer to fonts:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Reference</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:left;">Example</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">System font reference</td>
	<td style="text-align:left;">Reference the standard FONT enumeration in the <a href="./doc/Toybox/Graphics.html"><code>Graphics</code></a> module.</td>
	<td style="text-align:left;"><code>Graphics.FONT_SMALL</code></td>
</tr>
<tr>
	<td style="text-align:left;">Custom font reference</td>
	<td style="text-align:left;">Reference a font in <a href="./CoreTopics.html/#fonts">application resources</a>.</td>
	<td style="text-align:left;"><code>@Rez.Fonts.MySmallFont</code></td>
</tr>
<tr>
	<td style="text-align:left;">Scalable font reference</td>
	<td style="text-align:left;">Reference a system scalable font. This is the font name or names optionally separated by a comma and the pixel size separated by a colon. See <a href="./CoreTopics.html/#scalablefonts">Scalable Fonts</a> for more information.</td>
	<td style="text-align:left;"><code>&quot;#BionicBold,Roboto:12&quot;</code></td>
</tr>
</tbody>
</table>

<h2 id="drawables-1">Drawables</h2>

<p>Drawables (both bitmaps and drawable XML resources) can also be included in a layout using the <code>drawable</code> tag. The following attributes are supported by the <code>drawable</code> tag:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The handle for the drawable. The ID provided here references the drawable defined in the resource XML file</td>
	<td style="text-align:left;">Any value that starts with a letter</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required; the drawable must also be defined in a resource XML file</td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">The X coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">The Y coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
</tbody>
</table>

<h2 id="drawablelist">Drawable List</h2>

<p>Drawable XML resources consist of a list of basic drawables: bitmaps and shapes. To create an XML drawable, define a <code>&lt;drawable-list&gt;</code> in an XML resource file. Both <code>&lt;bitmap&gt;</code> and <code>&lt;shape&gt;</code> tags should be be placed as child nodes inside the <code>&lt;drawable-list&gt;</code>. An example drawable-list:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;drawable-list id=&quot;Smiley&quot; background=&quot;Gfx.COLOR_YELLOW&quot;&gt;
        &lt;shape type=&quot;circle&quot; x=&quot;10&quot; y=&quot;10&quot; radius=&quot;5&quot; color=&quot;Gfx.COLOR_BLACK&quot; /&gt;
        &lt;shape type=&quot;circle&quot; x=&quot;30&quot; y=&quot;10&quot; radius=&quot;5&quot; color=&quot;Gfx.COLOR_BLACK&quot; /&gt;
        &lt;bitmap id=&quot;mouth&quot; x=&quot;15&quot; y=&quot;25&quot; filename=&quot;../bitmaps/mouth.png&quot; /&gt;
    &lt;/drawable-list&gt;
&lt;/resources&gt;
</code></pre>

<p>To use this drawable in code do the following:</p>

<pre><code class="java">function onUpdate( dc as Dc ) as Void {
    var mySmiley = new Rez.Drawables.Smiley();
    mySmiley.draw( dc );
}
</code></pre>

<p>The <code>&lt;drawable-list&gt;</code> tag supports the following attributes:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the drawable</td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">The X coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">The Y coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>width</code></td>
	<td style="text-align:left;">The width of the drawable list.</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>fill</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>height</code></td>
	<td style="text-align:left;">The height of the drawable list.</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>fill</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>foreground</code></td>
	<td style="text-align:left;">The color of elements (shapes and text) drawn in the drawable</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;">The current draw context&#8217;s foreground color</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>background</code></td>
	<td style="text-align:left;">The background color of the drawable</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Gfx.COLOR_TRANSPARENT</code></td>
	<td style="text-align:left;"></td>
</tr>
</tbody>
</table>

<p>For more, see the <code>Drawable</code> sample app distributed with the SDK.</p>

<h2 id="shape">Shape</h2>

<p>The <code>&lt;shape&gt;</code> tag supports the following attributes:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>type</code></td>
	<td style="text-align:left;">The type of the shape to be drawn</td>
	<td style="text-align:left;"><code>rectangle</code>, <code>ellipse</code>, <code>circle</code>, or <code>polygon</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">For circles and ellipses: X coordinate of the center of the shape in relation to the parent; for everything else: the X coordinate of the top left corner in relation to the parent element.</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">For circles and ellipses: Y coordinate of the center of the shape in relation to the parent; for everything else: the Y coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>points</code></td>
	<td style="text-align:left;">A list of points which defines the <code>polygon</code></td>
	<td style="text-align:left;"><code>[[x1, y1], [x2, y2], ... , [xN, yN]]</code>, points can be relative positions using &#8216;%&#8217;</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required for <code>polygon</code>; must have at least 3 points</td>
</tr>
<tr>
	<td style="text-align:center;"><code>width</code></td>
	<td style="text-align:left;">The width of the shape to be drawn</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>fill</code></td>
	<td style="text-align:left;">Required for <code>rectangle</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>height</code></td>
	<td style="text-align:left;">The height of the shape to be drawn</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>fill</code></td>
	<td style="text-align:left;">Required for <code>rectangle</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>a</code></td>
	<td style="text-align:left;">The a value of the ellipse to be drawn</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>fill</code></td>
	<td style="text-align:left;">Required for <code>ellipse</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>b</code></td>
	<td style="text-align:left;">The b value of the ellipse to be drawn</td>
	<td style="text-align:left;">pixel value, a relative dimension using &#8216;%&#8217;, or <code>fill</code></td>
	<td style="text-align:left;"><code>fill</code></td>
	<td style="text-align:left;">Required for <code>ellipse</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>color</code></td>
	<td style="text-align:left;">The color of the shape to be drawn</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;">The current draw context&#8217;s foreground color</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>corner_radius</code></td>
	<td style="text-align:left;">The radius of the rounded corners of the <code>rectangle</code></td>
	<td style="text-align:left;">pixel value</td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;">Only valid for <code>rectangle</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>radius</code></td>
	<td style="text-align:left;">The radius of the <code>circle</code></td>
	<td style="text-align:left;">pixel value or a relative dimension using &#8216;%&#8217;</td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;">Required for <code>circle</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>border_width</code></td>
	<td style="text-align:left;">The width of the border around the shape</td>
	<td style="text-align:left;">pixel value</td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;">Only valid for <code>rectangle</code>, <code>ellipse</code>, and <code>circle</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>border_color</code></td>
	<td style="text-align:left;">The color of the border around the shape</td>
	<td style="text-align:left;"><code>Graphics</code> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;">The current draw context&#8217;s foreground color</td>
	<td style="text-align:left;">Only valid for <code>rectangle</code>, <code>ellipse</code>, and <code>circle</code></td>
</tr>
</tbody>
</table>

<p>For more see the <code>Drawable</code> sample app distributed with the SDK.</p>

<h2 id="bitmap">Bitmap</h2>

<p>The <code>&lt;bitmap&gt;</code> tag supports the following attributes:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the drawable</td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">The X coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">The Y coordinate of the top left corner in relation to the parent element</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;"><code>0</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>filename</code></td>
	<td style="text-align:left;">The relative path to the image that should be shown</td>
	<td style="text-align:left;">A valid, relative path</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>visible</code></td>
	<td style="text-align:left;">The drawable is visible</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;"><code>true</code></td>
	<td style="text-align:left;">Only supported for devices with ConnectIQ 3.3.0 and later</td>
</tr>
</tbody>
</table>

<h2 id="customdrawables">Custom Drawables</h2>

<p>In some cases it is useful to have a drawable entry within a layout point to a custom defined class which extends <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a>, or any of its directly known subclasses. This is possible by using the <code>class</code> attribute of the <code>&lt;drawable&gt;</code> tag.</p>

<pre><code class="xml">&lt;layout&gt;
    &lt;drawable id=&quot;MoveBar&quot; class=&quot;CustomMoveBar&quot; /&gt;
&lt;/layout&gt;
</code></pre>

<p>The drawable entry above will add a new instance of the <code>CustomMoveBar</code> class to the layout. You can then define how the <code>CustomMoveBar</code> is drawn by overriding the <code>draw(dc)</code> function.</p>

<pre><code class="java">import Toybox.WatchUi;

class CustomMoveBar extends WatchUi.Drawable {
    function draw(dc as Dc) as Void {
        // Draw the move bar here
    }
}
</code></pre>

<h3 id="passingparameterstocustomdrawables">Passing Parameters to Custom Drawables</h3>

<p>If may be useful to pass values into a custom Drawable. To do this you define <code>&lt;param&gt;</code> children within the <code>&lt;drawable&gt;</code> tag. The <code>&lt;param&gt;</code> tag should define the name of the parameter using the <code>name</code> attribute and the value as it&#8217;s content. The content value is passed as is to the custom Drawable. This means if you want to pass a string you must wrap the content in quotes.</p>

<pre><code class="xml">&lt;layout&gt;
    &lt;drawable id=&quot;MoveBar&quot; class=&quot;CustomMoveBar&quot;&gt;
        &lt;param name=&quot;color&quot;&gt;Gfx.COLOR_RED&lt;/param&gt;
        &lt;param name=&quot;string&quot;&gt;&quot;Hello Custom Drawable!&quot;&lt;/param&gt;
    &lt;/drawable&gt;
&lt;/layout&gt;
</code></pre>

<p>The parameters defined in XML are passed to the custom Drawable&#8217;s initialize function as a dictionary. The names are passed as symbols and the values are passed as they appear in the XML.</p>

<pre><code class="typescript">import Toybox.WatchUi;

class CustomMoveBar extends WatchUi.Drawable {

    private var _color, _string;

    public function initialize(params as Dictionary) {
        // You should always call the parent's initializer and
        // in this case you should pass the params along as size
        // and location values may be defined.
        Drawable.initialize(params);

        // Get any extra values you wish to use out of the params Dictionary
        _color = params.get(:color);
        _string = params.get(:string);
    }
}
</code></pre>

<h1 id="graphics">Graphics</h1>

<p>The graphics module handles drawing bitmaps, fonts, and shapes to the device screen.</p>

<h2 id="drawingcontext">Drawing Context</h2>

<p>The <a href="./doc/Toybox/Graphics/Dc.html"><code>Graphics.Dc</code></a> object is used to draw to a graphics surface. The primary device surface is provided to the View object methods <a href="./doc/Toybox/WatchUi/View.html#onLayout-instance_function"><code>View.onLayout()</code></a>, <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function"><code>View.onUpdate()</code></a>, and <a href="./doc/Toybox/WatchUi/View.html#onPartialUpdate-instance_function"><code>View.onPartialUpdate()</code></a>. The size of the surface can be queried with the <a href="./doc/Toybox/Graphics/Dc.html#getWidth-instance_function"><code>Dc.getWidth()</code></a> and <a href="./doc/Toybox/Graphics/Dc.html#getHeight-instance_function"><code>Dc.getHeight()</code></a> methods.</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Primitive or Operation</th>
	<th>Draw</th>
	<th>Fill</th>
	<th>API Level</th>
	<th>Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Set the pen or fill color</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>Dc.setColor()</code></a>, <a href="./doc/Toybox/Graphics/Dc.html#setStroke-instance_function"><code>Dc.setStroke()</code></a></td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>Dc.setColor()</code></a>, <a href="./doc/Toybox/Graphics/Dc.html#setFill-instance_function"><code>Dc.setFill()</code></a></td>
	<td>1.0.0, 4.0.0</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#setStroke-instance_function"><code>setStroke()</code></a> and <a href="./doc/Toybox/Graphics/Dc.html#setFill-instance_function"><code>setFill()</code></a> are API 4.0.0.</td>
</tr>
<tr>
	<td>Set the pen width</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#setPenWidth-instance_function"><code>Dc.setPenWidth()</code></a></td>
	<td>N/A</td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Clear the drawable area</td>
	<td>N/A</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#clear-instance_function"><code>Dc.clear()</code></a></td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a bitmap</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawBitmap-instance_function"><code>Dc.drawBitmap()</code></a></td>
	<td>NA</td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a bitmap</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawBitmap2-instance_function"><code>Dc.drawBitmap2()</code></a></td>
	<td>NA</td>
	<td>4.2.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a text string</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawText-instance_function"><code>Dc.drawText()</code></a></td>
	<td>NA</td>
	<td>1.0.0</td>
	<td>Only works with <a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>setColor()</code></a><a href="#fn:8" id="fnref:8" title="see footnote" class="footnote">[8]</a></td>
</tr>
<tr>
	<td>Draw a pixel</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawPoint-instance_function"><code>Dc.drawPoint()</code></a></td>
	<td>NA</td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a line</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawLine-instance_function"><code>Dc.drawLine()</code></a></td>
	<td>NA</td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a circle</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawCircle-instance_function"><code>Dc.drawCircle()</code></a></td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#fillCircle-instance_function"><code>Dc.fillCircle()</code></a></td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw an ellipse</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawEllipse-instance_function"><code>Dc.drawEllipse()</code></a></td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#fillEllipse-instance_function"><code>Dc.fillEllipse()</code></a></td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a rectangle</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawRectangle-instance_function"><code>Dc.drawRectangle()</code></a></td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#fillRectangle-instance_function"><code>Dc.fillRectangle()</code></a></td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a rounded rectangle</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawRoundedRectangle-instance_function"><code>Dc.drawRoundedRectangle()</code></a></td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#fillRoundedRectangle-instance_function"><code>Dc.fillRoundedRectangle()</code></a></td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw an arc</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawArc-instance_function"><code>Dc.drawArc()</code></a></td>
	<td>N/A</td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Draw a polygon</td>
	<td>N/A<a href="#fn:8" title="see footnote" class="footnote">[8]</a></td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#fillPolygon-instance_function"><code>Dc.fillPolygon()</code></a></td>
	<td>1.0.0</td>
	<td></td>
</tr>
<tr>
	<td>Set the clip area</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#setClip-instance_function"><code>Dc.setClip()</code></a></td>
	<td>N/A</td>
	<td>2.3.0</td>
	<td></td>
</tr>
</tbody>
</table>

<p>The <a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>setColor()</code></a> method allows you to set the foreground and background drawing colors. Colors are passed to <a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>setColor()</code></a> as 24-bit colors of the form 0xRRGGBB. When setting a color, the device will select the closest available color on the system. To see what colors are available on devices, see the <a href="./3UserExperienceGuidelines.html#color">User Experience Guidelines</a>.</p>

<p>A clipping region can be set for a <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a> object using the <a href="./doc/Toybox/Graphics/Dc.html#setClip-instance_function"><code>Dc.setClip()</code></a> method. The top left corner coordinates, width, and height are specified to set this region. All pixels outside of this region will be unaffected by any drawing operations. The pixels within the region will be updated normally. The <a href="./doc/Toybox/Graphics/Dc.html#clearClip-instance_function"><code>Dc.clearClip()</code></a> method will remove the clipping region.</p>

<h2 id="stringsandfonts">Strings and Fonts</h2>

<p>Text can be drawn using the <a href="./doc/Toybox/Graphics/Dc.html#drawText-instance_function"><code>drawText()</code></a> method. The <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a> object also has methods available to get the text width and height of a string with a specified font. Note that text size methods are also available in the Graphics module outside the <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a> object.</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Operation</th>
	<th>Function</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Draw a text string</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawText-instance_function"><code>Dc.drawText()</code></a></td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Draw text at an angle</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawAngledText-instance_function"><code>Dc.drawAngledText()</code></a></td>
	<td>4.2.2</td>
</tr>
<tr>
	<td>Draw text oriented along an arc</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#drawRadialText-instance_function"><code>Dc.drawRadialText()</code></a></td>
	<td>4.2.2</td>
</tr>
<tr>
	<td>Get the width and height of a text string with a given font</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#getTextDimensions-instance_function"><code>Dc.getTextDimensions()</code></a></td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Get the width of a text string with a given font</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#getTextWidthInPixels-instance_function"><code>Dc.getTextWidthInPixels()</code></a></td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Get the height of a given font</td>
	<td><a href="./doc/Toybox/Graphics/Dc.html#getFontHeight-instance_function"><code>Dc.getFontHeight()</code></a>, <a href="./doc/Toybox/Graphics.html#getFontHeight-instance_function"><code>Graphics.getFontHeight()</code></a></td>
	<td>1.0.0, 1.2.0</td>
</tr>
<tr>
	<td>Get the ascent of a given font</td>
	<td><a href="./doc/Toybox/Graphics.html#getFontAscent-instance_function"><code>Graphics.getFontAscent()</code></a></td>
	<td>1.2.0</td>
</tr>
<tr>
	<td>Get the descent of a given font</td>
	<td><a href="./doc/Toybox/Graphics.html#getFontDescent-instance_function"><code>Graphics.getFontDescent()</code></a></td>
	<td>1.2.0</td>
</tr>
<tr>
	<td>Retrieve a system vector font</td>
	<td><a href="./doc/Toybox/Graphics.html#getVectorFont-instance_function"><code>Graphics.getVectorFont()</code></a></td>
	<td>4.2.2</td>
</tr>
</tbody>
</table>

<h3 id="scalablefonts">Scalable Fonts</h3>

<p><em>Since API level 4.2.2</em></p>

<p>Font support for Garmin devices can vary from device to device. All devices support unicode bitmap fonts, but some devices support scalable fonts. If a device supports scalable fonts, the supported fonts are published in the <a href="./ReferenceGuides.html/#devicereference">Reference Guide</a> as <code>Scalable Font</code> entries in the font list.</p>

<p>To access a scalable font, you can call <a href="./doc/Toybox/Graphics.html#getVectorFont-instance_function"><code>Graphics.getVectorFont()</code></a> using the name from the device reference as the <code>:face</code> argument. The <code>:face</code> argument also will take an array of face names. This allows you to specify backup font faces that are acceptable for your needs in case the device doesn&#8217;t support your preferred choice. You can also specify the font size in pixels.</p>

<p>Scalable fonts work with <a href="./doc/Toybox/Graphics/Dc.html#drawText-instance_function"><code>Dc.drawText()</code></a> but can also be used with the <a href="./doc/Toybox/Graphics/Dc.html#drawAngledText-instance_function"><code>Dc.drawAngledText()</code></a> and <a href="./doc/Toybox/Graphics/Dc.html#drawRadialText-instance_function"><code>Dc.drawRadialText()</code></a>. These APIs only support scalable fonts and do not support custom fonts loaded as resources.</p>

<h2 id="anti-aliasing">Anti-Aliasing</h2>

<p><em>Since API level 3.2.0</em></p>

<p>By default, anti-aliasing of primitives like polygons and lines are disabled, but it can be enabled by calling <a href="./doc/Toybox/Graphics/Dc.html#setAntiAlias-instance_function"><code>Dc.setAntiAlias(true)</code></a>. This method is not available before API level 3.2.0 so if your app runs with the API level set below 3.2.0 make sure to guard it with a <code>has</code> check.</p>

<pre><code class="typescript">function draw(dc) {
    if(dc has :setAntiAlias) {
        dc.setAntiAlias(true);
    }
    dc.drawPolygon()
}
</code></pre>

<h2 id="alphachannelscolorfillsstrokeandblendmodes">Alpha Channels, Color, Fills, Stroke and Blend Modes</h2>

<p><em>Since API level 4.0.0</em></p>

<p>API level 4.0.0 adds some powerful new tools to the <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a>:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Function</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">Accepts</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics/Dc.html#setFill-instance_function"><code>Dc.setFill()</code></a></td>
	<td style="text-align:left;">Set fill tool for drawing primitives.</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics.html#ColorType-module"><code>Graphics.ColorType</code></a>, <a href="./doc/Toybox/Graphics/BitmapTexture.html"><code>Graphics.BitmapTexture</code></a></td>
	<td style="text-align:left;">4.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics/Dc.html#setStroke-instance_function"><code>Dc.setStroke()</code></a></td>
	<td style="text-align:left;">Set pen tool for drawing primitives</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics.html#ColorType-module"><code>Graphics.ColorType</code></a>, <a href="./doc/Toybox/Graphics/BitmapTexture.html"><code>Graphics.BitmapTexture</code></a></td>
	<td style="text-align:left;">4.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics/Dc.html#setBlendMode-instance_function"><code>Dc.setBlendMode()</code></a></td>
	<td style="text-align:left;">Set blend mode for drawing</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics.html#BlendMode-module"><code>Graphics.BlendMode</code></a></td>
	<td style="text-align:left;">4.0.0</td>
</tr>
</tbody>
</table>

<p>Previously, the <a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>setColor()</code></a> API allowed the setting of a foreground or background color based on a 24-bit RRGGBB value. <a href="./doc/Toybox/Graphics/Dc.html#setFill-instance_function"><code>setFill()</code></a> and <a href="./doc/Toybox/Graphics/Dc.html#setStroke-instance_function"><code>setStroke()</code></a> both accept 32-bit AARRGGBB values, allowing you to provide an alpha channel value with the RGB value. The <a href="./doc/Toybox/Graphics/Dc.html#setStroke-instance_function"><code>setStroke()</code></a> API allows setting the pen tool for the Dc, while <a href="./doc/Toybox/Graphics/Dc.html#setFill-instance_function"><code>setFill()</code></a> sets the fill tool.</p>

<p>You can also set the blend mode with <a href="./doc/Toybox/Graphics/Dc.html#setBlendMode-instance_function"><code>setBlendMode()</code></a>. By default, the system will blend your color with whatever is being drawn over. However, you can use <a href="./doc/Toybox/Graphics.html#BlendMode-module"><code>BLEND_MODE_NO_BLEND</code></a> to set the color and alpha of a <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> directly. You can also use <a href="./doc/Toybox/Graphics.html#BlendMode-module"><code>BLEND_MODE_ADDITION</code></a> to have your blend added to the channels being drawn to.</p>

<p>In addition to colors, you can now also provide a <a href="./doc/Toybox/Graphics/BitmapTexture.html"><code>BitmapTexture</code></a>. This allows a primitive to be filled by a bitmap and opens up many new drawing possibilities.</p>

<h2 id="bitmaps">Bitmaps</h2>

<p>Bitmap resources can be added to your executable using the <a href="./CoreTopics.html/#bitmaps">resource compiler</a>. You can use <a href="./doc/Toybox/Application.html#loadResource-instance_function"><code>Application.loadResource()</code></a> to load a bitmap at runtime, and <a href="./doc/Toybox/Graphics/Dc.html#drawBitmap-instance_function"><code>Dc.drawBitmap()</code></a> or <a href="./doc/Toybox/Graphics/Dc.html#drawBitmap2-instance_function"><code>Dc.drawBitmap2()</code></a> to render it to the screen on the <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function">View.onUpdate()</a> call.</p>

<h3 id="transformation">Transformation</h3>

<p><em>Since API level 4.2.2</em></p>

<p>Connect IQ allows you to create two-dimensional affine transforms using the <a href="./doc/Toybox/Graphics/AffineTransform.html"><code>Graphics.AffineTransform</code></a> class. <a href="./doc/Toybox/Graphics/AffineTransform.html"><code>AffineTransform</code></a> provides access to the underlying transformation matrix and common operations like <a href="./doc/Toybox/Graphics/AffineTransform.html#rotate-instance_function">rotation</a>, <a href="./doc/Toybox/Graphics/AffineTransform.html#scaling-instance_function">scaling</a> and <a href="./doc/Toybox/Graphics/AffineTransform.html#shear-instance_function">shearing</a><a href="#fn:9" id="fnref:9" title="see footnote" class="footnote">[9]</a>. To apply the transform, pass the <a href="./doc/Toybox/Graphics/AffineTransform.html"><code>AffineTransform</code></a> into <a href="./doc/Toybox/Graphics/Dc.html#drawBitmap2-instance_function"><code>Dc.drawBitmap2()</code></a> as the <code>:transform</code> argument in the options dictionary.</p>

<h3 id="tinting">Tinting</h3>

<p><em>Since API level 4.2.2</em></p>

<p>Sometimes you want the color of an asset, like an icon, to be user-definable. For example, you may want the complication icons on a watch face to match a user-defined theme color. One of the features of <a href="./doc/Toybox/Graphics/Dc.html#drawBitmap2-instance_function"><code>Dc.drawBitmap2()</code></a> is the ability to apply a tint color to an asset. The <code>:tintColor</code> option can be used to specify a color to apply to a grayscale asset.</p>

<h3 id="graphicspool">Graphics Pool</h3>

<p><em>Since API level 4.0.0</em></p>

<p>Before API level 4.0.0, all resources loaded at runtime into the application heap. This heap is used to hold your code, data, stack and runtime objects, so loading images could quickly limit the runtime functionality of your app. API level 4.0.0 introduced a new graphics pool that is separate from your application heap. When you load a bitmap or font at runtime, the resource will load into the graphics pool, and you will be returned a <a href="./doc/Toybox/Graphics/ResourceReference.html"><code>Graphics.ResourceReference</code></a>. The graphics pool dynamically caches, unloads and reloads your resources behind the scenes based on available memory. All the drawing primitives that accept resource objects also accept references so your app should not have to be reworked to take advantage of the new system.</p>

<p>Calling <a href="./doc/Toybox/Graphics/ResourceReference.html#get-instance_function"><code>ResourceReference.get()</code></a> on a reference will return a resource object. As long as the object returned is in scope, the resource will be locked in the graphics pool.</p>

<h3 id="bufferedbitmaps">Buffered Bitmaps</h3>

<p><em>Since API level 2.3.0</em></p>

<p>The <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>Graphics.BufferedBitmap</code></a> class can be used to draw to surface other than the primary display surface. There are two options for creating a <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> object. The first is to generate one from a loaded bitmap resource. In this case, the provided bitmap is used as the drawing surface that is manipulated. The second option is to specify the width, and height of the surface, and optionally a color palette. If no color palette is specified, the <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> will use the system colors, and will not have a palette. If a bitmap resource is provided to the initializer, the width, height, and palette parameters are ignored.</p>

<p>If a <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> does have a palette, it can be read using the <a href="./doc/Toybox/Graphics/BufferedBitmap.html#getPalette-instance_function"><code>BufferedBitmap.getPalette()</code></a> method. The palette can also be modified using the <a href="./doc/Toybox/Graphics/BufferedBitmap.html#setPalette-instance_function"><code>BufferedBitmap.setPalette()</code></a> method. The palette provided must have the same number of colors as the existing palette for that bitmap. All pixels in the image will change color to the new color assigned at each color index. Note that Bitmaps with a palette that are generated by the resource compiler will have an additional transparent index at the end of the specified palette unless the <code>disableTransparency</code> flag has been specified.</p>

<p>A Drawing Context can be obtained from the <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> using the <a href="./doc/Toybox/Graphics/BufferedBitmap.html#getDc-instance_function"><code>BufferedBitmap.getDc()</code></a> method. This returns a <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a> class that has the same capabilities as the primary device <a href="./doc/Toybox/Graphics/Dc.html"><code>Dc</code></a> that is provided to the methods <a href="./doc/Toybox/WatchUi/View.html#onLayout-instance_function"><code>View.onLayout()</code></a>, <a href="./doc/Toybox/WatchUi/View.html#onUpdate-instance_function"><code>View.onUpdate()</code></a>, and <a href="./doc/Toybox/WatchUi/View.html#onPartialUpdate-instance_function"><code>View.onPartialUpdate()</code></a>. This object can be used to modify the contents of the <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> by drawing shapes, text, and bitmaps to it.</p>

<h4 id="bufferedbitmapsandthegraphicspool">Buffered Bitmaps and the Graphics Pool</h4>

<p><a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> objects, like other graphics resources, now take advantage of the graphics pool, as well. The advantage of this scenario is that you can now liberally use temporary graphics buffers without running out of application heap.</p>

<p>As noted earlier, the graphics pool will intelligently purge and restore resources from the pool if the loaded resources exceed the available pool space. Unlike static resources that are reloaded from your executable, <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> are not restored if they have been purged. This works fine if you are using a short-lived, temporary buffer, but if your bitmap is purged after allocation, you need to re-render its contents. Alternatively, you can call the get() method on the reference to get a locked version of the bitmap. This will prevent the <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a> object from being purged from the pool, but it can also lead to the graphics pool running out of available space if more resources are loaded.</p>

<p>To create a <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a>, use the <a href="./doc/Toybox/Graphics.html#createBufferedBitmap-instance_function"><code>Graphics.createBufferedBitmap()</code></a> API. If your application runs on pre-API level 4.0 devices, use a has check for allocating your <a href="./doc/Toybox/Graphics/BufferedBitmap.html"><code>BufferedBitmap</code></a>:</p>

<pre><code class="typescript">import Toybox.Graphics;

//! Factory function to create buffered bitmap
function bufferedBitmapFactory(options as {
            :width as Number,
            :height as Number,
            :palette as Array&lt;ColorType&gt;,
            :colorDepth as Number,
            :bitmapResource as WatchUi.BitmapResource
        }) as BufferedBitmapReference or BufferedBitmap {
    if (Graphics has :createBufferedBitmap) {
        return Graphics.createBufferedBitmap(options);
    } else {
        return new Graphics.BufferedBitmap(options);
    }
}
</code></pre>

<h1 id="inputhandling">Input Handling</h1>

<p>As if input handling wasn&#8217;t already one of the most important and complicated pieces of a UI toolkit, Garmin devices take the complication up a level. Unlike those touchable glowing rectangles that are modern smart phones, Garmin devices come in lots of shapes and sizes. Touch screens are not always ideal for all watch products, so there is a mix of input styles and screen technologies. It&#8217;s the job of the UI toolkit to make this coherent to the developer.</p>

<h2 id="inputandapptypes">Input and App Types</h2>

<p>Not all app types have full access to input. A watch face can only know if it has been <a href="./doc/Toybox/WatchUi/WatchFaceDelegate.html#onPress-instance_function">pressed</a> and data fields can only know if they have been <a href="./doc/Toybox/WatchUi/InputDelegate.html#onTap-instance_function">tapped</a>. Widgets and glances can receive input (may be limited on some devices) while watch-apps will have the most input capability.</p>

<h2 id="inputdelegates">Input Delegates</h2>

<p>The delegate object implements a certain interface specific to input handling. Monkey C provides a low level <a href="./doc/Toybox/WatchUi/InputDelegate.html"><code>WatchUi.InputDelegate</code></a> that allows handling of events at a basic level. This is useful for situations when the app needs to handle button presses or touchscreen interactions in a particular way.</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>API</th>
	<th>Purpose</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onDrag-instance_function"><code>InputDelegate.onDrag()</code></a></td>
	<td>This is sent when the user is dragging the touch screen</td>
	<td>3.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onFlick-instance_function"><code>InputDelegate.onFlick()</code></a></td>
	<td>This is sent when the user has flicked the touch screen</td>
	<td>3.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onKey-instance_function"><code>InputDelegate.onKey()</code></a></td>
	<td>A physical button has been pressed and released</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onKeyPressed-instance_function"><code>InputDelegate.onKeyPressed()</code></a></td>
	<td>A physical button has been pressed down</td>
	<td>1.1.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onKeyReleased-instance_function"><code>InputDelegate.onKeyReleased()</code></a></td>
	<td>A physical button has been pressed released after being pressed down</td>
	<td>1.1.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onTap-instance_function"><code>InputDelegate.onTap()</code></a></td>
	<td>This is sent when the touch screen is tapped (a quick touch and release)</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onHold-instance_function"><code>InputDelegate.onHold()</code></a></td>
	<td>This is sent when the touch screen is touched and not released</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onHold-instance_function"><code>InputDelegate.onRelease()</code></a></td>
	<td>This is only sent after an <a href="./doc/Toybox/WatchUi/InputDelegate.html#onHold-instance_function"><code>onHold()</code></a> event, once the hold on the touch screen is released</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/WatchUi/InputDelegate.html#onSwipe-instance_function"><code>InputDelegate.onSwipe()</code></a></td>
	<td>This is sent when the touch screen is swiped</td>
	<td>1.0.0</td>
</tr>
</tbody>
</table>

<p>To process input events, extend the <a href="./doc/Toybox/WatchUi/InputDelegate.html"><code>InputDelegate</code></a> and override the appropriate handler operation. If you return <code>true</code> in the handler, the system will know the event has been handled. Returning <code>false</code> will tell the system to handle the input.</p>

<p>For more see the <code>Input</code> sample app distributed with the SDK.</p>

<h2 id="behaviors">Behaviors</h2>

<p>Garmin makes products with a purpose, and that purpose can alter the design of one product line over another. Deciding whether a product has a touch screen or has buttons can depend on the environment in which the user will take. For instance, if the product is intended to be used in water (swimming, canoeing, on a boat), it may not have a touch screen. These decisions make for superior products, but also add to developer frustration due to device fragmentation.</p>

<p>Most products will support common behaviors (next page, back a page), but how they are executed by the user may differ based on the available input types. To help with this dilemma, Monkey C exposes events at a behavior level. Behaviors separate high-level intentions from the actual input type&mdash;next page versus screen press. The <a href="./doc/Toybox/WatchUi/BehaviorDelegate.html"><code>WatchUi.BehaviorDelegate</code></a> is a super class of <a href="./doc/Toybox/WatchUi/InputDelegate.html"><code>InputDelegate</code></a> and maps its low level inputs to common operations across multiple products. Using the <a href="./doc/Toybox/WatchUi/BehaviorDelegate.html"><code>BehaviorDelegate</code></a> can lead to much more portable code.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi/BehaviorDelegate.html#onBack-instance_function"><code>BehaviorDelegate.onBack()</code></a></td>
	<td style="text-align:left;">Handle the user performing the back behavior</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi/BehaviorDelegate.html#onMenu-instance_function"><code>BehaviorDelegate.onMenu()</code></a></td>
	<td style="text-align:left;">Handle the user performing the menu behavior</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi/BehaviorDelegate.html#onNextPage-instance_function"><code>BehaviorDelegate.onNextPage()</code></a></td>
	<td style="text-align:left;">Handle the user performing a next page in page loop behavior</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi/BehaviorDelegate.html#onPreviousPage-instance_function"><code>BehaviorDelegate.onPreviousPage()</code></a></td>
	<td style="text-align:left;">Handle the user performing a previous page in page loop behavior</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi/BehaviorDelegate.html#onSelect-instance_function"><code>BehaviorDelegate.onSelect()</code></a></td>
	<td style="text-align:left;">Handle the user performing a select behavior</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
</tbody>
</table>

<h2 id="selectablesandbuttons">Selectables and Buttons</h2>

<h3 id="selectables">Selectables</h3>

<p><em>Since API level 2.1.0</em></p>

<p>Monkey C provides an interface for products with large touch screens (and few buttons) to easily define touchable objects on-screen known as a <a href="./doc/Toybox/WatchUi/Selectable.html"><code>WatchUi.Selectable</code></a>.</p>

<p>A <a href="./doc/Toybox/WatchUi/Selectable.html"><code>Selectable</code></a> is a state driven object that supports four optional built-in states which are set based on touch interaction:</p>

<ul>
<li>Default (<code>:stateDefault</code>) - Initial state</li>
<li>Highlighted (<code>:stateHighlighted</code>) - Selectable is currently being pressed</li>
<li>Selected (<code>:stateSelected</code>) - Selectable was pressed and released (i.e. tapped)</li>
<li>Disabled (<code>:stateDisabled</code>) - Selectable has been disabled</li>
</ul>

<p>Once a state change occurs, a <a href="./doc/Toybox/WatchUi/SelectableEvent.html"><code>WatchUi.SelectableEvent</code></a> is sent which results in a call to <a href="./doc/Toybox/WatchUi/InputDelegate.html#onSelectable-instance_function"><code>InputDelegate.onSelectable()</code></a>, which passes both the instance of the current Selectable and the symbol of the previous state for comparison, and allows for custom actions as a result of the state change. Selectables <em>must</em> be registered as part of the View&#8217;s layout via the <a href="./doc/Toybox/WatchUi/View.html#setLayout-instance_function"><code>View.setLayout()</code></a> call in order to for the View to know about them and direct touch events to the object. Stacked instances of Selectables will have input directed to them depending on their order as passed to <a href="./doc/Toybox/WatchUi/View.html#setLayout-instance_function"><code>setLayout()</code></a> (last in, first drawn / selected).</p>

<p>Each of the four states must be mapped to a <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a>, Graphics.COLOR constant, or 24-bit integer of the form 0xRRGGBB. States are optionally defined and be specified in the <a href="./doc/Toybox/WatchUi/Selectable.html"><code>Selectable</code></a> constructor, or manually modified as members of the instance. Each <a href="./doc/Toybox/WatchUi/Selectable.html"><code>Selectable</code></a> will draw the current state using the defined <code>locX</code> and <code>locY</code> coordinates as an offset if it has been defined. Extending <a href="./doc/Toybox/WatchUi/Selectable.html"><code>Selectable</code></a> with additional states is encouraged and the <a href="./doc/Toybox/WatchUi/Selectable.html#getState-instance_function"><code>getState()</code></a> and <a href="./doc/Toybox/WatchUi/Selectable.html#setState-instance_function"><code>setState()</code></a> routines may used to alter the default state machine (see Selectable sample application for a demonstration of check boxes).</p>

<p>A <a href="./doc/Toybox/WatchUi/Button.html"><code>Button</code></a> is derived from <a href="./doc/Toybox/WatchUi/Selectable.html"><code>Selectable</code></a> and adds the ability to define a background and map interaction to an existing or new custom method (i.e. <code>onMenu()</code>) within <a href="./doc/Toybox/WatchUi/BehaviorDelegate.html"><code>BehaviorDelegate</code></a>.</p>

<h3 id="button-onlyandtouchscreeninterfaces">Button-Only and Touch Screen Interfaces</h3>

<p>It can be difficult to make a user interface that operates with both button-only products and products with touch screens. You can use <a href="./doc/Toybox/WatchUi/View.html#setKeyToSelectableInteraction-instance_function"><code>View.setKeyToSelectableInteraction()</code></a> to enable compatibility mode with button-only products. <a href="./doc/Toybox/WatchUi/View.html#setKeyToSelectableInteraction-instance_function"><code>setKeyToSelectableInteraction()</code></a> may be called to enable the up/down keys to cycle through the list of Selectables registered via the View&#8217;s <a href="./doc/Toybox/WatchUi/View.html#setLayout-instance_function"><code>setLayout()</code></a> call, which sets the highlighted state on a <a href="./doc/Toybox/WatchUi/Selectable.html"><code>Selectable</code></a> until it is put in the Selected state via the enter key.</p>

<h3 id="definingselectablesandbuttonsinlayouts">Defining Selectables And Buttons In Layouts</h3>

<p>Much like their parent <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a>, Selectables and Buttons both support the layout system. Selectable and Button XML resources consist of a list of state ID&#8217;s and optional parameters. To create an XML Selectable, define a <code>&lt;selectable&gt;</code> in an XML resource file:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the Selectable</td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>x</code></td>
	<td style="text-align:left;">The X coordinate of the top left corner of the Selectable region</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>left</code>, <code>right</code>, or <code>start</code></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>y</code></td>
	<td style="text-align:left;">The Y coordinate of the top left corner of the Selectable region</td>
	<td style="text-align:left;">pixel value, a relative position using &#8216;%&#8217;, <code>center</code>, <code>top</code>, <code>bottom</code>, or <code>start</code></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>width</code></td>
	<td style="text-align:left;">The width of the Selectable region</td>
	<td style="text-align:left;">pixel value or a relative dimension using &#8216;%&#8217; or <code>fill</code></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>height</code></td>
	<td style="text-align:left;">The height of the Selectable region</td>
	<td style="text-align:left;">pixel value or a relative dimension using &#8216;%&#8217; or <code>fill</code></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required</td>
</tr>
</tbody>
</table>

<p>The <code>&lt;button&gt;</code> resource expands the definition of <code>&lt;selectable&gt;</code> and adds the following:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>behavior</code></td>
	<td style="text-align:left;">A method existing within a View&#8217;s registered BehaviorDelegate</td>
	<td style="text-align:left;">Method symbol</td>
	<td style="text-align:left;"><code>null</code></td>
	<td style="text-align:left;">Optional / Param</td>
</tr>
<tr>
	<td style="text-align:center;"><code>background</code></td>
	<td style="text-align:left;">The background color of the Button</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics.html#ColorValue-module"><code>Graphics.ColorValue</code></a> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Graphics.COLOR_TRANSPARENT</code></td>
	<td style="text-align:left;">Optional / Param</td>
</tr>
</tbody>
</table>

<p>Both <code>&lt;selectable&gt;</code> and <code>&lt;button&gt;</code> tags use <code>&lt;state&gt;</code> as child nodes to define their states at construction. Each state is defined optionally but is defined as the following:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The state ID for the Button / Selectable</td>
	<td style="text-align:left;"><code>stateDefault</code>, <code>stateHighlighted</code>, <code>stateSelected</code>, or <code>stateDisabled</code></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>bitmap</code></td>
	<td style="text-align:left;">A bitmap resource in the layout drawn at the Selectable / Button origin</td>
	<td style="text-align:left;"><code>WatchUi.Bitmap</code> objects</td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required or either <code>color</code> or <code>drawable</code> must be specified</td>
</tr>
<tr>
	<td style="text-align:center;"><code>color</code></td>
	<td style="text-align:left;">A color fill applied to the Selectable / Button region</td>
	<td style="text-align:left;"><a href="./doc/Toybox/Graphics.html#ColorValue-module"><code>Graphics.ColorValue</code></a> color constant or a 24-bit integer of the form <code>0xRRGGBB</code></td>
	<td style="text-align:left;"><code>Graphics.COLOR_TRANSPARENT</code></td>
	<td style="text-align:left;">Required or either <code>bitmap</code> or <code>drawable</code> must be specified</td>
</tr>
<tr>
	<td style="text-align:center;"><code>drawable</code></td>
	<td style="text-align:left;">A drawable object in the layout drawn at the Selectable / Button origin</td>
	<td style="text-align:left;"><code>WatchUi.Drawable</code> objects</td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Required or either <code>bitmap</code> or <code>color</code> must be specified</td>
</tr>
</tbody>
</table>

<p>An example layout containing two a menu and back button:</p>

<pre><code class="xml">&lt;layout id=&quot;ButtonLayout&quot;&gt;
    &lt;button x=&quot;40&quot; y=&quot;center&quot; width=&quot;50&quot; height=&quot;50&quot; background=&quot;Gfx.COLOR_BLACK&quot; behavior=&quot;onBack&quot;&gt;
        &lt;state id=&quot;stateDefault&quot; bitmap=&quot;@Drawables.DefaultBackButton&quot; /&gt;
        &lt;state id=&quot;stateHighlighted&quot; bitmap=&quot;@Drawables.PressedBackButton&quot; /&gt;
        &lt;state id=&quot;stateSelected&quot; bitmap=&quot;@Drawables.PressedBackButton&quot; /&gt;
        &lt;state id=&quot;stateDisabled&quot; color=&quot;Graphics.COLOR_BLACK&quot; /&gt;
    &lt;/button&gt;
    &lt;button x=&quot;115&quot; y=&quot;center&quot; width=&quot;50&quot; height=&quot;50&quot;&gt;
        &lt;state id=&quot;stateDefault&quot; bitmap=&quot;@Drawables.DefaultMenuButton&quot; /&gt;
        &lt;state id=&quot;stateHighlighted&quot; bitmap=&quot;@Drawables.PressedMenuButton&quot; /&gt;
        &lt;state id=&quot;stateSelected&quot; bitmap=&quot;@Drawables.PressedMenuButton&quot; /&gt;
        &lt;state id=&quot;stateDisabled&quot; color=&quot;Graphics.COLOR_BLACK&quot; /&gt;
        &lt;param name=&quot;background&quot;&gt;Graphics.COLOR_BLACK&lt;/param&gt;
        &lt;param name=&quot;behavior&quot;&gt;onMenu&lt;/param&gt;
    &lt;/button&gt;
&lt;/layout&gt;
</code></pre>

<p>For more, see the <code>Selectable</code> sample app distributed with the SDK.</p>

<h1 id="nativeuicontrols">Native UI Controls</h1>
<figure>
<img src="./resources/programmers-guide/artsy-monkey.png" style="max-width:300px;" title="We're going to put a happy semicolon over here. Happy semicolon..."/>
</figure>

<p><a href="./doc/Toybox/WatchUi.html"><code>Toybox.WatchUi</code></a> provides a number of native widgets to handle input:</p>

<ul>
<li>Menus</li>
<li>Generic Picker</li>
<li>Confirmation Dialog</li>
<li>Progress Bar</li>
<li>Page Loops</li>
<li>Toasts</li>
<li>Data Fields</li>
<li>Map Views</li>
</ul>

<p>Two additional handlers provided by <a href="./doc/Toybox/WatchUi.html"><code>WatchUi</code></a> can be used to give feedback to the user: the confirmation dialog and progress dialog.</p>

<h2 id="menus">Menus</h2>

<p>Menus are full screen lists of options for the user. Menus can be used to present options or settings for the user to choose from.</p>

<h3 id="menu2">Menu2</h3>

<p><em>Since API level 3.0.0</em></p>

<p>The <a href="./doc/Toybox/WatchUi/Menu2.html"><code>WatchUi.Menu2</code></a> system allows for complex menu user interfaces. The <a href="./doc/Toybox/WatchUi/Menu2.html"><code>Menu2</code></a> class includes new capabilities like graphical titles<a href="#fn:10" id="fnref:10" title="see footnote" class="footnote">[10]</a>, menu items that can be updated dynamically, and additional menu elements such as check boxes. The Menu2 system includes multiple new classes. Let&#8217;s start with the most simple of the new menu elements.</p>

<p>Here is a basic implementation of a Menu2 using a simple <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>WatchUi.MenuItem</code></a>:</p>

<pre><code class="c++">import Toybox.WatchUi;

class MyBehaviorDelegate extends WatchUi.BehaviorDelegate {
    function initialize() {
        BehaviorDelegate.initialize();
    }

    function onMenu() as Boolean{
        var menu = new WatchUi.Menu2({:title=&gt;&quot;My Menu2&quot;});
        var delegate;

        // Add a new MenuItem to the Menu2 object
        menu.addItem(
            new MenuItem(

                // Set the 'Label' parameter
                &quot;Item 1 Label&quot;,

                // Set the `subLabel` parameter
                &quot;Item 1 subLabel&quot;,

                // Set the `identifier` parameter
                &quot;itemOneId&quot;,
                // Set the options, in this case `null`
                {}
            )
        );

        menu.addItem(
            new MenuItem(
                &quot;Item 2 Label&quot;,
                &quot;Item 2 subLabel&quot;,
                &quot;itemTwoId&quot;,
                {}
            )
        );

        // Create a new Menu2InputDelegate
        delegate = new MyMenu2Delegate(); // a WatchUi.Menu2InputDelegate

        // Push the Menu2 View set up in the initializer
        WatchUi.pushView(menu, delegate, WatchUi.SLIDE_IMMEDIATE);
        return true;
    }
}
</code></pre>

<p>While the <a href="./doc/Toybox/WatchUi/Menu.html"><code>Menu</code></a> example is built using the resource system, the <a href="./doc/Toybox/WatchUi/Menu2.html"><code>Menu2</code></a> example above is built programmatically. Let&#8217;s take a look at some of the new features demonstrated:</p>

<dl>
<dt>new WatchUi.Menu2</dt>
<dd>The <a href="./doc/Toybox/WatchUi/Menu2.html"><code>Menu2</code></a> class is a special <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a> that is similar to <a href="./doc/Toybox/WatchUi/Menu.html"><code>Menu</code></a> that presents the user with a list of options.</dd>

<dt>MenuItem</dt>
<dd>The MenuItem object constructor takes four parameters: <code>label</code>, <code>subLabel</code>, <code>identifier</code>, and <code>options</code>. Each <code>MenuItem</code> can display a label and sub-label defined by the first two parameters. Here is a diagram that demonstrates the layout of the label and sub-label in <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>MenuItem</code></a>:</dd>
</dl>
<div class="center">
<figure>
<img src="./resources/programmers-guide/Menu2_labels.png" style="max-width:800px;" alt="Illustration of label and sub-labels in Menu2" />
<figcaption>An Illustration of label and sub-labels in <code>Menu2</code></figcaption>
</figure>
</div>

<p>The <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>MenuItem</code></a> <code>identifier</code> is an object, typically a string, and is used to identify the <code>MenuItem</code> object in event calls. There is a fourth parameter which is a <code>Dictionary</code> of options which can be <code>null</code>.</p>

<dl>
<dt>WatchUi.Menu2InputDelegate</dt>
<dd>The new <a href="./doc/Toybox/WatchUi/Menu2InputDelegate.html"><code>Menu2InputDelegate</code></a> class is used to handle selected Menu2 items. This object handles these selections with three methods:</dd>
</dl>

<ul>
<li><a href="./doc/Toybox/WatchUi/Menu2InputDelegate.html#onBack-instance_function"><code>onBack()</code></a> - Handles the back key and pops the current page off the stack if not overridden.</li>
<li><a href="./doc/Toybox/WatchUi/Menu2InputDelegate.html#onDone-instance_function"><code>onDone()</code></a> - Used with a specialized <a href="./doc/Toybox/WatchUi/CheckboxMenu.html"><code>CheckboxMenu</code></a>. Pops the current page when not overridden.</li>
<li><a href="./doc/Toybox/WatchUi/Menu2InputDelegate.html#onSelect-instance_function"><code>onSelect()</code></a> - Handles when a Menu2 item is selected.</li>
</ul>

<p>For more, see the <code>Menu2Sample</code> sample app distributed with the SDK.</p>

<h4 id="menu2xmlresources">Menu2 XML Resources</h4>

<p>A basic <a href="./doc/Toybox/WatchUi/Menu2.html"><code>Menu2</code></a> can be defined in XML as a resource as follows:</p>

<pre><code class="XML">&lt;menu2 id=&quot;MainMenu&quot; title=&quot;@Strings.MainMenuTitle&quot;&gt;
  &lt;menu-item id=&quot;generic1&quot; label=&quot;Generic 1&quot; subLabel=&quot;With Sublabel&quot;&gt;&lt;/menu-item&gt;
  &lt;menu-item id=&quot;generic2&quot; label=&quot;Generic 2&quot;&gt;&lt;/menu-item&gt;
&lt;/menu2&gt;
</code></pre>

<p>Here are the attributes and definitions of a <a href="./doc/Toybox/WatchUi/Menu2.html"><code>Menu2</code></a> defined as an XML resource:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the <code>&lt;menu-item&gt;</code></td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>title</code></td>
	<td style="text-align:left;">The label text to be displayed as the header</td>
	<td style="text-align:left;">A valid <a href="./doc/Toybox/WatchUi/Drawable.html"><code>Drawable</code></a> identifier, a string resource, or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">optional</td>
</tr>
<tr>
	<td style="text-align:center;"><code>icon</code></td>
	<td style="text-align:left;">The icon to display in the sub-window (Instinct 2 only)</td>
	<td style="text-align:left;">Bitmap resource identifier</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>dividerType</code></td>
	<td style="text-align:left;">The location of the divider (5.0.1+ device support only)</td>
	<td style="text-align:left;">A <a href="./doc/Toybox/WatchUi/Menu2.html#DividerType-module"><code>DividerType</code></a></td>
	<td style="text-align:left;"><code>WatchUi.Menu2.DIVIDER_TYPE_DEFAULT</code></td>
	<td style="text-align:left;">optional</td>
</tr>
<tr>
	<td style="text-align:center;"><code>theme</code></td>
	<td style="text-align:left;">The background color of a menu item</td>
	<td style="text-align:left;">A <a href="./doc/Toybox/WatchUi.html#MenuTheme-module"><code>MenuTheme</code></a> or &#8220;disabled&#8221;</td>
	<td style="text-align:left;"><code>WatchUi.MENU_THEME_DEFAULT</code></td>
	<td style="text-align:left;">optional</td>
</tr>
<tr>
	<td style="text-align:center;"><code>personality</code></td>
	<td style="text-align:left;">The personality class for the menu</td>
	<td style="text-align:left;">A defined personality class</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a> </td>
</tr>
</tbody>
</table>

<p>The <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>MenuItem</code></a> identified as &#8220;generic1&#8221; uses both a label and sublabel. The &#8220;generic2&#8221; item uses only a label.</p>

<p>Here are the attributes and definitions of a <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>MenuItem</code></a> defined as an XML resource:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the <code>&lt;menu-item&gt;</code></td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>label</code></td>
	<td style="text-align:left;">The label text to be displayed</td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>subLabel</code></td>
	<td style="text-align:left;">The sub-label text to be displayed</td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>icon</code></td>
	<td style="text-align:left;">The icon to display in the sub-window (Instinct 2 only)</td>
	<td style="text-align:left;">Bitmap resource identifier</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
</tbody>
</table>

<p>The most exciting part about Menu2 is the use of icons, check boxes and toggles within menus. All Menu2 items can be created and launched in the same way, but each new menu item behaves uniquely. We&#8217;ve already seen the basic <code>MenuItem</code> class. Lets talk about some of the specifics when using the others.</p>

<h4 id="iconmenuitem">Icon Menu Item</h4>

<p>The <a href="./doc/Toybox/WatchUi/IconMenuItem.html"><code>IconMenuItem</code></a> class allows developers to implement an icon based menu system. The <a href="./doc/Toybox/WatchUi/IconMenuItem.html"><code>IconMenuItem</code></a> uses a label and sub-label, but also includes an icon that may be displayed to the right or left of the label and sub-label text.</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/IconFigure.png" style="max-width:800px;" alt="Illustration of a `IconMenuItem` in in Menu2" />
<figcaption>An illustration of an <code>IconMenuItem</code> in <code>Menu2</code></figcaption>
</figure>
</div>

<p>Here is an <code>IconMenuItem</code> created as an XML resource:</p>

<pre><code class="XML">&lt;menu2 id=&quot;IconMenu&quot; title=&quot;@Strings.IconMenuTitle&quot;&gt;
    &lt;icon-menu-item id=&quot;defaultAlign&quot; label=&quot;@Strings.IconDefaultLabel&quot; subLabel=&quot;@Strings.IconDummySubLabel&quot;
     icon=&quot;@Drawables.LauncherIcon&quot; /&gt;
    &lt;icon-menu-item id=&quot;right&quot; label=&quot;@Strings.IconRightLabel&quot; subLabel=&quot;@Strings.IconDummySubLabel&quot;
     icon=&quot;@Drawables.LauncherIcon&quot;&gt;
        &lt;param name=&quot;alignment&quot;&gt;WatchUi.MenuItem.MENU_ITEM_LABEL_ALIGN_RIGHT&lt;/param&gt;
    &lt;/icon-menu-item&gt;
&lt;/menu2&gt;
</code></pre>

<p>Here are the attributes available for <code>&lt;icon-menu-item&gt;</code>:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the <code>&lt;icon-menu-item&gt;</code></td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>label</code></td>
	<td style="text-align:left;">The label text to be displayed</td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>subLabel</code></td>
	<td style="text-align:left;">The sub-label text to be displayed</td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>icon</code></td>
	<td style="text-align:left;">The icon to be displayed</td>
	<td style="text-align:left;">A valid drawable resource or custom drawable</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
</tbody>
</table>

<h4 id="checkboxandtogglemenuitems">Checkbox and Toggle Menu Items</h4>

<p>The <a href="./doc/Toybox/WatchUi/CheckboxMenuItem.html"><code>WatchUi.CheckboxMenuItem</code></a> allows users to check multiple items in a list of menu items and save their state at one time (i.e. selecting play lists for music content). The <a href="./doc/Toybox/WatchUi/CheckboxMenuItem.html"><code>CheckboxMenuItem</code></a> class is used in combination with a class extending the <a href="./doc/Toybox/WatchUi/CheckboxMenu.html"><code>WatchUi.CheckboxMenu</code></a> View and a <a href="./doc/Toybox/WatchUi/Menu2InputDelegate.html"><code>Menu2InputDelegate</code></a>.</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/CheckboxFigure.png" style="max-width:800px;" alt="Illustration of a `CheckboxMenuItem` in in Menu2" />
<figcaption>An illustration of a <code>CheckboxMenuItem</code> in <code>Menu2</code></figcaption>
</figure>
</div>

<p>Developers define a <a href="./doc/Toybox/WatchUi/CheckboxMenuItem.html"><code>CheckboxMenuItem</code></a> using XML as follows:</p>

<pre><code class="XML">&lt;checkbox-menu id=&quot;CheckMenu&quot; title=&quot;@Strings.CheckMenuTitle&quot;&gt;
    &lt;checkbox-menu-item id=&quot;defaultAlign&quot; label=&quot;@Strings.CheckDefaultLabel&quot; subLabel=&quot;@Strings.CheckDefaultSubLabel&quot;
     checked=&quot;true&quot; /&gt;
    &lt;checkbox-menu-item id=&quot;right&quot; label=&quot;@Strings.CheckRightLabel&quot; subLabel=&quot;@Strings.CheckRightSubLabel&quot;
     checked=&quot;false&quot;&gt;
        &lt;param name=&quot;alignment&quot;&gt;Ui.MenuItem.MENU_ITEM_LABEL_ALIGN_RIGHT&lt;/param&gt;
    &lt;/checkbox-menu-item&gt;
&lt;/checkbox-menu&gt;
</code></pre>

<p>The <a href="./doc/Toybox/WatchUi/ToggleMenuItem.html"><code>ToggleMenuItem</code></a> class is an element that indicates a menu item is in one of two states: <code>:enabled</code> or <code>:disabled</code>. See the change in the image below:</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/ToggleFigure.png" style="max-width:800px;" alt="Illustration of a `ToggleMenuItem` in in Menu2" />
<figcaption>An illustration of a <code>ToggleMenuItem</code> in <code>Menu2</code></figcaption>
</figure>
</div>

<p>You can create a <a href="./doc/Toybox/WatchUi/ToggleMenuItem.html"><code>ToggleMenuItem</code></a> as a resource using XML:</p>

<pre><code class="XML">&lt;menu2 id=&quot;ToggleMenu&quot; title=&quot;@Strings.ToggleMenuTitle&quot;&gt;
    &lt;toggle-menu-item id=&quot;defaultAlign&quot; label=&quot;@Strings.ToggleLabel1&quot; subLabel=&quot;@Strings.ToggleOnSubLabel&quot;
     disabledSubLabel=&quot;@Strings.ToggleOffSubLabel&quot; checked=&quot;true&quot; /&gt;
    &lt;toggle-menu-item id=&quot;left&quot; label=&quot;@Strings.ToggleLabel2&quot; subLabel=&quot;@Strings.ToggleOnSubLabel&quot;
     disabledSubLabel=&quot;@Strings.ToggleOffSubLabel&quot; checked=&quot;false&quot;&gt;
        &lt;param name=&quot;alignment&quot;&gt;WatchUi.MenuItem.MENU_ITEM_LABEL_ALIGN_LEFT&lt;/param&gt;
    &lt;/toggle-menu-item&gt;
&lt;/menu2&gt;
</code></pre>

<p>The <code>&lt;checkbox-menu-item&gt;</code> and <code>&lt;toggle-menu-item&gt;</code> attributes are identical in name and function:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The ID of the <code>&lt;toggle-menu-item&gt;</code> or <code>&lt;checkbox-menu-item&gt;</code></td>
	<td style="text-align:left;">Any string that starts with a character</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>label</code></td>
	<td style="text-align:left;">The label text to be displayed</td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>subLabel</code></td>
	<td style="text-align:left;">The sub-label text to be displayed when <code>checked</code> is <code>true</code></td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>disabledSubLabel</code></td>
	<td style="text-align:left;">The sub-label text to be displayed when <code>checked</code> is <code>false</code></td>
	<td style="text-align:left;">A valid string resource or <code>String</code></td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>checked</code></td>
	<td style="text-align:left;">The boolean state of the <code>&lt;toggle-menu-item&gt;</code> or <code>&lt;checkbox-menu-item&gt;</code></td>
	<td style="text-align:left;"><code>true</code> for <code>:enabled</code>, <code>false</code> for <code>disabled</code></td>
	<td style="text-align:left;"><code>false</code></td>
	<td style="text-align:left;">Value will switch even when not defined in XML</td>
</tr>
<tr>
	<td style="text-align:center;"><code>icon</code></td>
	<td style="text-align:left;">The icon to display in the sub-window (Instinct 2 only)</td>
	<td style="text-align:left;">Bitmap resource identifier</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>dividerType</code></td>
	<td style="text-align:left;">The location of the divider (5.0.1+ device support only)</td>
	<td style="text-align:left;">A <a href="./doc/Toybox/WatchUi/Menu2.html#DividerType-module"><code>DividerType</code></a></td>
	<td style="text-align:left;"><code>WatchUi.Menu2.DIVIDER_TYPE_DEFAULT</code></td>
	<td style="text-align:left;">Optional</td>
</tr>
</tbody>
</table>

<p>The <code>checked</code> attribute is automatically created as part of a <a href="./doc/Toybox/WatchUi/ToggleItem.html"><code>ToggleItem</code></a> or <a href="./doc/Toybox/WatchUi/CheckboxItem.html"><code>CheckboxItem</code></a> object and does not have to be defined in XML. If it is not defined in XML, then it will default to <code>false</code>.</p>

<p>For a <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>MenuItem</code></a> using graphical elements such as toggles and check boxes, developers can choose to align the elements to the left or right of the <a href="./doc/Toybox/WatchUi/MenuItem.html"><code>MenuItem</code></a> label. If not defined, then elements will be aligned to the right as seen in the <code>defaultAlign</code> toggle menu above. A <code>&lt;param&gt;</code> tag with the desired <a href="./doc/Toybox/WatchUi/MenuItem.html#Alignment-module"><code>MenuItem.MENU_ITEM_LABEL_ALIGN_*</code></a> value is used to set the alignment of icons, checks, and toggles. Developers can also explicitly align items to the right by using the <a href="./doc/Toybox/WatchUi/MenuItem.html#Alignment-module"><code>MenuItem.MENU_ITEM_LABEL_ALIGN_RIGHT</code></a> value.</p>

<h3 id="actionmenus">Action Menus</h3>

<p><em>Since API level 3.4.0</em></p>

<p>Action views are screens that both provide information and provide a contextual menu of actions. These actions might be next steps or tasks that can be performed on the visible information.</p>

<p>For more, see the <a href="./doc/Toybox/WatchUi.html#showActionMenu-instance_function"><code>WatchUi.showActionMenu()</code></a> API and the <a href="./PersonalityLibrary.html#actionviews">Action Views</a> chapter of the Personality Library.</p>

<h3 id="originalmenuapi">Original Menu API</h3>

<p><a href="./doc/Toybox/WatchUi/Menu.html"><code>WatchUi.Menu</code></a> is the older API for providing a list of options for the user. The options are displayed in a list that matches the device the app is running on. A menu can be defined in the resource XML file using the following format:</p>

<pre><code class="xml">&lt;menu id=&quot;MainMenu&quot;&gt;
    &lt;menu-item id=&quot;item_1&quot; label=&quot;@Strings.menu_item_1_label&quot; /&gt;
    &lt;menu-item id=&quot;item_1&quot; label=&quot;@Strings.menu_item_2_label&quot; /&gt;
&lt;/menu&gt;
</code></pre>

<p>The resource compiler will then take this XML and generate a <a href="./doc/Toybox/WatchUi/Menu.html"><code>Menu</code></a> object in the <code>Rez</code> module. In order to use this menu, a developer simply needs to push the menu and a delegate for the menu using <a href="./doc/Toybox/WatchUi.html#pushView-instance_function"><code>WatchUi.pushView()</code></a>:</p>

<pre><code class="java">class MyView extends WatchUi.View {
    function openTheMenu() {
        WatchUi.pushView( new Rez.Menus.MainMenu(), new MyMenuDelegate(), Ui.SLIDE_UP );
    }
}

class MyMenuDelegate extends WatchUi.MenuInputDelegate {
    function onMenuItem(item) {
        if ( item == :item_1 ) {
            // Do something here
        } else if ( item == :item_2 ) {
            // Do something else here
        }
    }
}
</code></pre>

<h2 id="genericpicker">Generic Picker</h2>

<p>The <a href="./doc/Toybox/WatchUi/Picker.html"><code>Picker</code></a> class, along with the <a href="./doc/Toybox/WatchUi/PickerDelegate.html"><code>PickerDelegate</code></a> and <a href="./doc/Toybox/WatchUi/PickerFactory.html"><code>PickerFactory</code></a> classes, provides applications with the ability to create on-screen lists of user-selectable objects. A picker consists of one or more objects, a title, a next and previous arrow, and a confirm button. The next and previous arrows and the confirm button are device specific but can be overwritten if desired. Pickers are pushed using <a href="./doc/Toybox/WatchUi.html#pushView-instance_function"><code>WatchUi.pushView()</code></a>, providing a <a href="./doc/Toybox/WatchUi/PickerDelegate.html"><code>PickerDelegate</code></a> for the input delegate. A <a href="./doc/Toybox/WatchUi/PickerFactory.html"><code>PickerFactory</code></a> is required to indicate what should be displayed for each pick-able value.</p>

<h3 id="userinterface-1">User Interface</h3>
<figure>
<img src="./resources/programmers-guide/picker-layout.png" style="max-width:205px;" title="Main components of a generic picker layout" alt="Main components of a generic picker layout" >
</figure>

<p>The above image is a representation of the general structure of what a picker should look like on a square screen. Other screen formats should have the same layout with some size differences to account for the screen and button layout.</p>

<ul>
<li>The top red bar represents where the title of the picker is displayed.</li>
<li>Up and down arrows to scroll through the available options are placed where the green boxes are.</li>
<li>The leftmost blue box is where the last item you selected is shown if the picker has multiple selectable items.</li>
<li>The center blue box is the item you are currently selecting.</li>
<li>The white box will either be the next selectable item in the list or the button to confirm your selection.</li>
</ul>

<p>For more, see the <code>Picker</code> sample app distributed with the SDK.</p>

<h2 id="confirmationdialog">Confirmation Dialog</h2>

<p>The <a href="./doc/Toybox/WatchUi/Confirmation.html"><code>WatchUi.Confirmation</code></a> and <a href="./doc/Toybox/WatchUi/ConfirmationDelegate.html"><code>WatchUi.ConfirmationDelegate</code></a> provides a simple yes/no dialog. This is useful when presenting a simple selection to the user.</p>

<p>For more, see the <code>ConfirmationDialog</code> sample app distributed with the SDK, and the <a href="./PersonalityLibrary.html#confirmations">Confirmations</a> section of the Personality Library.</p>

<h2 id="progressbar">Progress Bar</h2>

<p>The progress dialog gives a standard wait dialog. It has two modes&mdash;one that shows the completion of some process, and a second that acts a wait timer displaying an indeterminate amount of progress. The look and feel of the progress bar will be device-specific.</p>

<p>For more, see the <code>ProgressBar</code> sample app distributed with the SDK, and the <a href="./PersonalityLibrary.html#progressbars">Progress Bars</a> section of the Personality Library.</p>

<h1 id="pageloops">Page Loops</h1>

<p>Page loops are carousels of views. When the user is in a page loop, the user interface presents a set of pages of information that provide different data and insights to the user. There are standard behaviors for going to the next and previous pages. Advancing from the last page typically loops the user back to the first page.</p>

<p>For more, see the <a href="./doc/Toybox/WatchUi/ViewLoop.html"><code>WatchUi.ViewLoop</code></a> API, and the <a href="./PersonalityLibrary.html#pageloops">Page Loops</a> section of the Personality Library.</p>

<h2 id="toasts">Toasts</h2>

<p><em>Since API level 3.4.0</em></p>

<p>Toasts are partial screen banners with text and an optional icon. The user cannot interact with them, and they dismiss after a short period. Toasts are good for informing users about asynchronous events without disrupting what they are currently doing.</p>

<p>For more, see the <a href="./doc/Toybox/WatchUi.html#showToast-instance_function"><code>WatchUi.showToast()</code></a> API, and the <a href="./PersonalityLibrary.html#toasts">Toasts</a> section of the Personality Library.</p>

<h2 id="datafield">Data Field</h2>

<p>Data fields function as plug-ins for the Garmin activity experience. After users install a data field from the store, they can place them inside of their activity pages for any Garmin activity.</p>

<p>On devices with touch screen support, an input delegate can be used to accept input. Only the <a href="./doc/Toybox/WatchUi/InputDelegate.html#onTap-instance_function"><code>InputDelegate.onTap()</code></a> behavior is supported and will be triggered when the user touches a point inside the data field when it is active on the screen. The behavior delegate should be the second element of the array that is returned from <a href="./doc/Toybox/Application/AppBase.html#getInitialView-instance_function"><code>AppBase.getInitialView()</code></a> as with other app types.</p>

<pre><code class="java">// This data field accepts touch input
class DataFieldApp extends App.AppBase {
    // Data field view with associated behavior delegate
    function getInitialView() {
        return [ new DataFieldView(), new DataFieldDelegate() ];
    }
}

class DataFieldDelegate extends Ui.InputDelegate {
    // Handle touch events
    function onTap(evt) {
        // Process the touch event
    }
}
</code></pre>

<h3 id="alerts">Alerts</h3>

<p><em>Since API level 3.2.0</em></p>

<p>When you want your data field to notify the user of a specific event, you can push a view that extends <a href="./doc/Toybox/WatchUi/DataFieldAlert.html"><code>DataFieldAlert</code></a>. <a href="./doc/Toybox/WatchUi/DataFieldAlert.html"><code>DataFieldAlert</code></a> is a special instance of <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> that can be presented to the user with <a href="./doc/Toybox/WatchUi/DataField.html#showAlert-instance_function"><code>showAlert</code></a>. The alert does not accept input and will time out after the standard alert period. The user is required to enable alerts for your app in the workout alert settings.</p>

<h2 id="mapping">Mapping</h2>

<p><em>Since API level 3.0.0</em></p>

<p>Connect IQ enables developers to embed map views into their apps on products with onboard cartography. Mapping is accessible in two ways: The <a href="./doc/Toybox/WatchUi/MapView.html"><code>WatchUi.MapView</code></a> and the <a href="./doc/Toybox/WatchUi/MapTrackView.html"><code>WatchUi.MapTrackView</code></a>.</p>

<h3 id="mapviews">MapViews</h3>

<p>The <a href="./doc/Toybox/WatchUi/MapView.html"><code>MapView</code></a> class is pushed like any other <a href="./doc/Toybox/WatchUi/View.html"><code>View</code></a> class, but has some unique characteristics. Namely, <a href="./doc/Toybox/WatchUi/MapView.html"><code>MapView</code></a> objects give you access to a rendering of a specified portion of the on-board map for a device. <a href="./doc/Toybox/WatchUi/MapView.html"><code>MapView</code></a> objects let you choose a portion of a map to focus on by using two points of the type <a href="./doc/Toybox/Positon/Location.html"><code>Location</code></a>.</p>

<p>Here is the setup for a basic <a href="./doc/Toybox/WatchUi/MapView.html"><code>MapView</code></a>:</p>

<pre><code class="C++">import Toybox.WatchUi;
import Toybox.Position;

class MyMapView extends MapView {

    // Initialize the MapView
    function initialize() {
        MapView.initialize();

        // Set the top left Location object for the Map Visible Area
        var topLeft = new Position.Location({:latitude =&gt; 38.85695, :longitude =&gt;-94.80051, :format =&gt; :degrees});

        // Set the bottom right Location object for the Map Visible Area
        var bottomRight = new Position.Location({:latitude =&gt; 38.85391, :longitude =&gt;-94.7963, :format =&gt; :degrees});

        // Set the area of the map to be displayed
        MapView.setMapVisibleArea(topLeft, bottomRight);

        // Set the area in which to display the selected map area
        MapView.setScreenVisibleArea(0, 0, 240, 240/2);

        // Set the map mode
        MapView.setMapMode(WatchUi.MAP_MODE_PREVIEW);
    }
}
</code></pre>

<p>Let&#8217;s dissect this a bit to learn about the view itself:</p>

<dl>
<dt>MapView.initialize()</dt>
<dd>It is recommended to set the parameters of your MapView in it&#8217;s <code>initialize()</code> function as shown here.</dd>

<dt>MapView.setMapVisibleArea()</dt>
<dd>This method takes <code>top_left</code> and <code>bottom_right</code> parameters as <code>Position.Location</code> objects. These two locations create a bounding box that defines the view area of the map which are the top-left and bottom-right most <code>Location</code> objects that must be displayed on the initial map render. Conceptually, this works itself out into a rectangular portion of a map that must be focused on for the initial render of the MapView.</dd>

<dt>MapView.setScreenVisibleArea()</dt>
<dd>MapViews allow developers to overlay UI items on top. Sometimes you want the entire screen to have the map image, but other times you&#8217;ll want to split the display between map and UI elements. If you want the map area to not be the center of the screen you can use this method to define the rectangular area. This method determines the rectangular area in which the area of the map defined in the <code>setMapVisibleArea()</code> call should be rendered. Here is a figure to help illustrate the relationship where the blue rectangles represent the map area and the red rectangles represent the screen area.</dd>
</dl>
<div class="center">
<figure>
<img src="./resources/programmers-guide/MappingDiagram.png" style="max-width:800px;" alt="Illustration of relationship between Map Area and the Screen Area" />
<figcaption>An Illustration of relationship between Map Area and the Screen Area</figcaption>
</figure>
</div>

<dl>
<dt>MapView.setMapMode()</dt>
<dd>This call sets the map mode to one of the <code>MAP_MODE_*</code> enum values.</dd>
</dl>

<p>MapViews and MapTrackViews have two modes:</p>

<ul>
<li><strong>Preview:</strong> Selected with the <code>MAP_MODE_PREVIEW</code> enum value. This allows a non-movable map to be rendered on the screen.</li>
<li><strong>Browse:</strong> Selected with the <code>MAP_MODE_BROWSE</code> enum value. This mode allows the user to zoom, pan, and move the map using the system default controls.</li>
</ul>

<h3 id="maptrackview">MapTrackView</h3>

<p>The MapTrackView is similar to the MapView in all ways except for one. The MapTrackView will dynamically render the active location of the device on the screen.</p>

<p>For more, see the <code>MapSample</code> sample app distributed with the SDK.</p>

<h3 id="mappingartifacts">Mapping Artifacts</h3>

<p>Maps can add context with your content, but only if you can combine them together. Thankfully, not only can you access the maps native to devices, you can draw on them too! Monkey C has two new objects to interact with maps: <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> and <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a>.</p>

<h4 id="mappolyline">MapPolyline</h4>

<p>The <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> object allows developers to draw a line with multiple points of location on a MapView rendering of a map. Only one <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> object is allowed in a view.</p>

<p>Here is an example of a <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> with four points:</p>

<pre><code class="c++">    // Initialize a new MapPolyline object
    var polyline = new WatchUi.MapPolyline();

    //Set the color of the MapPolyline
    polyline.setColor(Toybox.Graphics.COLOR_RED);

    // Set the pen width to draw the MapPolyline
    polyline.setWidth(2);

    // Set the Locations on the MapPolyline
    polyline.addLocation(
        new Position.Location({
            :latitude =&gt; 38.85391,
            :longitude =&gt;-94.79630,
            :format =&gt; :degrees
        })
    );
    polyline.addLocation(
        new Position.Location({
            :latitude =&gt; 38.85465,
            :longitude =&gt;-94.79922,
            :format =&gt; :degrees
        })
    );
    polyline.addLocation(
        new Position.Location({
            :latitude =&gt; 38.85508,
            :longitude =&gt;-94.79959,
            :format =&gt; :degrees
        })
    );
    polyline.addLocation(
        new Position.Location({
            :latitude =&gt; 38.85557,
            :longitude =&gt;-94.79864,
            :format =&gt; :degrees
        })
    );

    // Set the MapPolyline object to draw on the map
    MapView.setPolyline(polyline);
</code></pre>

<dl>
<dt>new WatchUi.MapPolyline</dt>
<dd>This creates a new instance of <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> object.</dd>

<dt>setColor()</dt>
<dd>Sets the color of the <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> with a <code>COLOR_*</code> enum value.</dd>

<dt>setWidth()</dt>
<dd>Sets the pen width used to draw the <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> in pixels.</dd>

<dt>addLocation()</dt>
<dd>This method takes a <a href="./doc/Toybox/Positon/Location.html"><code>Location</code></a> object and adds it to an <code>Array</code> of <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> objects. These locations make up the points used to draw the lines that comprise the <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> representation on the map.</dd>

<dt>MapView.setPolyline()</dt>
<dd>This sets the MapPolyline object to be rendered on the map in the <a href="./doc/Toybox/WatchUi/MapView.html"><code>MapView</code></a> or <a href="./doc/Toybox/WatchUi/MapTrackView.html"><code>MapTrackView</code></a>. In this example it is using the <a href="./doc/Toybox/WatchUi/MapPolyline.html"><code>MapPolyline</code></a> object stored as <code>polyline</code>.</dd>
</dl>

<h4 id="mapmarker">MapMarker</h4>

<p>The <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> object pairs a <a href="./doc/Toybox/Positon/Location.html"><code>Location</code></a> object with a BitmapResource to create a marker to be draw on a map. Each Bitmap image used in a <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> object will have a &#8220;hotspot&#8221; for the image. The hotspot is the point of the image that will be drawn at the latitude and longitude for the provided <a href="./doc/Toybox/Positon/Location.html"><code>Location</code></a> for the <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a>.</p>

<p>Here is a simple implementation of a <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> object:</p>

<pre><code class="c++">    // Initialize a map marker with a Location object
    var bitmapMarker = new WatchUi.MapMarker(
        new Position.Location({
            :latitude =&gt; 38.85391,
            :longitude =&gt;-94.79630,
            :format =&gt; :degrees
        })
    );
            bitmapMarker.setIcon(WatchUi.loadResource(Rez.Drawables.MapPin), 12, 24);
            bitmapMarker.setLabel(&quot;Custom Icon&quot;);

    var defaultMarker = new WatchUi.MapMarker(
        new Position.Location({
            :latitude =&gt; 38.85508,
            :longitude =&gt;-94.79959,
            :format =&gt; :degrees
        })
    );
            defaultMarker.setIcon(WatchUi.MAP_MARKER_ICON_PIN, 0, 0);
            defaultMarker.setLabel(&quot;Predefined Icon&quot;);

    // Set the Map Marker for the view
    MapView.setMapMarker(defaultMarker);
</code></pre>

<p>Let&#8217;s look at the code above to get a better handle on the APIs.</p>

<dl>
<dt>new WatchUi.MapMarker</dt>
<dd>The <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> object is initialized with the <code>Location</code> object passed to it. This is be the point at which the <code>MapMarker</code> hotspot of the Bitmap resource is be drawn.</dd>

<dt>bitmapMarker.setIcon(WatchUi.loadResource(Rez.Drawables.MapPin), 12, 24)</dt>
<dd>This call sets the icon of the<a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> named <code>bitmapMarker</code> to the bitmap resource <code>Rez.Drawables.MapPin</code>. The hotspot is set to <code>12</code> for the <code>x</code> coordinate of the bitmap and <code>24</code> for the <code>y</code> coordinate of the <code>MapPin</code> icon.</dd>

<dt>setLabel()</dt>
<dd>Sets the label of the <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> icon to be displayed on the rendered map.</dd>

<dt>defaultMarker.setIcon(WatchUi.MAP_MARKER_ICON_PIN, 0, 0)</dt>
<dd>This <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> is using the <code>MAP_MARKER_ICON_PIN</code> enum value when setting the icon and use the system default icon for marking the point on the map. Note that the provided values for <code>x, y</code> for the hotspot are <code>0, 0</code> respectively. When using the default icon, the hotspot management is handled by the system.</dd>

<dt>setMapMarker()</dt>
<dd>The <a href="./doc/Toybox/WatchUi.html#setMapMarker-instance_function"><code>setMapMarker()</code></a> method takes a <a href="./doc/Toybox/WatchUi/MapMarker.html"><code>MapMarker</code></a> object and sets it on the map. In this example only the <code>defaultMarker</code> is set to be drawn on the map. However, it is acceptable to set multiple MapMarker objects by setting them in an <a href="./doc/Toybox/Lang/Array.html"><code>Array</code></a>. For example:</dd>
</dl>

<pre><code class="c++">// Create an Array to hold the MapMarker objects
var markers = [];

// Add the MapMarkers to the Array
markers.add(bitmapMarker);
markers.add(defaultMarker);

// Set multiple markers in an Array
MapView.setMapMarker(markers);
</code></pre>

<h3 id="simulatingmaps">Simulating Maps</h3>

<p>When working with maps in the simulator, Connect IQ uses web APIs to retrieve map images to simulate on-device behavior. Simulator and on-device mapping coverage with vary as on-device mapping is contingent on the device and maps available. Here is the detail coverage map for the simulator:</p>

<ul>
<li><strong>Green:</strong> Low detail</li>
<li><strong>Blue:</strong> Medium detail</li>
<li><strong>Red:</strong> High detail</li>
</ul>
<div class="center">
<figure>
<img src="./resources/programmers-guide/MapCoverage.png" style="max-width:534px;" alt="Detail map coverage guide for the Connect IQ Simulator" />
<figcaption>The detail map available on the Connect IQ Simulator</figcaption>
</figure>
</div>

<h1 id="resources">Resources</h1>
<figure>
<img src="./resources/programmers-guide/sculptor-monkey.png" style="max-width:300px;" title="It is my finest work." />
</figure>

<p>The resource compiler compiles images, text, and static data into a resource database that the application can access at run time. The resource compiler is tied into the Monkey C compiler. Its input is an XML file:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;bitmap id=&quot;bitmap_id&quot; filename=&quot;path/for/image&quot; /&gt;
    &lt;font id=&quot;font_id&quot; filename=&quot;path/to/fnt&quot; /&gt;
    &lt;string id=&quot;string_id&quot;&gt;Hello World!&lt;/string&gt;
&lt;/resources&gt;
</code></pre>

<h2 id="theresourcemodulea.k.a.rez">The Resource Module (a.k.a. Rez)</h2>

<p>The resource compiler auto-generates a Monkey C module named <code>Rez</code> that contains the resource IDs for the resource file. These identifiers, of type <a href="./doc/Toybox/Lang/ResourceId.html"><code>ResourceId</code></a>, are used to refer to your resources:</p>

<p>The code can use the <code>Rez</code> class to reference the resources at run time. You can use the following APIs:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/WatchUi.html#loadResource-instance_function"><code>WatchUi.loadResource()</code></a></td>
	<td style="text-align:left;">Load a resource from the PRG into memory</td>
	<td style="text-align:left;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Application.html#loadResource-instance_function"><code>Application.loadResource</code></a>()<a href="#fn:11" id="fnref:11" title="see footnote" class="footnote">[11]</a></td>
	<td style="text-align:left;">Load a resource from the PRG into memory</td>
	<td style="text-align:left;">3.1.0</td>
</tr>
</tbody>
</table>

<p>For example, let&#8217;s say you have a bitmap you want to use in your view. Before it can be used by the app, it must be loaded from the resource file:</p>

<pre><code class="typescript">image = Application.loadResource( Rez.Drawables.bitmap_id ) as BitmapResource;
</code></pre>

<p>Now the bitmap can be drawn in the update handler:</p>

<pre><code class="typescript">dc.drawBitmap( 50, 50, image );
</code></pre>

<p>Resources are reference counted just like other Monkey C objects. Loading a resource can be an expensive operation, so do not load resources when handling screen updates.</p>

<h3 id="referencingresourceswithinresourcefiles">Referencing Resources Within Resource Files</h3>

<p>Resources can also be referenced from within another resource file. To do this use the syntax <code>@&lt;module&gt;.&lt;id&gt;</code>. For example, you could reference a String resource within a menu definition using the following code.</p>

<pre><code class="xml">&lt;string id=&quot;menu_item_1_label&quot;&gt;Item 1&lt;/string&gt;

&lt;menu id=&quot;MainMenu&quot;&gt;
    &lt;menu-item id=&quot;item_1&quot; label=&quot;@Strings.menu_item_1_label&quot; /&gt;
&lt;/menu&gt;
</code></pre>

<p>This code would use the string defined with an ID of <code>menu_item_1_label</code> as the label for the menu item.</p>

<h2 id="resourcescopes">Resource Scopes</h2>

<p><em>Since API level 3.1.0</em></p>

<p>Adding resources to an app comes with a minor runtime memory cost. While the cost is small, it can seriously cut into the available memory for background services and glances. To mitigate these costs, Connect IQ has an additional <code>scope</code> attribute to the following resource tags: <code>&lt;layout&gt;</code>, <code>&lt;drawable-list&gt;</code>, <code>&lt;bitmap&gt;</code>, <code>&lt;string&gt;</code>, <code>&lt;font&gt;</code>, <code>&lt;jsonData&gt;</code>. The <code>scope</code> attribute tells the resource compiler the type of application that the resource should be made available to. Valid values for the <code>scope</code> attribute are <code>background</code>, <code>glance</code>, and <code>foreground</code>. If the attribute is not specified for a resource, it will be considered part of the <code>foreground</code> scope by default. An example of using the <code>scope</code> attribute with string resources:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;string id=&quot;MyBackgroundString&quot; scope=&quot;background&quot;&gt;Background String&lt;/string&gt;
    &lt;string id=&quot;MyGlanceString&quot; scope=&quot;glance&quot;&gt;Glance String&lt;/string&gt;
    &lt;string id=&quot;MyForegroundString&quot; scope=&quot;foreground&quot;&gt;Foreground String&lt;/string&gt;
&lt;/resources&gt;
</code></pre>

<p>Use the <code>scope</code> attribute to save memory in your glance or background service. All background scoped resources will be available to the glance and foreground application. All glance scoped resources will be available to the foreground application, but not to the background service. Foreground scoped resources will only be available to the foreground application.</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Application Mode</th>
	<th style="text-align:center;">MyBackgroundString</th>
	<th style="text-align:center;">MyGlanceString</th>
	<th style="text-align:center;">MyForegroundString</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;">Background Service</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;"></td>
</tr>
<tr>
	<td style="text-align:center;">Glance</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;"></td>
</tr>
<tr>
	<td style="text-align:center;">Foreground</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;">X</td>
</tr>
</tbody>
</table>

<p>In the example above, <code>MyBackgroundString</code> would be available when running the application in any valid mode. <code>MyGlanceString</code> would be available to the glance and foreground application, but not to the background service if present. <code>MyForegroundString</code> would only be available to the foreground application. By providing this hierarchy, developers can better determine how their resources should be scoped.</p>

<p>See <a href="./CoreTopics.html#backgroundservices">Background Services</a> or <a href="./CoreTopics.html#glances">Glances</a> for more information.</p>

<h2 id="strings">Strings</h2>

<p>Connect IQ products are used around the world, and those users want apps to work in their language. Connect IQ supports adding strings using a strings resource file:</p>

<pre><code class="xml">&lt;strings&gt;
    &lt;string id=&quot;identifier&quot;&gt;String Value&lt;/string&gt;
&lt;/strings&gt;
</code></pre>

<p>At runtime, you can load this string using <a href="doc://Toybox.WatchUi.loadResource()"><code>loadResource()</code></a>. String definitions take the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Required</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>Yes</td>
	<td>Identifier for the string</td>
</tr>
<tr>
	<td><code>scope</code></td>
	<td>No</td>
	<td>See <a href="#resourcescopes">resource scopes</a>. String can have the additional <code>settings</code> scope which removes it from the runtime. This is useful when a string is only used within your setting definitions.</td>
</tr>
<tr>
	<td><code>translatable</code></td>
	<td>No</td>
	<td>Indicates if a string requires translations. Set to <code>false</code> to mark a string as not requiring translations.</td>
</tr>
</tbody>
</table>

<p>Using <a href="./CoreTopics.html#devicefamilyandlocalizationqualifiers">localization qualifiers</a> of your resource folders you can provide different strings for different languages. Adding the following suffixes to your resource folder will allow you to add string files for various languages</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Qualifier</th>
	<th style="text-align:left;">Language</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;">No qualifier</td>
	<td style="text-align:left;">Base language</td>
	<td style="text-align:left;">These strings will be used if no language is provided. If a translation is not provided for a string in a specific language, the system will use the base language version as a substitution.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>ara</code></td>
	<td style="text-align:left;">Arabic</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>bul</code></td>
	<td style="text-align:left;">Bulgarian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>ces</code></td>
	<td style="text-align:left;">Czech</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>dan</code></td>
	<td style="text-align:left;">Danish</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>deu</code></td>
	<td style="text-align:left;">German</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>dut</code></td>
	<td style="text-align:left;">Dutch</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>eng</code></td>
	<td style="text-align:left;">English</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>est</code></td>
	<td style="text-align:left;">Estonian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>fin</code></td>
	<td style="text-align:left;">Finnish</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>fre</code></td>
	<td style="text-align:left;">French</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>hrv</code></td>
	<td style="text-align:left;">Croatian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>hun</code></td>
	<td style="text-align:left;">Hungarian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>ind</code></td>
	<td style="text-align:left;">Indonesian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>ita</code></td>
	<td style="text-align:left;">Italian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>jpn</code></td>
	<td style="text-align:left;">Japanese</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>kor</code></td>
	<td style="text-align:left;">Korean</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>lav</code></td>
	<td style="text-align:left;">Latvian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>lit</code></td>
	<td style="text-align:left;">Lithuanian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>nob</code></td>
	<td style="text-align:left;">Norsk Bokmål</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>pol</code></td>
	<td style="text-align:left;">Polish</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>por</code></td>
	<td style="text-align:left;">Portuguese</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>slo</code></td>
	<td style="text-align:left;">Slovak</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>slv</code></td>
	<td style="text-align:left;">Slovenian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>spa</code></td>
	<td style="text-align:left;">Spanish</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>swe</code></td>
	<td style="text-align:left;">Swedish</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>rus</code></td>
	<td style="text-align:left;">Russian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>ron</code></td>
	<td style="text-align:left;">Romanian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>tha</code></td>
	<td style="text-align:left;">Thai</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>tur</code></td>
	<td style="text-align:left;">Turkish</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>ukr</code></td>
	<td style="text-align:left;">Ukrainian</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>vie</code></td>
	<td style="text-align:left;">Vietnamese</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>zsm</code></td>
	<td style="text-align:left;">Standard Malay</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>zhs</code></td>
	<td style="text-align:left;">Simplified Chinese</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>zht</code></td>
	<td style="text-align:left;">Traditional Chinese</td>
	<td style="text-align:left;"></td>
</tr>
</tbody>
</table>

<p>You can combine these qualifiers with device, family and screen qualifiers to have strings that are customized to each device if necessary.</p>
<figure>
<img src="./resources/programmers-guide/resources-strings.png" style="max-width:250px;" title="Resource folders with qualifiers" alt="Resource folders with qualifiers" />
</figure>

<p>See the <code>Strings</code> sample for an example of how to use the strings resource system.</p>

<h2 id="bitmaps-1">Bitmaps</h2>

<p>Garmin devices have different form factors, screen sizes and screen technologies, so bitmaps need to be explicitly converted for every device. The resource compiler will generate resources for every intended product, which allows the developer to have one set of resources for black and white products, one set for color products, one for larger screen sizes, etc. The resource compiler supports <code>JPG/JPEG</code>, <code>BMP/WBMP</code>, <code>GIF</code>, <code>SVG</code> and <code>PNG</code> file formats.</p>

<p>While each device has a unique palette, the developer can specify a palette to use for an image. The resource compiler will map the colors that are defined in the developer&#8217;s palette to the closest match in the device palette and use only those colors. A palette can be defined using the following syntax:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;bitmap id=&quot;bitmap_id&quot; filename=&quot;path/for/image&quot;&gt;
        &lt;palette disableTransparency=&quot;false&quot;&gt;
            &lt;color&gt;FF0000&lt;/color&gt;
            &lt;color&gt;FFFFFF&lt;/color&gt;
            &lt;color&gt;0000FF&lt;/color&gt;
        &lt;/palette&gt;
    &lt;/bitmap&gt;
&lt;/resources&gt;
</code></pre>

<p>The table below shows some of the valid attributes for a <code>&lt;bitmap&gt;</code> definition.</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The handle for the layout, which is used to reference the layout in the Rez module</td>
	<td style="text-align:left;">Any value that starts with a letter</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>filename</code></td>
	<td style="text-align:left;">The relative path to the image file</td>
	<td style="text-align:left;">A valid, resolvable path to an image file</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>dithering</code></td>
	<td style="text-align:left;">The type of dithering to use when compiling the image</td>
	<td style="text-align:left;"><code>floyd_steinberg</code> or <code>none</code></td>
	<td style="text-align:left;"><code>floyd_steinberg</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>compress</code></td>
	<td style="text-align:left;">Indicate that the compiled bitmap should be compressed to reduce .PRG size</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;"><code>false</code></td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>automaticPalette</code></td>
	<td style="text-align:left;">Automatically determine a reduced color palette to use while compiling the image. Images will be limited to 256 colors for 16-bit color devices.</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;"><code>true</code> for 16-bit color devices</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:center;"><code>packingFormat</code></td>
	<td style="text-align:left;">The format with which the image will be encoded into the PRG</td>
	<td style="text-align:left;"><code>default</code>, <code>png</code>, <code>jpg</code>, <code>yuv</code>.</td>
	<td style="text-align:left;"><code>default</code></td>
	<td style="text-align:left;">Options besides <code>default</code>only available on certain devices. See <a href="#bitmappackingformats">Bitmap Packing Formats</a></td>
</tr>
<tr>
	<td style="text-align:center;"><code>scaleX</code></td>
	<td style="text-align:left;">How should the image be scaled in the x dimension?</td>
	<td style="text-align:left;">Pixel size or percentage</td>
	<td style="text-align:left;">If <code>scaleY</code> is set, will default to <code>scaleY</code>’s value. Otherwise will default to 100% of image width</td>
	<td style="text-align:left;">See <code>scaleRelativeTo</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>scaleY</code></td>
	<td style="text-align:left;">How should the image be scaled in the x dimension?</td>
	<td style="text-align:left;">Pixel size or percentage</td>
	<td style="text-align:left;">If <code>scaleX</code> is set, will default to <code>scaleX</code>’s value. Otherwise will default to 100% of image height</td>
	<td style="text-align:left;">See <code>scaleRelativeTo</code></td>
</tr>
<tr>
	<td style="text-align:center;"><code>scaleRelativeTo</code></td>
	<td style="text-align:left;">What should the scale factor be based on?</td>
	<td style="text-align:left;"><code>screen</code> or <code>image</code></td>
	<td style="text-align:left;"><code>screen</code></td>
	<td style="text-align:left;">Sets what to base relative scaling on. If set to screen, image will be re-scaled based on product it is being built for at compile time</td>
</tr>
<tr>
	<td style="text-align:center;"><code>personality</code></td>
	<td style="text-align:left;">Personality class for the element</td>
	<td style="text-align:left;">Personality class</td>
	<td style="text-align:left;">None</td>
	<td style="text-align:left;">See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a></td>
</tr>
</tbody>
</table>

<p>The valid attributes for a <code>&lt;palette&gt;</code> definition are in the table below.</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>disableTransparency</code></td>
	<td style="text-align:left;">Should the compiler allow transparent pixels in the image? Disabling transparency may save memory</td>
	<td style="text-align:left;"><code>true</code> or <code>false</code></td>
	<td style="text-align:left;"><code>false</code></td>
	<td style="text-align:left;"></td>
</tr>
</tbody>
</table>

<h3 id="bitmappackingformats">Bitmap Packing Formats</h3>

<p><em>Since API level 4.0.0</em></p>

<p>Images can grow your executable size, which can add extra wait when users install or update your app. To reduce executable bloat use these bitmap attributes for packing images into your executable.</p>

<p>Each of the formats can have their advantages and disadvantages:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Format</th>
	<th style="text-align:left;">Advantage</th>
	<th style="text-align:left;">Disadvantage</th>
	<th style="text-align:left;">Use Case</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>default</code></td>
	<td style="text-align:left;">Available on all products, fastest to load, supports alpha channel</td>
	<td style="text-align:left;">No compression</td>
	<td style="text-align:left;">App runs on pre-API level 4.0.0 devices. Low palette images can have very small runtime costs</td>
</tr>
<tr>
	<td style="text-align:center;"><code>png</code></td>
	<td style="text-align:left;">Lossless, compressed and supports alpha channel</td>
	<td style="text-align:left;">Slowest to load, which can add runtime cost if purged and reloaded frequently from the graphics pool</td>
	<td style="text-align:left;">Importing non-photo images with or without alpha channel</td>
</tr>
<tr>
	<td style="text-align:center;"><code>jpg</code></td>
	<td style="text-align:left;">Compresses very well, fast to load</td>
	<td style="text-align:left;">Lossy format and does not support alpha channel</td>
	<td style="text-align:left;">Importing photo imagery without alpha channel</td>
</tr>
<tr>
	<td style="text-align:center;"><code>yuv</code></td>
	<td style="text-align:left;">Compresses well, supports alpha channel, fast to load</td>
	<td style="text-align:left;">Lossy format</td>
	<td style="text-align:left;">Importing photo imagery with alpha channel</td>
</tr>
<tr>
	<td style="text-align:center;"></td>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"></td>
	<td style="text-align:left;"></td>
</tr>
</tbody>
</table>

<h2 id="fonts">Fonts</h2>

<p>The resource compiler reads fonts in <code>TXT</code> or <code>PNG</code> format. You can use the BMFont tool (available at <a href="http://www.angelcode.com/products/bmfont/">http://www.angelcode.com/products/bmfont/</a>) to convert a font from many different formats to a compatible format. Prior to export, ensure that BMFont&#8217;s <em>Font Settings</em> specify the Unicode character set. Recommended export options are shown in the image below:</p>
<div class="center">
<figure>
<img src="./resources/programmers-guide/bmfont_options.png" style="max-width:298px;" alt="The BMFont Export Options" title="The BMFont export options window" />
<figcaption>The BMFont Export Options</figcaption>
</figure>
</div>

<p>The color can be set using <a href="./doc/Toybox/Graphics/Dc.html#setColor-instance_function"><code>Dc.setColor()</code></a>. Since bitmap fonts can take a lot of runtime memory, the font converter defaults to non-anti-aliased 1-bit fonts to save memory. If you know you will have the runtime RAM available, you can turn on font anti-aliasing with the <code>antialias</code> option.</p>

<pre><code class="xml">&lt;!-- Domo arigato mister font --&gt;
&lt;font id=&quot;font_id&quot; filename=&quot;roboto.fnt&quot; antialias=&quot;true&quot; /&gt;
</code></pre>

<p>If you are creating a large font, sometimes, only particular glyphs need to be large-sized (like numbers for a watch face). Use the filter attribute to specify the particular glyphs to include:</p>

<pre><code class="xml">&lt;!-- Only include digits from this large font --&gt;
&lt;font id=&quot;font_id&quot; filename=&quot;big_font.fnt&quot; filter=&quot;0123456789:&quot;/&gt;
</code></pre>

<p>Font elements accept the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>Unique identifier for the font</td>
</tr>
<tr>
	<td><code>filename</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>BMFont generated <code>.fnt</code> file</td>
</tr>
<tr>
	<td><code>filter</code></td>
	<td>String</td>
	<td>No</td>
	<td>None</td>
	<td>Optional string that outlines all characters to import from the font</td>
</tr>
<tr>
	<td><code>antialias</code></td>
	<td>Boolean</td>
	<td>No</td>
	<td><code>false</code></td>
	<td>Boolean that identifies if fonts should be imported with anti-aliasing information</td>
</tr>
<tr>
	<td><code>scope</code></td>
	<td>String</td>
	<td>No</td>
	<td><code>foreground</code></td>
	<td>See <a href="#resourcescopes">resource scopes</a></td>
</tr>
<tr>
	<td><code>personality</code></td>
	<td>Personality class</td>
	<td>No</td>
	<td>None</td>
	<td>Personality class for the element. See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a> for more information</td>
</tr>
</tbody>
</table>

<h2 id="menus-1">Menus</h2>

<p>Menus are common UI elements on Connect IQ products. Menu resources allow you to define your menus within your resource definitions.</p>

<h3 id="standardmenus">Standard Menus</h3>

<p>Menus are defined using the <code>&lt;menu2&gt;</code> element, which has the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>Unique identifier for the menu</td>
</tr>
<tr>
	<td><code>title</code></td>
	<td>String</td>
	<td>No</td>
	<td>None</td>
	<td>String, string resource identifier, or drawable resource identifier</td>
</tr>
<tr>
	<td><code>icon</code></td>
	<td>Drawable reference</td>
	<td>No</td>
	<td>None</td>
	<td>Bitmap identifier. Used for Instinct 2 sub-screen icon.</td>
</tr>
<tr>
	<td><code>personality</code></td>
	<td>Personality class</td>
	<td>No</td>
	<td>None</td>
	<td>Personality class for the element. See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a> for more information</td>
</tr>
</tbody>
</table>

<p>Within a <code>&lt;menu2&gt;</code> element can be an array of <code>&lt;menu-item&gt;</code>, <code>&lt;toggle-menu-item&gt;</code>, or <code>&lt;icon-menu-item&gt;</code> types.</p>

<h4 id="standardmenuitems">Standard Menu Items</h4>

<p>Standard menu items are contained within <code>&lt;menu-item&gt;</code> elements and have the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>Unique identifier for the menu item</td>
</tr>
<tr>
	<td><code>label</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>String title for the menu item</td>
</tr>
<tr>
	<td><code>subLabel</code></td>
	<td>String</td>
	<td>No</td>
	<td>None</td>
	<td>String sub-title for the menu item</td>
</tr>
<tr>
	<td><code>icon</code></td>
	<td>Drawable reference</td>
	<td>No</td>
	<td>None</td>
	<td>Drawable icon displayed in the Instinct 2 sub-screen <a href="#fn:12" id="fnref:12" title="see footnote" class="footnote">[12]</a></td>
</tr>
<tr>
	<td><code>personality</code></td>
	<td>Personality class</td>
	<td>No</td>
	<td>None</td>
	<td>Personality class for the element. See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a> for more information</td>
</tr>
</tbody>
</table>

<h4 id="togglemenuitems">Toggle Menu Items</h4>

<p>Toggle menu items are contained within the <code>&lt;toggle-menu-item&gt;</code> element. In addition to the attributes mentioned in <a href="#standardmenuitems">standard menu items</a>, they have the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>disabledSubLabel</code></td>
	<td>String</td>
	<td>No</td>
	<td>None</td>
	<td>Separate sub-label for when the toggle id in the disabled state</td>
</tr>
<tr>
	<td><code>checked</code></td>
	<td>Boolean</td>
	<td>No</td>
	<td><code>false</code></td>
	<td><code>true</code> if toggle should be enabled, <code>false</code> otherwise</td>
</tr>
</tbody>
</table>

<h4 id="iconmenuitems">Icon Menu Items</h4>

<p>Icon Menu items are defined with the <code>&lt;icon-menu-item&gt;</code> element. With icon menu icons, the <code>icon</code> attribute is displayed in the menu item.</p>

<h3 id="checkboxmenus">Checkbox Menus</h3>

<p>Checkbox menus are defined with the <code>&lt;checkbox-menu&gt;</code> element, which has the same attributes as <a href="#standardmenus">standard menus</a>. Inside of the checkbox menu can be a sequence of <code>&lt;checkbox-menu-item&gt;</code> elements.</p>

<h4 id="checkboxmenuitems">Checkbox Menu Items</h4>

<p>Checkbox menu items are defined with the <code>&lt;checkbox-menu-item&gt;</code> element. In addition to the attributes mentioned in <a href="#standardmenuitems">standard menu items</a>, they have the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>checked</code></td>
	<td>Boolean</td>
	<td>No</td>
	<td><code>false</code></td>
	<td><code>true</code> if toggle should be enabled, <code>false</code> otherwise</td>
</tr>
</tbody>
</table>

<h3 id="actionmenus-1">Action Menus</h3>

<p>Action menus are contextual menus associated with a page. Action menus are defined with the <code>&lt;action-menu&gt;</code> element, which can have the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>Unique identifier for the menu</td>
</tr>
<tr>
	<td><code>theme</code></td>
	<td><a href="./doc/Toybox/WatchUi/ACTION_.htmlMENU_THEME_DARK"><code>WatchUi.ACTION_MENU_THEME_DARK</code></a> or <a href="./doc/Toybox/WatchUi/ACTION_.htmlMENU_THEME_LIGHT"><code>WatchUi.ACTION_MENU_THEME_LIGHT</code></a></td>
	<td>No</td>
	<td><a href="./doc/Toybox/WatchUi/ACTION_.htmlMENU_THEME_DARK"><code>WatchUi.ACTION_MENU_THEME_DARK</code></a></td>
	<td>Allows configuring if the action menu is light on dark or dark on light. Not configurable on all products.</td>
</tr>
<tr>
	<td><code>personality</code></td>
	<td>Personality class</td>
	<td>No</td>
	<td>None</td>
	<td>Personality class for the element. See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a> for more information</td>
</tr>
</tbody>
</table>

<h4 id="actionmenuitems">Action Menu Items</h4>

<p>Action menu items are contained within <code>&lt;action-menu-item&gt;</code> elements and have the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Type</th>
	<th>Required</th>
	<th>Default</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>Unique identifier for the menu item</td>
</tr>
<tr>
	<td><code>label</code></td>
	<td>String</td>
	<td>Yes</td>
	<td>None</td>
	<td>String title for the menu item</td>
</tr>
<tr>
	<td><code>personality</code></td>
	<td>Personality class</td>
	<td>No</td>
	<td>None</td>
	<td>Personality class for the element. See <a href="./CoreTopics.html/#monkeystyle">Monkey Style</a> for more information</td>
</tr>
</tbody>
</table>

<h2 id="animations">Animations</h2>

<p><em>Since API level 3.1.0</em></p>

<p>The Monkey Motion tool included in the Connect IQ SDK that can be used to generate animation resources for compatible Connect IQ products.</p>

<p>The Monkey Motion tool supports importing from <a href="https://github.com/cota/streamit-2.1.1/blob/master/apps/library_only/mpeg2/c/doc/mpeg2enc.doc"><code>YUV</code></a> and <code>GIF</code> file formats. Due the fact that <code>YUV</code> is a true color, close-to-raw file format, it is the recommended format when entering a high quality animation into the Monkey Motion encoder tool. If necessary, <a href="https://ffmpeg.org/">FFmpeg</a> is a convenient tool for converting video file formats. For example, if your creative team has provided a video in some other popular format, convert the file to the <code>YUV</code> format:</p>

<pre><code>&gt; ffmpeg -i input.mp4 -vf format=yuv420p output.y4m
</code></pre>

<p>Additionally, to overcome the fact that the <code>YUV</code> format does not support transparency (unlike the <code>GIF</code> file format), the Monkey Motion tool accepts an additional <code>YUV</code> file as input. This video file should represent an alpha channel mask of the original animation that contained transparency. Again, FFmpeg is a convenient tool for creating such a video. The <code>alphaextract</code> option can be used to take an input stream with an alpha channel and return a video containing just the alpha component as a greyscale value:</p>

<pre><code>&gt; ffmpeg -i input.gif -vf alphaextract,format=yuv420p output.y4m
</code></pre>
<figure>
<img src="./resources/programmers-guide/app_settings_editor.png" style="max-width:400px;" title="The App Settings Editor" />
</figure>

<p>For the same reasons outlined in the section above, animations need to be explicitly converted for every device. For easy import into your Connect IQ application, the Monkey Motion tool batch converts video to binary encoding<a href="#fn:13" id="fnref:13" title="see footnote" class="footnote">[13]</a> for devices you select.</p>

<h3 id="includinganimationresourcesinamonkeycproject">Including Animation Resources in a Monkey C Project</h3>

<p>To include an animation resource in a Monkey C project, define an animation resource. This can be done manually or by using the Monkey Motion tool. The table below shows all of the valid attributes for an <code>&lt;animation&gt;</code> resource:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
	<th style="text-align:left;">Default Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The handle for the layout, which is used to reference the layout in the Rez module</td>
	<td style="text-align:left;">Any value that starts with a letter</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>filename</code></td>
	<td style="text-align:left;">The relative path to the Monkey Motion Manifest file</td>
	<td style="text-align:left;">A valid, resolvable path to a Monkey Motion Manifest file</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Required</td>
</tr>
<tr>
	<td style="text-align:center;"><code>personality</code></td>
	<td style="text-align:left;">Personality class for the element</td>
	<td style="text-align:left;">A defined personality class</td>
	<td style="text-align:left;">NA</td>
	<td style="text-align:left;">Optional</td>
</tr>
</tbody>
</table>

<p>An example Animation XML resource:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;animation id=&quot;swirl&quot; filename=&quot;swirl.mmm&quot; /&gt;
&lt;/resources&gt;
</code></pre>

<p>To load this animation resource in code, create a <a href="./doc/Toybox/WatchUi/AnimationLayer.html"><code>WatchUi.AnimationLayer</code></a> then add it to a <a href="./doc/Toybox/WatchUi/View.html"><code>WatchUi.View</code></a>:</p>

<pre><code class="typescript">class MyAnimationView extends WatchUi.View {

   var mySwirl;

   function initialize( dc ) {
       var dev = System.getDeviceSettings();
       var x = ( dev.screenWidth - mySwirl.getWidth() ) / 2;
       var y = ( dev.screenHeight - mySwirl.getHeight() ) / 2;

       // create a new AnimationLayer with the resource then add it to the view
       // as a WatchUi.Layer
       mySwirl = new WatchUi.AnimationLayer(Rez.Drawables.swirl, {:locX=&gt;x, :locY=&gt;y});
       view.addLayer( mySwirl );
    }

    function onShow() {
        mySwirl.play();
        View.onShow();
    }

    function onUpdate(dc) {
        // override 'onUpdate' to clear the screen
        dc.clear();
    }
}
</code></pre>

<p>Read more about Animations in the <a href="./ReferenceGuides.html#monkeymotion">Monkey Motion reference</a>, <a href="./doc/Toybox/WatchUi/AnimationResource.html">API documentation</a>, <a href="./doc/Toybox/WatchUi/AnimationLayer.html">AnimationLayer documentation</a>, the <a href="#appendixb:animationconsiderations">Animation Considerations</a>, and the <code>AnimationWatchFace</code> sample.</p>

<h2 id="jsondata">JSON Data</h2>

<p>JSON data resources can store relatively large amounts of data in your app without having to keep it in memory at all times. This can be useful for storing something like a table of information that must be referenced at runtime, but will not be modified.</p>

<p>These resources are declared with the <code>jsonData</code> tag in a resource file, are read by the resource compiler, and loaded on demand at runtime. The <code>jsonData</code> tag supports the following attributes:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Definition</th>
	<th style="text-align:left;">Valid Values</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">The identifier of the JSON resource</td>
	<td style="text-align:left;">Any string starting with a letter</td>
</tr>
<tr>
	<td style="text-align:center;"><code>filename</code></td>
	<td style="text-align:left;">The name of a file containing JSON data</td>
	<td style="text-align:left;">A valid, resolvable path to a data file</td>
</tr>
</tbody>
</table>

<p>JSON data resources may be provided as either a <code>jsonData</code> value or as a file referenced by the <code>filename</code> attribute, depending on whether it&#8217;s easier to manage the data inside a resource file or in a separate JSON file. If using a file, it may only contain JSON data. Here are a few examples:</p>

<pre><code class="xml">&lt;resources&gt;
    &lt;jsonData id=&quot;jsonDictionary&quot;&gt;{&quot;key&quot;:&quot;value&quot;, &quot;3&quot;:&quot;three&quot;, &quot;three&quot;:3}&lt;/jsonData&gt;
    &lt;jsonData id=&quot;jsonArray&quot;&gt;[1,2,3,4,5,6]&lt;/jsonData&gt;
    &lt;jsonData id=&quot;jsonMix&quot;&gt;[1,{&quot;1&quot;:&quot;one&quot;},[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]]&lt;/jsonData&gt;
    &lt;jsonData id=&quot;jsonPrimitive&quot;&gt;5&lt;/jsonData&gt;
    &lt;jsonData id=&quot;jsonFile&quot; filename=&quot;data.json&quot;/&gt;
&lt;/resources&gt;
</code></pre>

<p>The JSON data is loaded with the <a href="./doc/Toybox/Application.html#loadResource-instance_function"><code>Application.loadResource()</code></a> method by passing in the <code>jsonData</code> ID. For example, to load the <code>jsonArray</code> data from the example above, the following code would be used:</p>

<pre><code class="typescript">var array = Application.loadResource(Rez.JsonData.jsonArray);
</code></pre>

<p>For more see the <code>JsonDataResources</code> sample app distributed with the SDK.</p>

<h1 id="monkeystyle">Monkey Style</h1>

<p>Monkey style is a domain-specific property language for managing style elements. It borrows heavily from CSS but has been tailored for Monkey C. Monkey style allows developers to create style property constants that can adapt between Garmin products.</p>

<h2 id="personalityclasses">Personality Classes</h2>

<p>Monkey style allow you to create personality classes of constants. These classes can be defined using the following syntax:</p>

<pre><code class="css">personality_class {
    property: &quot;constant&quot;;
}
</code></pre>

<p>Personality classes and properties have to be named with Monkey C legal names and can have the following value types:</p>

<table>
<colgroup>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Type</th>
	<th>Example</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Number</td>
	<td>500</td>
</tr>
<tr>
	<td>Percent</td>
	<td>80%</td>
</tr>
<tr>
	<td>String</td>
	<td>“What’s the deal with style sheets?”</td>
</tr>
<tr>
	<td>Boolean</td>
	<td>true</td>
</tr>
<tr>
	<td>Color</td>
	<td>#555555</td>
</tr>
<tr>
	<td>Symbol</td>
	<td><code>:myBitmap</code></td>
</tr>
<tr>
	<td>Resource</td>
	<td><code>@Rez.Strings.promptTitle</code></td>
</tr>
<tr>
	<td>API Constant</td>
	<td><code>Graphics.TEXT_JUSTIFY_CENTER</code></td>
</tr>
<tr>
	<td>Array</td>
	<td>[<code>Graphics.FONT_SMALL</code>, <code>Graphics.FONT_TINY</code>]</td>
</tr>
</tbody>
</table>

<h2 id="resourcecompiler">Resource Compiler</h2>

<p>Personality classes can be referenced by resource compiler elements using the <code>personality</code> attribute. The <code>personality</code> attribute can reference multiple space-separated personality classes.</p>

<p>For example, you can have a personality class with the following definition:</p>

<pre><code class="css">layout1__time {
    x: &quot;center&quot;;
    y: 10%;
    font: Graphics.FONT_LARGE;
    justification: Graphics.TEXT_JUSTIFY_CENTER;
    color: Graphics.COLOR_BLUE;
}
</code></pre>

<p>This can then be referenced in your layout:</p>

<pre><code class="xml">&lt;layout id=&quot;WatchFace&quot;&gt;
    &lt;drawable class=&quot;Background&quot; /&gt;
    &lt;label id=&quot;TimeLabel&quot; personality=&quot;layout1__time&quot; /&gt;
&lt;/layout&gt;
</code></pre>

<h2 id="usingpersonalityclassesinsource">Using Personality Classes in Source</h2>

<p>Any personality class you define is addressable from the <code>Rez.Styles</code> namespace. The class is defined as a module of constant values that you can address via its name.</p>

<pre><code class="typescript">dc.setFont(Rez.Styles.layout1__time.font);
</code></pre>

<p>When referenced this way, the compiler can replace the constant references at compile time and eliminate the personality classes from your runtime.</p>

<h2 id="configuringpersonalities">Configuring Personalities</h2>

<p>You can configure the series of monkey style sheets in the jungle. This allows you to have specific style sheets for each product while keeping the content universal across products. You can configure the personality with the <code>personality</code> selector:</p>

<pre><code class="properties">fenix7system6preview.personality=$(fenix7system6preview.personality);resources-fenix2022
</code></pre>

<h1 id="gettingtheusersattention">Getting the User&#8217;s Attention</h1>

<p>Your app may need to request the user&#8217;s attention at certain times. Connect IQ offers ways to do this via the <a href="./doc/Toybox/Attention.html"><code>Toybox.Attention</code></a> module. The <a href="./doc/Toybox/Attention.html"><code>Attention</code></a> module provides access to the vibration motor, tone generator, screen backlight and flashlight.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention.html#backlight-instance_function"><code>Attention.backlight()</code></a></td>
	<td style="text-align:left;">Controls the display backlight</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention.html#setFlashlightMode-instance_function"><code>Attention.setFlashlightMode()</code></a></td>
	<td style="text-align:left;">Controls the display backlight</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention.html#playTone-instance_function"><code>Attention.playTone()</code></a></td>
	<td style="text-align:left;">Plays a tone using the tone generator</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention.html#vibrate-instance_function"><code>Attention.vibrate()</code></a></td>
	<td style="text-align:left;">Uses the vibration motor</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
</tbody>
</table>

<h2 id="backlight">Backlight</h2>

<p>The backlight behavior for Garmin devices depends on the display technology. <em>Reflective</em> displays like memory-in-pixel (MIP) typically keep the backlight off to conserve power. The user has options to have the backlight enable for different actions like button touches and gestures. These will be handled automatically by the system based on the user settings.</p>

<p><em>Emissive</em> displays like AMOLED are not backlit, but instead typically draw power to light every pixel. The brightness of the display can vary from a low brightness of an &#8220;always on&#8221; mode to full brightness when the user has gestured. The user can choose their brightness settings for the device, and the system will obey them automatically.</p>

<p>The <a href="./doc/Toybox/Attention.html#backlight-instance_function"><code>Attention.backlight()</code></a> API allows the developer to enable the screen backlight. On API 3.2.0 and above, the backlight brightness can be provided as a value between 0.0 and 1.0, and below API 3.2 the brightness can be set to <code>true</code> or <code>false</code>.</p>

<p>Note that keeping an AMOLED display on for extended periods at full brightness can damage the display. If the system detects the developer is attempting to do this, an <a href="./doc/Toybox/Attention/BacklightOnTooLong.html"><code>Attention.BacklightOnTooLong</code></a> exception will be thrown. The backlight, especially on AMOLED devices, should not be used as a flashlight. In these cases, you can use the <a href="#Flashlight">flashlight</a> API.</p>

<h2 id="flashlight">Flashlight</h2>

<p>The fēnix® 7X was the first device to have an on-device flashlight. The on-device flashlight can support different modes including:</p>

<ul>
<li>Off, on or blink patterns</li>
<li>Different brightness levels</li>
<li>Different colors</li>
</ul>

<p>The <a href="./doc/Toybox/Attention.html#setFlashlightMode-instance_function"><code>Attention.setFlashlightMode()</code></a> API allows the developer to control the device flashlight:</p>

<pre><code class="typescript">    function setFlashlightMode(mode as FlashlightMode, options as {
        :color as FlashlightColor,
        :brightness as Number or FlashlightBrightness, // 0 to 100 or special value
        :strobeMode as FlashlightStrobeMode,
        :strobeSpeed as FlashlightStrobeSpeed,
    }?) as FlashlightResult
</code></pre>

<p>The <code>mode</code> is an enum of the following possibilities:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightBrightness-.htmlmodule"><code>FLASHLIGHT_MODE_OFF</code></a></td>
	<td style="text-align:left;">Turns the flashlight off</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightBrightness-.htmlmodule"><code>FLASHLIGHT_MODE_ON</code></a></td>
	<td style="text-align:left;">Turns the flashlight on</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightBrightness-.htmlmodule"><code>FLASHLIGHT_MODE_STROBE</code></a></td>
	<td style="text-align:left;">Sets the flashlight to strobe. Use the <code>:strobeMode</code> and <code>:strobeSpeed</code> options to configure the strobe.</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<p>The <code>:color</code> option accepts <a href="./doc/Toybox/Attention/FlashlightColor-.htmlmodule"><code>FLASHLIGHT_COLOR_WHITE</code></a>, <a href="./doc/Toybox/Attention/FlashlightColor-.htmlmodule"><code>FLASHLIGHT_COLOR_GREEN</code></a>, or <a href="./doc/Toybox/Attention/FlashlightColor-.htmlmodule"><code>FLASHLIGHT_COLOR_RED</code></a>. Not every device supports every color. Use <a href="./doc/Toybox/Attention.html#hasFlashlightColor-instance_function"><code>Attention.hasFlashlightColor()</code></a> to check if a color is supported.</p>

<p>The <code>:brightness</code> option accepts the following values:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">0 to 100</td>
	<td style="text-align:left;">Sets the brightness from 0 to 100 percent</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightBrightness-.htmlmodule"><code>FLASHLIGHT_BRIGHTNESS_LOW</code></a></td>
	<td style="text-align:left;">Sets the brightness to the device low setting</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightBrightness-.htmlmodule"><code>FLASHLIGHT_BRIGHTNESS_MEDIUM</code></a></td>
	<td style="text-align:left;">Sets the brightness to the device medium setting</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightBrightness-.htmlmodule"><code>FLASHLIGHT_BRIGHTNESS_HIGH</code></a></td>
	<td style="text-align:left;">Sets the brightness to the device high setting</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<p>The <code>:strobeMode</code> can be set to the following:<a href="#fn:14" id="fnref:14" title="see footnote" class="footnote">[14]</a></p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightStrobeMode-.htmlmodule"><code>FLASHLIGHT_STROBE_MODE_BLINK</code></a></td>
	<td style="text-align:left;">Sets the strobe to a <code>--  --  --  --</code> pattern</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightStrobeMode-.htmlmodule"><code>FLASHLIGHT_STROBE_MODE_PULSE</code></a></td>
	<td style="text-align:left;">Sets the strobe to a <code>=-_  =-_  =-_  =-_</code> pattern<a href="#fn:15" id="fnref:15" title="see footnote" class="footnote">[15]</a></td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightStrobeMode-.htmlmodule"><code>FLASHLIGHT_STROBE_MODE_BLITZ</code></a></td>
	<td style="text-align:left;">Sets the strobe to a <code>...   ...   ...</code> pattern</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<p>The <code>:strobeSpeed</code> can be set to the following:<a href="#fn:14" title="see footnote" class="footnote">[14]</a></p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightStrobeMode-.htmlmodule"><code>FLASHLIGHT_STROBE_SPEED_SLOW</code></a></td>
	<td style="text-align:left;">Uses a slow strobe mode</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightStrobeMode-.htmlmodule"><code>FLASHLIGHT_STROBE_SPEED_MEDIUM</code></a></td>
	<td style="text-align:left;">Uses a medium strobe mode</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightStrobeMode-.htmlmodule"><code>FLASHLIGHT_STROBE_SPEED_FAST</code></a></td>
	<td style="text-align:left;">Uses a fast strobe mode</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<p>The <a href="./doc/Toybox/Attention.html#setFlashlightMode-instance_function"><code>setFlashlightMode()</code></a> API returns the following based on the input:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightResult-.htmlmodule"><code>FLASHLIGHT_RESULT_SUCCESS</code></a></td>
	<td style="text-align:left;">Flashlight mode was set successfully</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightResult-.htmlmodule"><code>FLASHLIGHT_RESULT_INVALID_COLOR</code></a></td>
	<td style="text-align:left;">Flashlight mode could not be set because an invalid color was specified</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightResult-.htmlmodule"><code>FLASHLIGHT_RESULT_INVALID_BRIGHTNESS</code></a></td>
	<td style="text-align:left;">Flashlight mode could not be set because the brightness is not supported</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightResult-.htmlmodule"><code>FLASHLIGHT_RESULT_MODE</code></a></td>
	<td style="text-align:left;">Flashlight mode could not be set because the mode is not supported</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightResult-.htmlmodule"><code>FLASHLIGHT_RESULT_SPEED</code></a></td>
	<td style="text-align:left;">Flashlight mode could not be set because the strobe speed is not supported</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Attention/FlashlightResult-.htmlmodule"><code>FLASHLIGHT_RESULT_FAILURE</code></a></td>
	<td style="text-align:left;">Flashlight mode could not be set</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<h2 id="tones">Tones</h2>

<p>Garmin devices often use audible tones for different events. The <a href="./doc/Toybox/Attention.html#playTone-instance_function"><code>Attention.playTone()</code></a> API provides access to the tone generator:</p>

<pre><code class="typescript">    function playTone(options as Tone or {
            :toneProfile as Array&lt;ToneProfile&gt;,
            :repeatCount as Number
        }) as Void
</code></pre>

<p>To play a system tone, you can pass one of the <a href="./doc/Toybox/Attention/Tone-.htmlmodule"><code>Attention.Tone</code></a> enum values. If you want to play a custom tone, you can pass an array of <a href="./doc/Toybox/Attention/ToneProfile.html"><code>Attention.ToneProfile</code></a> objects to the <code>:toneProfile</code> option. The <a href="./doc/Toybox/Attention/ToneProfile.html"><code>ToneProfile</code></a> allows you to set a frequency and duration for each note.</p>

<h2 id="vibration">Vibration</h2>

<p>The vibration motor can be used to inform the user that an event that needs their attention is occurring. You can engage the vibration motor with the <a href="./doc/Toybox/Attention.html#vibrate-instance_function"><code>Attention.vibrate()</code></a> API:</p>

<pre><code class="typescript">function vibrate(vibeProfiles as Array&lt;VibeProfile&gt;) as Void
</code></pre>

<p>You pass the <a href="./doc/Toybox/Attention.html#vibrate-instance_function"><code>vibrate()</code></a> API a set of <a href="./doc/Toybox/Attention/ToneProfile.html"><code>Attention.ToneProfile</code></a> objects. Each <a href="./doc/Toybox/Attention/ToneProfile.html"><code>ToneProfile</code></a> contains a duty cycle and a duration. The device will go through each <a href="./doc/Toybox/Attention/ToneProfile.html"><code>ToneProfile</code></a> in order, adjusting the duty cycle for the specified durations.</p>

<h1 id="jsonrestrequests">JSON REST Requests</h1>

<p>Widgets and apps can communicate with a mobile phone via <a href="https://en.wikipedia.org/wiki/Bluetooth_low_energy" title="Bluetooth low energy">Bluetooth Low Energy</a> (BLE). The mobile phone may be sharing data with the device, or it may act as a bridge between the app and the Internet. This allows the mobile phone to become part of the wearable web.</p>

<p>There are also high-level interfaces for making JSON and image requests. This allows developers the option of developing a wearable web app without having to write their own companion phone app.</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>API</th>
	<th>Purpose</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Communications.html#makeWebRequest-instance_function"><code>Communications.makeWebRequest()</code></a></td>
	<td>Make an asynchronous JSON REST request to a web service</td>
	<td>1.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Communications.html#makeImageRequest-instance_function"><code>Communications.makeImageRequest()</code></a></td>
	<td>Download an image from the web</td>
	<td>1.2.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Communications.html#openWebPage-instance_function"><code>Communications.openWebPage()</code></a></td>
	<td>Commands Connect Mobile to ask the user to view a web link</td>
	<td>1.3.0</td>
</tr>
</tbody>
</table>

<h2 id="jsonrestrequestsviamobileproxy">JSON REST Requests via Mobile Proxy</h2>

<p>Monkey C exposes a high level APIs to allow calls to basic web services through Garmin Connect Mobile via the <a href="./doc/Toybox/Communications.html#makeWebRequest-var"><code>Communications.makeWebRequest()</code></a> and <a href="./doc/Toybox/Communication.html#makeImageRequest-instance_function"><code>Communications.makeImageRequest()</code></a> APIs. These APIs expose JSON requests and image requests as very straightforward APIs for making REST API calls. The JSON calls are converted to serialized Monkey C data and sent across the BLE pipe. You must have set the <code>Communications</code> permission to use this API.</p>

<p><a href="./doc/Toybox/Communications.html#makeWebRequest-instance_function"><code>makeWebRequest()</code></a> provides a high level API for making a JSON REST request to an endpoint. The call is asynchronous and requires a callback to receive the data once the operation completes.</p>

<pre><code class="typescript">// It is common for developers to wrap a makeWebRequest() call in a function
// as displayed below. The function defines the variables for each of the
// necessary arguments in a Communications.makeWebRequest() call, then passes
// these variables as the arguments. This allows for a clean layout of your web
// request and expandability.
import Toybox.System;
import Toybox.Communications;
import Toybox.Lang;

class JsonTransaction {
    // set up the response callback function
    function onReceive(responseCode as Number, data as Dictionary?) as Void {
        if (responseCode == 200) {
            System.println(&quot;Request Successful&quot;);                   // print success
        } else {
            System.println(&quot;Response: &quot; + responseCode);            // print response code
        };

    };

    function makeRequest() as Void {
        var url = &quot;https://www.garmin.com&quot;;                         // set the url

        var params = {                                              // set the parameters
            &quot;definedParams&quot; =&gt; &quot;123456789abcdefg&quot;
        };

        var options = {                                             // set the options
            :method =&gt; Communications.HTTP_REQUEST_METHOD_GET,      // set HTTP method
            :headers =&gt; {                                           // set headers
            &quot;Content-Type&quot; =&gt; Communications.REQUEST_CONTENT_TYPE_URL_ENCODED},
            // set response type
            :responseType =&gt; Communications.HTTP_RESPONSE_CONTENT_TYPE_URL_ENCODED
        };

        var responseCallback = method(:onReceive);                  // set responseCallback to
        // onReceive() method
        // Make the Communications.makeWebRequest() call
        Communications.makeWebRequest(url, params, options, method(:onReceive));
    }
}
</code></pre>

<p><a href="./doc/Toybox/Communication.html#makeImageRequest-instance_function"><code>makeImageRequest()</code></a> offers a similar API for making an image request. The images can be processed by the system, including applying a palette and dithering.</p>

<pre><code class="typescript">import Toybox.System;
import Toybox.Communications;
import Toybox.WatchUi;

class ImageTransaction {
    var image as BitmapResource?;
    var responseCode as Number?;

    // Set up the responseCallback function to return an image or null
    function responseCallback(responseCode as Number, data as BitmapResource?) {
        responseCode = responseCode;
        if (responseCode == 200) {
            image = data;
        } else {
            image = null;
        }
    }

    // wrap the request in a function
    function makeRequest() as Void {
        // set the image url
        var url = &quot;http://www.garmin.com/image-path&quot;;
        // set the parameters
        var parameters = null;
        // set the options
        var options = {
            // set the palette
            :palette =&gt; [ Gfx.COLOR_ORANGE,
                          Gfx.COLOR_DK_BLUE,
                          Gfx.COLOR_BLUE,
                          Gfx.COLOR_BLACK
                        ],
            // set the max width
            :maxWidth =&gt; 100,
            // set the max height
            :maxHeight =&gt; 100,
            // set the dithering
            :dithering =&gt; Communications.IMAGE_DITHERING_NONE
        };

        // Make the image request
        Communications.makeImageRequest(url, parameters, options, method(:responseCallback));
    }
}
</code></pre>

<p>For more see the <code>WebRequest</code> sample app distributed with the SDK.</p>

<h2 id="directinguserstowebcontent">Directing Users to Web Content</h2>

<p>The <a href="./doc/Toybox/Communication.html#openWebPage-instance_function"><code>openWebPage</code></a> call can be used to direct the user to a specific web page on the paired mobile device. When called, the specified web page should be fetched and displayed in the phones default browser. There is no callback for this function and the watch app has no method for checking if the call was completed on the phone successfully.</p>

<h1 id="authenticatedwebservices">Authenticated Web Services</h1>

<p>There are countless web services available to developers that use either OAuth to provide access control. Connect IQ has OAuth APIs in the <strong>Communications</strong> module that allow widgets and device apps to make authenticated calls.</p>

<h2 id="oauth101">OAuth 101</h2>

<p>OAuth provides a standard way for developers to authenticate to gain access to web APIs. Before an app can access the web API, the developer must register the app with the service. During registration you must provide a redirect URL that will be used to retrieve the credentials. Once registered the app will provide a <em>client id</em> and <em>secret</em>, which are necessary for the login process.</p>

<p><img src="./resources/programmers-guide/oauth_flow.png" style="max-width:300px;" title="OAuth flow"  />
</figure></p>

<p>To access the web service, the app must authenticate the user. To do this, the app redirects the user&#8217;s web browser to the web service authentication page, providing the secret, the client id, and the redirect URL. After the service has authenticated the user, it redirects their browser back to the client providing an access token. The access token can then be used in subsequent calls to the web service.</p>

<h2 id="oauthandwearables">OAuth and Wearables</h2>

<p>The OAuth standard is based on the world of web browsers and mobile applications, but in general people don&#8217;t want to enter their username and password on their watch. Connect IQ has added some new APIs to allow you to write OAuth enabled apps:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Operation</th>
	<th>Function</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Request credentials from an OAuth 2.0 web endpoint</td>
	<td><a href="./doc/Toybox/Communications.html#makeOAuthRequest-instance_function"><code>Communications.makeOAuthRequest()</code></a></td>
	<td>1.3.0</td>
</tr>
<tr>
	<td>Request credentials from an OAuth 2.0 web endpoint</td>
	<td><a href="./doc/Toybox/Authentication.html#makeOAuthRequest-instance_function"><code>Authentication.makeOAuthRequest()</code></a></td>
	<td>3.3.0</td>
</tr>
<tr>
	<td>Register a callback to receive OAuth credentials upon user completion</td>
	<td><a href="./doc/Toybox/Communications.html#registerForOAuthMessages-instance_function"><code>Communications.registerForOAuthMessages()</code></a></td>
	<td>1.3.0</td>
</tr>
<tr>
	<td>Register a callback to receive OAuth credentials upon user completion</td>
	<td><a href="./doc/Toybox/Authentication.html#registerForOAuthMessages-instance_function"><code>Authentication.registerForOAuthMessages()</code></a></td>
	<td>3.3.0</td>
</tr>
</tbody>
</table>

<p>The <a href="./doc/Toybox/Communications.html#makeOAuthRequest-instance_function"><code>Communications.makeOAuthRequest()</code></a> and <a href="./doc/Toybox/Authentication.html#makeOAuthRequest-instance_function"><code>Authentication.makeOAuthRequest()</code></a> calls are intended for implementing credential entry step of the OAuth 1.0 &amp; 2.0 standard. Be sure to use the following redirects when using the <code>makeOAuthRequest</code> call:</p>

<table>
<colgroup>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>API</th>
	<th>Redirect</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Communications.html#makeOAuthRequest-instance_function"><code>Communications.makeOAuthRequest()</code></a></td>
	<td><code>http://localhost</code></td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Authentication.html#makeOAuthRequest-instance_function"><code>Authentication.makeOAuthRequest()</code></a></td>
	<td><code>connectiq://oauth</code></td>
</tr>
</tbody>
</table>

<p>When called, the user will receive a phone notification that your app wants to log into a web service. Clicking on this notification will take the user to a web view within Garmin Connect mobile app (<code>Communications.makeOAuthRequest()</code>) or the Connect IQ Store mobile app (<code>Authentication.makeOAuthRequest()</code>), where they can enter their log in information.</p>

<p><img src="./resources/programmers-guide/oauth_notification.png" style="max-width:300px;" title="OAuth notification" />
</figure></p>

<p>During this time, the Connect IQ app should display a page directing the user to open the respective application. Once the user has completed credential entry, Connect will send back the tokens specified in the <code>resultKeys</code> option, and direct them back to the wearable.</p>

<p><img src="./resources/programmers-guide/oauth_complete.png" style="max-width:300px;" title="OAuth complete" />
</figure></p>

<p>Your app should call <a href="./doc/Toybox/Communications.html#registerForOAuthMessages-instance_function"><code>Communications.registerForOAuthMessages()</code></a> or <a href="./doc/Toybox/Authentication.html#registerForOAuthMessages-instance_function"><code>Authentication.registerForOAuthMessages()</code></a> to receive the result of the login process. Logging in can take a long time, and a widget may time out before the user completes the login step. If your app closes before the login process completes, the result will be cached on the device until the next time your app calls <a href="./doc/Toybox/Communications.html#registerForOAuthMessages-instance_function"><code>registerForOAuthMessages()</code></a>, at which point the result will be passed to your callback immediately. Once you have the access token, you can use it as an argument to <a href="./doc/Toybox/Communications.html#makeWebRequest-instance_function"><code>Communications.makeWebRequest()</code></a>.</p>

<h1 id="communicatingwithmobileapps">Communicating with Mobile Apps</h1>

<p>There are a few complications with device-to-phone communication. For example, the watch app may be killed during the time communication happens, or a phone app may try to send information while the app is not active. In order to simplify these cases for the developer, Monkey C does not expose a low-level interface, but instead exposes a very high-level approach: the API exposes a mailbox metaphor instead of using a socket metaphor. Messages are constructed as a parcel of information and sent back and forth between devices. Each app will have a mailbox where messages are received, and an event that fires when new messages arrive.</p>

<h2 id="mobilesdkdownloads">Mobile SDK Downloads</h2>

<p>The Connect IQ Mobile SDKs are released separately from the Connect IQ Developer SDK and is available for iOS and Android. There are several editions of the Mobile SDK available:</p>

<ul>
<li>Android BLE</li>
<li>iOS BLE</li>
<li>Android ADB</li>
</ul>

<p>The <a href="https://en.wikipedia.org/wiki/Bluetooth_low_energy" title="Bluetooth low energy">BLE</a> edition supports development of communication-enabled applications on an iOS or Android target device while the <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">Android Debug Bridge</a> (ADB) edition is used for testing with the Connect IQ Simulator.</p>

<p>More information on how to download the correct version for your mobile platform may be found on the <a href="http://developer.garmin.com/connect-iq/developer-tools/communication">Garmin Developer site</a> and the <a href="./CoreTopics.html#mobilesdkforandroid">Mobile SDK for Android</a> and <a href="./CoreTopics.html#mobilesdkforios">Mobile SDK for iOS</a> sections.</p>

<h2 id="blesimulationoverandroiddebugbridge">BLE Simulation Over Android Debug Bridge</h2>

<p>When using the Connect IQ Simulator, it is possible to communicate with a companion app running on an Android device using <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">ADB</a>. This will simulate actual <a href="https://en.wikipedia.org/wiki/Bluetooth_low_energy" title="Bluetooth low energy">BLE</a> speeds to better approximate performance of your application.</p>

<p>The <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">ADB</a> edition of the Android Mobile SDK and companion app is required to use <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">ADB</a> for testing. Here&#8217;s how to enable the companion to communicate over <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">ADB</a>:</p>

<ol>
<li>Connect the phone to the PC running the simulator via USB</li>
<li>Have USB debugging enabled on the Android handset</li>
<li>Obtain an instance of ConnectIQ using <code>getInstance( IQCommProtocol.ADB_SIMULATOR )</code></li>
<li>Optionally call <code>setAdbPort( int port )</code> to set a specific port to use for communication (the default port is 7381)</li>
<li>Call <code>initialize()</code></li>
</ol>

<p>To allow the simulator to communicate over <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">ADB</a>, forward the TCP port to the Android device in a terminal or console:</p>

<pre><code class="bash">adb forward tcp:7381 tcp:7381
</code></pre>

<p>Note that this command will need to be reissued for each connected Android device, or if a device is disconnected and re-connected.</p>

<p>Once your app is started on the phone, connect it to the simulator by clicking the <em>Connection</em> menu and selecting <em>Start</em> (CTRL-F1). The Connect IQ apps in the simulator will now be able to communicate with your device via the Communications APIs over <a href="http://developer.android.com/tools/help/adb.html" title="Android Debug Bridge">ADB</a>.</p>

<h1 id="downloadingcontent">Downloading Content</h1>

<p><em>Since API level 2.2.0</em></p>

<p>The <a href="./doc/Toybox/PersistedContent.html"><code>Toybox.PersistedContent</code></a> module allows access to the saved Tracks, Courses, Waypoints, Workouts, and Routes that the user has on their device. These content types contain a name and a unique identifier, which can be used by <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>System.exitTo()</code></a> as an <a href="./doc/Toybox/System/Intent.html"><code>Intent</code></a> to launch into a native app and present the content to the user in some way. See the <a href="./CoreTopics.html#intents">Intents</a> section for more details.</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Type</th>
	<th>Object</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Track, Route, Course</td>
	<td><a href="./doc/Toybox/PersistedContent/Track.html"><code>PersistedContent.Track</code></a>, <a href="./doc/Toybox/PersistedContent/Route.html"><code>PersistedContent.Route</code></a>, <a href="./doc/Toybox/PersistedContent/Course.html"><code>PersistedContent.Course</code></a> <a href="#fn:16" id="fnref:16" title="see footnote" class="footnote">[16]</a></td>
	<td>2.2.0</td>
</tr>
<tr>
	<td>Waypoint</td>
	<td><a href="./doc/Toybox/PersistedContent/Waypoint.html"><code>PersistedContent.Waypoint</code></a></td>
	<td>2.2.0</td>
</tr>
<tr>
	<td>Workout</td>
	<td><a href="./doc/Toybox/PersistedContent/Workout.html"><code>PersistedContent.Workout</code></a></td>
	<td>2.2.0</td>
</tr>
</tbody>
</table>

<p>Calling <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>exitTo()</code></a> with a <a href="./doc/Toybox/PersistedContent.html"><code>Toybox.PersistedContent</code></a> object prompts the user to choose which native app to launch. For example, if an app calls <a href="./doc/Toybox/System.html#exitTo-instance_function"><code>exitTo()</code></a> with a <a href="./doc/Toybox/PersistedContent/Waypoint.html"><code>Waypoint</code></a> object, the dialog will ask whether to launch the waypoint with one of either the Run or Bike native apps.</p>

<p>When retrieving the list of stored content on the device, a <a href="./doc/Toybox/PersistedContent/Iterator.html"><code>PersistedContent.Iterator</code></a> will be returned. The <a href="./doc/Toybox/PersistedContent/Iterator.html#next-instance_function"><code>Iterator.next()</code></a> function must be called to get the first entry, and <code>null</code> is returned when there are no more entries:</p>

<pre><code class="typescript">import Toybox.PersistedContent;
import Toybox.System;

function example() as Void {}
    // Get the first waypoint from the device
    var waypoints = PersistedContent.getWaypoints();
    var waypoint = waypoints.next();

    if(waypoint != null) {
        // Launch the waypoint (User will be asked
        // what activity to launch in)
        System.exitTo(waypoint.toIntent());
    }
}
</code></pre>

<p>There are three possible cases once the content is sent to the device:</p>

<ol>
<li><strong>Data import is successful</strong> - A <code>PersistedContent.Iterator</code> will be returned, which contains the elements that were downloaded.</li>
<li><strong>The system does not have enough space</strong> - The <code>STORAGE_FULL</code> response will be returned to the <code>responseCallback</code>.</li>
<li><strong>The system does not support the file type</strong> (i.e. a running workout is sent to a cycling device) - The <code>responseCallback</code> will return an empty iterator or <code>null</code> value.</li>
</ol>

<p>Access to <code>PersistedContent</code> requires the &#8216;Persisted Content&#8217; permission.</p>

<h2 id="persistedcontentinthesimulator">Persisted Content in the Simulator</h2>

<p>Because native apps are not simulated in Connect IQ simulator, an <em>Intent Launched</em> feature has been added that is useful for testing with <a href="./doc/Toybox/PersistedContent.html"><code>Toybox.PersistedContent</code></a>. This feature displays three critical pieces of information about the <a href="./doc/Toybox/PersistedContent.html"><code>Toybox.PersistedContent</code></a> object supplied via <a href="./doc/Toybox/System/Intent.html"><code>Intent</code></a> in the simulator window:</p>

<ol>
<li>The object type</li>
<li>The unique serializable ID of the object</li>
<li>The name of the object</li>
</ol>

<p>For example, the sample code above may display a picture of an activity with &#8220;Intent Launched&#8221;, a type, an ID number and its name displayed.</p>
<figure>
<img src="./resources/programmers-guide/intent-launched.png" style="max-width:635px;" title="Launched Intent in the Simulator" />
</figure>

<h2 id="wifibulkdownloads">WiFi Bulk Downloads</h2>

<p><em>Since API level 3.1.0</em></p>

<p>In some cases, the <a href="https://en.wikipedia.org/wiki/Bluetooth_low_energy" title="Bluetooth low energy">Bluetooth Low Energy</a> (BLE) link to Garmin Connect Mobile is too slow for downloading some content. For these situations, the WiFi Bulk Downloads feature can prove useful.</p>

<p>The <a href="./doc/Toybox/Communications.html"><code>Communications</code></a> module provides methods to initiate a transition to sync mode, and communicate sync status information to the system for display. The <a href="./doc/Toybox/Application/AppBase.html"><code>Application.AppBase</code></a> class provides an entry point for the system to get a delegate used to communicate with the app while in sync mode.</p>

<table>
<colgroup>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Function or Class</th>
	<th>Purpose</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Communications.html#startSync-instance_function"><code>Communications.startSync()</code></a></td>
	<td>Exit the Application and launch it in sync mode.</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Application/AppBase.html#getSyncDelegate-instance_function"><code>AppBase.getSyncDelegate()</code></a></td>
	<td>Get a SyncDelegate object that communicates sync status to the system</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Communications/SyncDelegate.html"><code>Communications.SyncDelegate</code></a></td>
	<td>A delegate object that the user implements to respond to sync request</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Communications.html#notifySyncProgress-instance_function"><code>Communications.notifySyncProgress()</code></a></td>
	<td>Send a system notification to the system to indicate overall sync progress.</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Communications.html#notifySyncComplete-instance_function"><code>Communications.notifySyncComplete()</code></a></td>
	<td>Send a system notification to the system to indicate that the sync completed.</td>
</tr>
</tbody>
</table>

<p>To use the bulk download functionality, implement <a href="./doc/Toybox/Application/AppBase.html#getSyncDelegate-instance_function"><code>getSyncDelegate()</code></a> to return an instance of a class derived from <a href="./doc/Toybox/Communications/SyncDelegate.html"><code>SyncDelegate</code></a>. When the application calls <a href="./doc/Toybox/Communications.html#startSync-instance_function"><code>Communications.startSync()</code></a>, the system will terminate the running application, re-launch it in sync mode, and make a call to <a href="./doc/Toybox/Application/AppBase.html#getSyncDelegate-instance_function"><code>getSyncDelegate()</code></a> to retrieve the application&#8217;s <a href="./doc/Toybox/Communications/SyncDelegate.html"><code>SyncDelegate</code></a>.</p>

<p>Once the application has retrieved the application&#8217;s <a href="./doc/Toybox/Communications/SyncDelegate.html"><code>SyncDelegate</code></a>, it will verify that a sync is necessary by calling <a href="./doc/Toybox/Communications/SyncDelegate.html#isSyncNeeded-instance_function"><code>SyncDelegate.isSyncNeeded()</code></a>. If this method returns <code>true</code>, the system will proceed to call <a href="./doc/Toybox/Communications/SyncDelegate.html#onStartSync-instance_function"><code>SyncDelegate.onStartSync()</code></a>. At this point, the delegate may initiate a request to download content by making a call to <a href="./doc/Toybox/Communications.html#makeWebRequest-instance_function"><code>Communications.makeWebRequest()</code></a> or <a href="./doc/Toybox/Communications.html#makeImageRequest-instance_function"><code>Communications.makeImageRequest()</code></a>. When the response callback for the request is invoked, the delegate should notify the system of the progress made by calling <a href="./doc/Toybox/Communications.html#notifySyncProgress-instance_function"><code>notifySyncProgress()</code></a>. If additional content remains to be downloaded, another content request may be issued. This cycle should repeat until all content has been downloaded or an error has occurred, at which time a call to <a href="./doc/Toybox/Communications.html#notifySyncComplete-instance_function"><code>notifySyncComplete()</code></a> should be made to notify the system that the app can leave sync mode.</p>

<p>If the user decides to cancel the bulk download operation, the system will call <a href="./doc/Toybox/Communications/SyncDelegate.html#onStopSync-instance_function"><code>SyncDelegate.onStopSync()</code></a> to notify the application. The app must acknowledge the sync cancellation by calling <a href="./doc/Toybox/Communications.html#notifySyncComplete-instance_function"><code>notifySyncComplete()</code></a>. The system will display the given error message, if appropriate, and will proceed to exit sync mode.</p>

<p>For more see the <code>BulkDownload</code> sample app distributed with the SDK.</p>

<h1 id="mobilesdkforandroid">Mobile SDK for Android</h1>

<p>The Mobile SDK allows you to create companion applications that run on a
user&#8217;s phone and interact with your application on their wearable
device. This allows for a more feature rich user experience where doing
certain tasks on the wearable device might be tedious or resource
intensive.</p>

<h2 id="addingthemobilesdktoaproject">Adding the Mobile SDK to a project</h2>

<p>The Mobile SDK is publicly available on Maven Central at <a href="https://central.sonatype.com/artifact/com.garmin.connectiq/ciq-companion-app-sdk">ConnectIQ Companion App SDK</a>. To include
the AAR to your project add the following line to your build.gradle file</p>

<pre><code class="kotlin">   implementation &quot;com.garmin.connectiq:ciq-companion-app-sdk:&lt;latest_version&gt;@aar&quot;
</code></pre>

<h2 id="additionalrequirements">Additional Requirements</h2>

<p>In order for your companion application to communicate with a Connect IQ
device the user must also install Garmin Connect Mobile onto their
phone. All communication for companion applications running on Android
goes through a Garmin Connect Mobile service to reach the device. When
initializing the SDK with a wireless connection type this requirement is
checked and initialization will fail if Garmin Connect Mobile is not
installed. If true is passed to the auto UI parameter of initialize, a
message is displayed to the user that they need to either install or
upgrade Garmin Connect Mobile and provides them a way to go directly to
the application in the Google Play Store. See <code>Displaying a UI message
automatically when initialization fails</code> for more information.</p>

<h2 id="interactingwiththesdk">Interacting with the SDK</h2>

<p>All interactions between the companion application and the Connect IQ
application are done via the <code>ConnectIQ</code> class. To use this class you must
first obtain an instance of the class and then initialize it.</p>

<pre><code class="java">  ConnectIQ connectIQ = ConnectIQ.getInstance(ConnectIQ.IQConnectType.&lt;protocol&gt;);
</code></pre>

<p><code>ConnectIQ.IQConnectType</code> provides two options:</p>

<ul>
<li>WIRELESS - For communicating with the Connect IQ simulator or real device via BLE. This is the default.</li>
<li>TETHERED - For communicating with the Connect IQ simulator over the Android Debug Bridge.</li>
</ul>

<h2 id="initializingthesdk">Initializing the SDK</h2>

<p>Initializing the SDK is an asynchronous process and requires a
<code>ConnectIQListener</code> to handle returned states of the SDK. You must wait
for the <code>onSdkReady()</code> call to be made before calling any additional API
methods. Doing so beforehand will result in an <code>InvalidStateException</code>.</p>

<pre><code class="java">connectIQ.initialize(context, true, new ConnectIQListener() {

    // Called when the SDK has been successfully initialized
    @Override
    public void onSdkReady() {

        // Do any post initialization setup.
    }

    // Called when the SDK has been shut down

    @Override
    public void onSdkShutDown() {

        // Take care of any post shutdown requirements
    }

    // Called when initialization fails.
    @Override
    public void onInitializationError(IQSdkErrorStatus status) {

        // A failure has occurred during initialization. Inspect
        // the IQSdkErrorStatus value for more information regarding
        // the failure.
    }

});
</code></pre>

<h2 id="displayingauimessageautomaticallywheninitializationfails">Displaying a UI message automatically when initialization fails</h2>

<p>If initialization fails due to Garmin Connect Mobile not being installed
on the user&#8217;s phone or if it needs to be upgraded, a message can be
displayed prompting the user to take action. You can tell the SDK to
display this message automatically by passing true as the second
parameter to the <code>initialize()</code> method. By default, the UI will display a
dialog message to the user asking them to take action. The strings that
make up the dialogs are by default English only strings. These strings
are fully customizable by simply adding some predefined strings to your
projects <code>strings.xml</code> file.</p>

<h3 id="customizablestrings">Customizable Strings</h3>

<ul>
<li><code>install_needed_title</code> &#8212; Dialog title for when Garmin Connect Mobile needs to be installed.</li>
<li><code>install_needed_message</code> &#8212; Dialog message for when Garmin Connect Mobile needs to be installed.</li>
<li><code>install_needed_yes</code> &#8212; Button text for user to confirm they want to visit the Google Play Store to install Garmin Connect Mobile.</li>
<li><code>install_needed_cancel</code> &#8212; Button text for user to cancel the dialog and not install Garmin Connect Mobile.</li>
<li><code>upgrade_needed_title</code> &#8212; Dialog title for when Garmin Connect Mobile needs to be upgraded to a version that supports the SDK.</li>
<li><code>upgrade_needed_message</code> &#8212; Dialog message for when Garmin Connect Mobile needs to be upgraded to a version that supports the SDK.</li>
<li><code>upgrade_needed_yes</code> &#8212; Button text for user to confirm they want to visit the Google Play Store to upgrade Garmin Connect Mobile.</li>
<li><code>upgrade_needed_cancel</code> &#8212; Button text for a user to cancel the dialog and not upgrade Garmin Connect Mobile.</li>
</ul>

<h2 id="workingwithdevices">Working with Devices</h2>

<h3 id="findingconnectiq-compatibledevices">Finding Connect IQ-compatible Devices</h3>

<p>Before you can interact with a Connect IQ device, you must obtain a
reference to an <code>IQDevice</code> object instance representing it. This is done
by one of two methods.</p>

<p><code>getKnownDevices()</code> will return a list of any Connect IQ device that has
been paired within Garmin Connect Mobile. These devices may or may not
be connected at the time the API is called.</p>

<pre><code class="java">List&lt;IQDevice&gt; paired = connectIQ.getKnownDevices();

if (paired != null &amp;&amp; paired.size() &gt; 0) {
    // get the status of the devices
    for (IQDevice device : paired) {
        IQDeviceStatus status = connectIQ.getStatus(device);
        if (status == IQDeviceStatus.CONNECTED) {
            // Work with the device
        }
    }
}
</code></pre>

<p><code>getConnectedDevices()</code> will return a list of currently connected devices.
Because these devices could become disconnected at any time, it is good
practice to register to receive a notification when the device connects
or disconnects. See the next section for more information.</p>

<pre><code class="java">List&lt;IQDevice&gt; devices = connectIQ.getConnectedDevices();

if (devices != null &amp;&amp; devices.size() &gt; 0) {

    // Work with devices.
}
</code></pre>

<h3 id="listeningfordeviceevents">Listening for Device Events</h3>

<p>You can request to be notified when the status of a device changes by
calling <code>registerForDeviceEvents(IQDevice, IQDeviceEventListener)</code>. Once
registered any device status change will call the
<code>IQDeviceEventListener.onDeviceStatusChanged()</code> with the new status. When
you no longer need to receive updates for a device, you should call
<code>unregisterForDeviceEvents(IQDevice)</code> to release any associated resources.</p>

<pre><code class="java">// Register to receive status updates
connectIQ.registerForDeviceEvents(device, new IQDeviceEventListener() {

    @Override
    public void onDeviceStatusChanged(IQDevice device, IQDeviceStatus newStatus) {

        // Handle new status
    }
});

// Get the current status
IQDeviceStatus current = device.getStatus();

// Unregister when we no longer need status updates
connectIQ.unregisterForDeviceEvents(device);
</code></pre>

<h4 id="possibledevicestatuses">Possible Device statuses</h4>

<ul>
<li><code>CONNECTED</code> &#8212; The device is connected and can be communicated with.</li>
<li><code>NOT_CONNECTED</code> &#8212; The device is paired with Garmin Connect Mobile but is not currently connected and cannot be communicated with.</li>
<li><code>NOT_PAIRED</code> &#8212; The device is not paired with Garmin Connect Mobile and cannot be communicated with.</li>
</ul>

<h2 id="workingwithapps">Working with Apps</h2>

<h3 id="obtaininganinstanceofiqapp">Obtaining an Instance of IQApp</h3>

<p>Apps are represented in the Mobile SDK as instances of the <code>IQApp</code> class.
While you can create an <code>IQApp</code> instance on your own, it is recommended to
obtain a fully populated <code>IQApp</code> instance via the <code>getApplicationInfo()</code>
method. You can determine if your Connect IQ application is installed on
the user&#8217;s device by passing the Applications UUID, the <code>IQDevice</code>, and an
<code>IQApplicationInfoListener</code> into a <code>getApplicationInfo()</code> call.
<code>IQApplicationInfoListener.onApplicationInfoReceived( IQApp )</code> will be
called if the application is installed on the watch, and
<code>IQApplicationInfoListener.onApplicationNotInstalled( String )</code> if the app
does not exist on the watch. <code>onApplicationInfoReceived</code> will be called
with an IQApp object that can be inspected via the <code>getStatus()</code> method to
determine the status of your application on the device. If the status is
<code>INSTALLED</code>, the version number will also be populated so you can
determine if the user has the latest version of your application.</p>

<pre><code class="java">connectIQ.getApplicationInfo(MY_APPLICATION_ID, device, new IQApplicationInfoListener() {
    @Override
    public void onApplicationInfoReceived( IQApp app ) {
        if (app != null) {
            if (app.getStatus() == INSTALLED) {
                if (app.getVersion() &lt; MY_CURRENT_VERSION) {
                    // Prompt the user to upgrade
                }
            }
        }
    }
    @Override
    public void onAPplicationNotInstalled( String applicationId ) {
        // Prompt user with information
        AlertDialog.Builder dialog = new AlertDialog.Builder( this );
        dialog.setTitle( &quot;Missing Application&quot; );
        dialog.setMessage( &quot;Corresponding IQ application not installed&quot; );
        dialog.setPositiveButton( android.R.string.ok, null ); dialog.create().show();
    }
});
</code></pre>

<h4 id="possibleapplicationstatuses">Possible Application Statuses</h4>

<ul>
<li>INSTALLED &#8212; The application is installed on the device and the version information has been populated.</li>
<li>NOT_INSTALLED &#8212; The application is not currently installed on the device but is supported.</li>
<li>NOT_SUPPORTED &#8212; The application is not installed on the device and is not supported by the device.</li>
</ul>

<h3 id="openinganapponthedevice">Opening an App on the Device</h3>

<p>You may wish to prompt the user to open a Connect IQ application on their
device. To do this you can use the <code>openApplication</code> API. A response from
the device will be returned to your <code>IQOpenApplicationListener</code>.</p>

<pre><code class="java">connectIQ.openApplication(device, app, new IQOpenApplicationListener() {

    @Override
    public void onOpenApplicationResponse(IQDevice device, IQApp app, IQOpenApplicationStatus status) {
        // Handle the response here
    }

});
</code></pre>

<h4 id="possibleopenapplicationstatuses">Possible Open Application Statuses</h4>

<ul>
<li>PROMPT_SHOWN_ON_DEVICE</li>
<li>PROMPT_NOT_SHOWN_ON_DEVICE</li>
<li>APP_IS_NOT_INSTALLED</li>
<li>APP_IS_ALREADY_RUNNING</li>
<li>UNKNOWN_FAILURE</li>
</ul>

<h3 id="openingtheconnectiqstore">Opening the Connect IQ store</h3>

<p>If the user does not have your applications installed (status of
<code>NOT_INSTALLED</code>), or needs to upgrade to the latest version, you can open
the Connect IQ store directly to your application. Simply call
<code>openStore()</code> passing in a String containing the public UUID associated with your
application in the store. Note, this will not work if you are using the TETHERED
connection option.</p>

<pre><code class="java">connectIQ.openStore( MY_STORE_ID );
</code></pre>

<h2 id="sendingmessages">Sending Messages</h2>

<p>You can send messages to your Connect IQ application on a connected
device using any of the Java equivalent Monkey C data types (see
<em>Supported Data Types</em> table below). Calling <code>sendMessage()</code> will deliver
the message to your applications mailbox.</p>

<pre><code class="java">List&lt;Object&gt; message = new ArrayList&lt;String&gt;() {&quot;hello pi&quot;, 3.14159};

connectIQ.sendMessage(device, app, message, new IQSendMessageListener() {

    @Override
    public void onMessageStatus( IQDevice device, IQApp app, IQMessageStatus status ) {
        Toast.makeText( this, status.name(), Toast.LENGTH_LONG ).show();
        if (status != IQMessageStatus.SUCCESS) {
            // Evalute status for cause of the failure
        }
    }
});
</code></pre>

<h2 id="receivingmessages">Receiving Messages</h2>

<p>In order to receive data messages from a Connect IQ application, you
must first register to receive application events. Once registered via
<code>registerForAppEvents()</code>, when a new message arrives from the Connect IQ
application, it will be delivered to the <code>onMessageReceived()</code> method of
the listener passed when registering. When you no longer wish to receive
incoming messages, you should call <code>unregisterForAppEvents()</code> to release
any associated resources.</p>

<p>A companion app may register to receive messages from multiple apps across
 many devices. However, multiple companion apps cannot be registered to receive
messages from the same ConnectIQ application. The SDK will override any previous
 registrations with each call to <code>registerForAppEvents()</code>.</p>

<pre><code class="java">// Register to receive messages from our application
connectIQ.registerForAppEvents(device, app, new IQApplicationEventListener() {

    @Override
    public void onMessageReceived(IQDevice device, IQApp app, List&lt;Object&gt; messageData, IQMessageStatus status) {
        // First inspect the status to make sure this
        // was a SUCCESS. If not then the status will indicate why there
        // was an issue receiving the message from the Connect IQ application.
        if (status == IQMessageStatus.SUCCESS) {
            // Handle the message.
        }
    }
});

// unregister when we no longer care about messages coming from our app.
connectIQ.unregisterForAppEvents(device, app);
</code></pre>

<h2 id="supporteddatatypes">Supported Data Types</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Java Data Type</th>
	<th style="text-align:left;">Monkey C Type</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">int, Integer</td>
	<td style="text-align:left;">Integer</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:left;">long, Long</td>
	<td style="text-align:left;">Integer, Long</td>
	<td style="text-align:left;">If the value of the long is small enough to be represented as an integer, it will be converted to save space.</td>
</tr>
<tr>
	<td style="text-align:left;">float, Float</td>
	<td style="text-align:left;">Float</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:left;">double, Double</td>
	<td style="text-align:left;">Float, Double</td>
	<td style="text-align:left;">If the value of the double is within 5 matching significant fractional digits of the nearest float, it will be converted to a float to save space.</td>
</tr>
<tr>
	<td style="text-align:left;">boolean, Boolean</td>
	<td style="text-align:left;">Boolean</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:left;">char</td>
	<td style="text-align:left;">Char</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;"></td>
</tr>
<tr>
	<td style="text-align:left;">List&lt;?&gt;</td>
	<td style="text-align:left;">Array[]</td>
	<td style="text-align:left;">List must contain only supported data types. If the list contains unsupported data types, an exception will be thrown.</td>
</tr>
<tr>
	<td style="text-align:left;">Map&lt;?,?&gt;</td>
	<td style="text-align:left;">Dictionary</td>
	<td style="text-align:left;">Map keys and values must be supported data types. If the map contains unsupported data types, an exception will be thrown.</td>
</tr>
</tbody>
</table>

<h1 id="mobilesdkforios">Mobile SDK for iOS</h1>

<p>The Connect IQ Mobile SDK allows companion iOS applications to be created that interact with Monkey C applications running on Garmin wearable devices. This allows feature-rich user experiences to be built by retrieving remote data or offloading resource-intensive tasks from the wearable device to the iOS device. This document will guide you through adding the Mobile SDK to an iOS project, as well as introducing the SDK’s API and how to communicate with your Monkey C apps.</p>

<h2 id="configuringaprojecttousethemobilesdk">Configuring a project to use the Mobile SDK</h2>

<h3 id="addtheframeworktotheproject">Add the framework to the project</h3>

<p>The Mobile SDK for iOS is distributed as an iOS framework package and can be found at <a href="https://github.com/garmin/connectiq-companion-app-sdk-ios">Garmin GitHub repo for Connect IQ Mobile SDK</a>. To enable the framework,
 add an entry to the <code>Project &gt; Package Dependencies</code> panel. To do this, click the + at the bottom of the Packages list.</p>

<p><img src="./resources/programmers-guide/ios-image1.png" alt="Adding a framework to the iOS project" /></p>

<p>You will be presented with a dialog box to choose which package to add as dependency. In the search box enter &#8220;https://github.com/garmin/connectiq-companion-app-sdk-ios&#8221;
 <img src="./resources/programmers-guide/ios-image2.png" alt="Selecting the framework target" /><br></p>

<h3 id="embedtheconnectiqframeworkasabinary">Embed the ConnectIQ framework as a binary</h3>

<p>To allow a project to build with the Mobile SDK, embed the framework as a binary for each of the project’s targets by checking the box against each of the targets and click <code>Add Package</code>.</p>

<p><img src="./resources/programmers-guide/ios-image3.png" alt="Embedding the framework as a binary" /></p>

<h3 id="addrequiredlinkerflags">Add required linker flags</h3>

<p>The Mobile SDK for iOS utilizes category methods internally. When importing a library that uses category methods, an additional flag must be specified to allow the library to be linked correctly. To do this, add the <code>–ObjC</code> flag to the <code>Target &gt; Build Settings &gt; Linking &gt; Other Linker Flags</code> setting.</p>

<p><img src="./resources/programmers-guide/ios-image4.png" alt="Setting the linker flags for the target" /></p>

<h3 id="registeraurlscheme">Register a URL scheme</h3>

<p>Unlike the Mobile SDK for Android, apps created with the Mobile SDK for iOS are standalone apps and do not directly rely on Garmin Connect Mobile (GCM) to communicate with a wearable device. They do, however, require GCM to initially discover Connect IQ-compatible devices that are available for communication, or to install Monkey C applications on the wearable device. The companion app and GCM exchange information by launching each other via the iOS URL scheme system. To facilitate this, a URL scheme that GCM can send data to must be registered by the app. To do this, add an entry to the <code>Target &gt; Info &gt; URL Types</code> panel. A string that is not likely to collide with any other apps on the iOS device should be chosen. See the Apple documentation for more information on <a href="https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1">custom URL schemes</a>.</p>

<p><img src="./resources/programmers-guide/ios-image5.png" alt="Registering the URL scheme for the target" /></p>

<p>If you are compiling against the iOS 9 SDK or above you will need to add an entry for <code>gcm-ciq</code> to <a href="https://developer.apple.com/library/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html#//apple_ref/doc/uid/TP40009250-SW14">LSApplicationQueriesSchemes</a> in your app’s Info.plist. This is needed to ensure that the SDK can verify if GCM is installed. If this key is not present in your Info.plist it will need to be added.</p>

<p>If your project doesn&#8217;t already set <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html">CFBundleDisplayName</a> in your app’s Info.plist, you will need to add a definition. You can set this to <code>${PRODUCT_NAME}</code> if you are unsure what value to use.</p>

<h3 id="setbluetoothusagedescription">Set Bluetooth usage description</h3>

<p>Starting in iOS 10 it is required to set strings explaining the usage of BLE peripheral access. The <a href="https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW20">NSBluetoothPeripheralUsageDescription</a> key must be set in Info.plist to explain your app&#8217;s usage of BLE to be accepted by iTunes Connect. If this key is not present in your Info.plist it will need to be added.</p>

<h3 id="setbackgroundexecutionmodeoptional">Set background execution mode (optional)</h3>

<p>The iOS system allows apps that communicate with Bluetooth devices to be woken up to execute in the background when a connected device has data to send. This can be useful for companion apps that process requests for their respective Monkey C applications on a wearable device. To enable this behavior, turn on the <code>Uses Bluetooth LE accessories</code> option in the <code>Target &gt; Capabilities &gt; Background Modes</code> panel.</p>

<p><img src="./resources/programmers-guide/ios-image6.png" alt="Optionally setting the background execution mode for the target" /></p>

<h2 id="initializingthesdk-1">Initializing the SDK</h2>

<p>All interaction with the Mobile SDK is done through the <code>ConnectIQ</code> class. This class must be initialized during app startup with the project’s URL scheme and a UI override delegate. Typically this is done within the app delegate’s <code>application:didFinishLaunchingWithOptions:</code> method.</p>

<pre><code class="objective-c">[[ConnectIQ sharedInstance] initializeWithUrlScheme:@&quot;exapp-123456&quot;
                                 uiOverrideDelegate:self];
</code></pre>

<p>The URL scheme should be the same string chosen in Step 4 of <em>Configuring a project to use the Mobile SDK</em>.
When invoking a method of the <code>ConnectIQ</code> class that requires GCM to be installed and it is not present on the iOS system, by default an alert dialog will be shown to the user that allows them to go to the Apple App Store page for GCM to install it. By passing an instance of an object that conforms to the <code>IQUIOverrideDelegate</code> protocol here, custom behavior or a specialized UI may be specified in this case. To use the default alert dialog and behavior, pass <code>nil</code>.</p>

<h2 id="implementingauioverridedelegate">Implementing a UI override delegate</h2>

<p>If a UI override delegate was specified and an action was performed that requires GCM to be installed, the <code>ConnectIQ</code> class will call the <code>needsToInstallConnectMobile</code> method on that delegate. The app should inform the user that GCM is required for this action and give the user the option to open the Apple App Store page for GCM or to cancel the action that triggered it. If the user chooses to install GCM, the <code>showAppStoreForConnectMobile</code> method may be called.</p>

<pre><code class="objective-c">- (void)needsToInstallConnectMobile {
    // Show alert to user with choice to install GCM
    if (alert.result == YES) {
       [[ConnectIQ sharedInstance] showAppStoreForConnectMobile];
    }
}
</code></pre>

<p>Note that this example is synchronous, but if UI is shown to the user, the <code>showAppStoreForConnectMobile</code> method should be called as a result of user input instead of directly in the <code>needsToInstallConnectMobile</code> method.</p>

<h1 id="workingwithdevices-1">Working With Devices</h1>

<h2 id="findingconnectiq-compatibledevices-1">Finding Connect IQ-compatible devices</h2>

<p>The Mobile SDK for iOS can communicate directly with Connect IQ-compatible devices over Bluetooth. However, it must first know which devices are available. To accomplish this, a companion app must call the <code>showConnectIQDeviceSelection</code> method.</p>

<pre><code class="objective-c">[[ConnectIQ sharedInstance] showConnectIQDeviceSelection];
</code></pre>

<p>This method launches GCM to the foreground and allows the user to choose which paired Connect IQ-compatible devices to share with the companion app. If GCM is not installed and a UI override delegate was set, its <code>needsToInstallConnectMobile</code> will be called.</p>
<div id="warning">
Note that by launching GCM, this method causes the companion app to go into the background, possibly resulting in the app being suspended. <strong>The companion app should expect to be suspended when calling this method.</strong>
</div>

<p>Once the user has selected which of the paired devices to share with the companion app, GCM will launch the companion app (via its registered URL scheme), passing the list of devices as serialized URL query items. The companion app should override its app delegate’s <code>application:openURL:sourceApplication:annotation:</code> method to listen for this. The companion app may then call the <code>parseDeviceSelectionResponseFromURL:</code> method to extract the query items into an <code>NSArray</code> of <code>IQDevice</code> objects that it can use with the Mobile SDK.</p>

<pre><code class="objective-c">- (BOOL)application:(UIApplication *)application
            openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication
         annotation:(id)annotation {
    if ([url.scheme isEqualToString:ReturnURLScheme] &amp;&amp;
        [sourceApplication isEqualToString:IQGCMBundle]) {

        NSArray *devices = [[ConnectIQ sharedInstance]
                             parseDeviceSelectionResponseFromURL:url];
        if (devices != nil) {
            [self.devices removeAllObjects];
            for (IQDevice *device in devices) {
                self.devices[device.uuid] = device;
            }
            return YES;
        }
    }
    return NO;
}
</code></pre>

<p>Note that in this example, the parsed devices are stored to a dictionary for later use within the app, but are not cached in any kind of persistent storage.
<div id="warning">
To avoid needing to launch GCM excessively to discover devices, <strong>companion apps should cache devices to persistent storage.</strong>
</div>
<div id="warning">
When a list of devices is returned by GCM, companion apps should clear all previously cached references to devices they may have known about. <strong>Always use only the latest list of devices that the user has authorized.</strong>
</div></p>

<h2 id="listeningfordeviceevents-1">Listening for device events</h2>

<p>Once the companion app has one or more <code>IQDevice</code> instances from GCM, it may register with the <code>ConnectIQ</code> class to receive notifications when that device’s connection status changes by calling <code>registerForDeviceEvents:delegate:</code>.</p>

<pre><code class="objective-c">[[ConnectIQ sharedInstance] registerForDeviceEvents:device
                                           delegate:self];
</code></pre>

<p>The delegate passed in must be an instance of a class that conforms to the <code>IQDeviceEventDelegate</code> protocol. Once registered, the delegate’s <code>deviceStatusChanged:status:</code> method will be invoked when the device’s connection status changes. The <code>getDeviceStatus:</code> method may also be called to get the current connection status of the device. These methods both return a device’s status as an <code>IQDeviceStatus</code> value.
<div id="warning">
A companion app must register to receive device events before calling methods that operate on devices or apps, such as <code>getDeviceStatus:</code> or <code>sendMessage:toApp:progress:completion:</code>.
</div>
To stop listening for device events, a companion app may call either the <code>unregisterForDeviceEvents:delegate:</code> or <code>unregisterForAllDeviceEvents:</code> method.</p>

<pre><code class="objective-c">// Stop listening to a single device
[[ConnectIQ sharedInstance] unregisterForDeviceEvents:device
                                             delegate:self];
// ... or unregister all devices for this listener
[[ConnectIQ sharedInstance] unregisterForAllDeviceEvents:self];
</code></pre>

<h1 id="workingwithapps-1">Working With Apps</h1>

<h2 id="creatinganappinstance">Creating an app instance</h2>

<p>Apps are represented in the Mobile SDK as instances of the <code>IQApp</code> class. An instance of the <code>IQApp</code> class represents a single app on a single device. This means that in order to work with an app that’s installed on two different devices, a companion app will need two instances of the <code>IQApp</code> class with the same app ID, one for each device. To create an app instance, use the <code>IQApp</code> class’s <code>appWithUUID:device:</code> method.</p>

<pre><code class="objective-c">NSUUID *uuid = [[NSUUID alloc] initWithUUIDString:@”&lt;YourAppID&gt;”];
IQApp *app = [IQApp appWithUUID:uuid device:device];
</code></pre>

<h2 id="requestinganapp’sstatus">Requesting an app’s status</h2>

<p>Once an <code>IQApp</code> instance has been created that links an app ID to an <code>IQDevice</code> instance, a companion app may request the status of the app on that device by calling the <code>getAppStatus:completion:</code> method.</p>

<pre><code class="objective-c">[[ConnectIQ sharedInstance] getAppStatus:app
                              completion:^(IQAppStatus *appStatus) {
    if (appStatus != nil &amp;&amp; appStatus.isInstalled) {
        NSLog(@”App is installed! Version: %d”, appStatus.version);
    }
}];
</code></pre>

<p>This method communicates with the device over Bluetooth, and therefore is asynchronous. The completion block will be invoked when the device responds, or the request times out.
If the request is successful, the completion block will be invoked with an instance of the <code>IQAppStatus</code> class. A companion app may inspect this status to discover if the app is installed on the device, and if so, what the version of that app is. A companion app could then potentially show a UI that recommends that the user upgrade the app on the device.
If the device is not currently connected or the request times out, the completion block will be invoked with a <code>nil</code> status.</p>

<h2 id="installingupgradingormanaginganapp">Installing, upgrading, or managing an app</h2>

<p>If a companion app determines that an app is out of date or not installed, it may allow the user to install or upgrade that app by launching the Connect IQ store within GCM. To do this, simply call the <code>showConnectIQStoreForApp:</code> method.</p>

<pre><code class="objective-c">[[ConnectIQ sharedInstance] showConnectIQStoreForApp:app];
</code></pre>

<p>A companion app may also call this method even if the app is installed and up-to-date on the device, to allow the user to manage or uninstall the app from the device.
<div id="warning">
Like the <code>showConnectIQDeviceSelection</code> method, by launching GCM, this method causes the companion app to go into the background, possibly resulting in the app being suspended. <strong>The companion app should expect to be suspended when calling this method.</strong>
</div></p>

<h2 id="openinganapponthegarmindevice">Opening an app on the Garmin device</h2>

<p>A companion app can request that a CIQ app be opened on the target device. When doing so a prompt will be displayed to the user on the Garmin device to see if they app should be opened. If the user chooses to open the app then it will be immediately opened. This can be accomplished by calling the <code>openAppRequest:</code> method.</p>

<pre><code class="objective-c">[[ConnectIQ sharedInstance] openAppRequest:app
                                completion:^(IQSendMessageResult result) {
    switch(result) {
        case IQSendMessageResult_Success: NSLog(@”Popup was displayed”); break;
        case IQSendMessageResult_Failure_PromptNotDisplayed: NSLog(@”Popup was
                displayed”); break;
        case IQSendMessageResult_Failure_AppAlreadyRunning: NSLog(@”Popup was
                displayed”); break;
    }
}];
</code></pre>

<h2 id="sendingmessages-1">Sending messages</h2>

<p>Once a companion app has determined that an app is installed on a connected device, the companion app may send messages over Bluetooth to that app’s mailbox by calling the <code>sendMessage:toApp:progress:completion:</code> method. This method takes an object as a message, an <code>IQApp</code> as the destination, and two blocks &#8211; one that is invoked periodically as the data transfer progresses, and one that is invoked once the transfer is finished.</p>

<pre><code class="objective-c">NSArray *message = @[@”hello pi”, @(3.14159)];
[[ConnectIQ sharedInstance] sendMessage:message
                                  toApp:app
                               progress:^(uint32_t sent, uint32_t total) {
    float percent = 100 * sent / (float)total;
    NSLog(@&quot;%02.2f%% - %u/%u&quot;, percent, sent, total);
} completion:^(IQSendMessageResult result) {
    NSLog(@&quot;Send message finished with result %@&quot;,
        NSStringFromSendMessageResult(result));
}];
</code></pre>
<div id="warning">
The message object that is passed to this method is first converted by the SDK into a Monkey C-compatible type, and is then sent to the app’s mailbox on the device. Therefore, <strong>only Objective-C types that can be directly translated to comparable Monkey C types are valid.</strong>
</div>

<p>Valid message types include <code>NSString</code>, <code>NSNumber</code>, <code>NSArray</code>, <code>NSDictionary</code>, and <code>NSNull</code>. Take advantage of nesting other types inside an <code>NSArray</code> or <code>NSDictionary</code> to form complex messages. Values contained in <code>NSNumber</code> objects will be converted to the most appropriate Monkey C value type on the device.
<div id="warning">
Keep in mind that the wearable devices have limited memory and processing power compared to an iOS device. <strong>Messages should be as small as possible.</strong> However, sending frequent small messages can incur performance and battery life costs. Therefore, it is more desirable to send occasional large messages than it is to frequently send many tiny messages. <strong>Companion apps should aim to balance the costs of memory and performance by sending messages only when necessary and keeping message size to a minimum.</strong>
</div></p>

<h2 id="receivingmessages-1">Receiving messages</h2>

<p>A companion app may register to receive messages that are sent from an app on a device by calling the <code>registerForAppMessages:delegate:</code> method. This method takes an <code>IQApp</code> to listen for messages from, and an instance of an object that conforms to the <code>IQAppMessageDelegate</code> protocol as the listener. After registering, when a message from that app is successfully received, the <code>receivedMessage:fromApp:</code> method will be called on the listener.
To stop listening for app messages, a companion app may call either the unregisterForAppMessages:delegate: or unregisterForAllAppMessages: method.</p>

<pre><code class="objective-c">- (void)viewWillAppear:(BOOL)animated {
    [[ConnectIQ sharedInstance] registerForAppMessages:self.app delegate:self];
}

- (void)viewDidDisappear:(BOOL)animated {
    [[ConnectIQ sharedInstance] unregisterForAllAppMessages:self];
}

- (void)receivedMessage:(id)message fromApp:(IQApp *)app {
    NSLog(@&quot;Received message from app %@: '%@'&quot;, app, message);
}
</code></pre>
<div id="warning">
A companion app may register to receive messages from multiple apps across many devices. However, <strong>multiple companion apps should never register to receive messages from the same app</strong>. The nature of Bluetooth communication on iOS prevents the Mobile SDK from determining which companion app to deliver the message to. Therefore, undefined behavior will result from multiple companion apps registering to receive messages from the same app.
</div>

<p><img src="./resources/programmers-guide/ios-image8.png" alt="Mulitple watch apps can comunicate with a single phone app" />
<img src="./resources/programmers-guide/ios-image9.png" alt="A single watch app cannot communicate with multiple phone apps" /></p>

<h1 id="antandant">ANT and ANT+</h1>

<p>The Sensor module of Connect IQ gives developers access to the built-in and paired sensors of the device. Connect IQ also provides access to the available ANT channels as well. This allows developers to communicate with sensors not supported by Garmin. Using the FIT recording system those metrics can be recorded to the Activity file and uploaded to Garmin Connect.</p>

<p>Learn more about ANT and ANT+ at <a href="">thisisant.com</a></p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>API</th>
	<th>Purpose</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Ant.html"><code>Toybox.Ant</code></a></td>
	<td>Provides access to generic ANT channels. These allow direct communication between your app and an ANT device</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/AntPlus.html"><code>Toybox.AntPlus</code></a></td>
	<td>Allows access to ANT devices paired with the device.</td>
	<td>2.2.0</td>
</tr>
</tbody>
</table>

<h2 id="genericantchannels">Generic ANT Channels</h2>

<p>Connect IQ provides a low level interface for communication with ANT and ANT+ sensors. With this interface, an ANT channel can be created to send and receive ANT packets.</p>

<p>With an ANT USB dongle you can use Connect IQ ANT APIs in the Connect IQ Simulator. Note that Garmin Express will block access to the ANT USB dongle if it is running, so make sure to shut down Garmin Express when using the ANT USB dongle with the Connect IQ simulator.</p>

<h3 id="usingantstickinlinux">Using ANT stick in Linux</h3>

<p>In order to use ANT stick in Linux the usb device should be accessible to the simulator. A udev rule must be installed in the system for the ANT stick to populate with non-root privileges.</p>

<p>Find the vendor and product id for the ANT stick</p>

<pre><code class="bash">$ lsusb
</code></pre>

<p>Identify the ANT stick in the list and its vendor and product id. example:</p>

<pre><code class="bash">Bus 001 Device 009: ID 0fcf:1009 Dynastream Innovations, Inc. ANTUSB-m Stick
</code></pre>

<p>Create a udev rule for this device</p>

<pre><code class="bash">$ sudo touch /etc/udev/rules.d/50-connectiq-usbant.rules
$ sudo nano /etc/udev/rules.d/50-connectiq-usbant.rules
</code></pre>

<p>Then add the line below to the file and save the changes: CTRL-x</p>

<pre><code class="bash">ACTION==&quot;add&quot;, SUBSYSTEMS==&quot;usb&quot;, ATTRS{idVendor}==&quot;0fcf&quot;, ATTRS{idProduct}==&quot;1009&quot;, MODE=&quot;664&quot;, GROUP=&quot;plugdev&quot;
</code></pre>

<p>Restart the udev service and plug the ANT stick</p>

<pre><code class="bash">$ sudo /etc/init.d/udev restart
</code></pre>

<p>Add yourself to the &#8216;plugdev&#8217; group</p>

<pre><code class="bash">$ sudo usermod -a -G plugdev &lt;userName&gt;
</code></pre>

<h2 id="communicatingwithatempesensor">Communicating with a Tempe Sensor</h2>

<p>The Environment Profile is supported by sensors like the Garmin tempe™ wireless environment sensor and makes it possible to read the minimum, maximum and current temperature.</p>

<p>We can initialize an ANT channel to a tempe sensor with the following:</p>

<pre><code class="typescript">    // Constructor
    function initialize() {
        // Get the channel
        chanAssign = new Ant.ChannelAssignment(
            Ant.CHANNEL_TYPE_RX_NOT_TX,
            Ant.NETWORK_PLUS);
        GenericChannel.initialize(method(:onMessage), chanAssign);

        // Set the configuration
        deviceCfg = new Ant.DeviceConfig( {
            :deviceNumber =&gt; 0,                 //Wildcard our search
            :deviceType =&gt; DEVICE_TYPE,
            :transmissionType =&gt; 0,
            :messagePeriod =&gt; PERIOD,
            :radioFrequency =&gt; 57,              //Ant+ Frequency
            :searchTimeoutLowPriority =&gt; 10,    //Timeout in 25s
            :searchTimeoutHighPriority =&gt; 2,    //Timeout in 5s
            :searchThreshold =&gt; 0} );           //Pair to all transmitting sensors
        GenericChannel.setDeviceConfig(deviceCfg);

        data = new TempeData();
        searching = true;
    }

</code></pre>

<p>This code sets up the ANT channel assignment and sets device config and passes them to the base <a href="./doc/Toybox/Ant/GenericChannel.html"><code>Ant.GenericChannel</code></a> class. The device config is set to wildcard search to find any environment sensor. The initializer also sets up the <code>onMessage</code> callback to handle incoming packets.</p>

<pre><code class="typescript">    // Handle incoming information
    function onMessage(msg as Message) {
        // Parse the payload
        var payload = msg.getPayload();

        if( Ant.MSG_ID_BROADCAST_DATA == msg.messageId ) {
            if( TempeDataPage.PAGE_NUMBER == (payload[0].toNumber() &amp; 0xFF) ) {
                // Were we searching?
                if(searching) {
                    searching = false;

                    // Update our device configuration primarily to see
                    // the device number of the sensor we paired to
                    deviceCfg = GenericChannel.getDeviceConfig();
                }
                var dp = new TempeDataPage();
                dp.parse( msg.getPayload(), data );
                tempDataAvailable = true;
                // Check if the data has changed and we need to update the ui
                if( pastEventCount != data.eventCount ) {
                    pastEventCount = data.eventCount;
                }
            }
        } // end broadcast data

        else if( Ant.MSG_ID_CHANNEL_RESPONSE_EVENT == msg.messageId ) {
            if( Ant.MSG_ID_RF_EVENT == (payload[0] &amp; 0xFF) ) {
                if( Ant.MSG_CODE_EVENT_CHANNEL_CLOSED == (payload[1] &amp; 0xFF) ) {
                    open();
                }
                else if( Ant.MSG_CODE_EVENT_RX_FAIL_GO_TO_SEARCH  == (payload[1] &amp; 0xFF) ) {
                    searching = true;
                }
            }
            else{
                //It is a channel response.
            }
        } // end channel response event

    } // end on message

</code></pre>

<p>The callback handles pairing with a nearby sensor, and handing incoming packets.</p>

<p>The MO2Display sample provides a sample application that implements the Muscle Oxygen ANT profile. The ANT Generic interface is not available to watch faces. Low and high priority search timeout for sensors differs from the basic ANT radio specification to allow for interoperation with native ANT behavior on devices. These are limited to a maximum timeout of 30 seconds and 5 seconds respectively.</p>

<h2 id="burstdata">Burst Data</h2>

<p><em>Since API level 2.2.0</em></p>

<p>Burst data transmission provides a mechanism for large amounts of data to be sent between devices over an ANT Generic Channel. Developers are notified through a listener of the success/failure of burst transmit/receive events. Burst data transmission is limited to up to 8Kb of data at a time.</p>

<p>Common use cases for this include passkey authentication or sending/receiving configuration data between devices.</p>

<p>The <code>GenericChannelBurst</code> sample provides a demonstration of transmitting and receiving burst data.</p>

<h2 id="antprofiles">ANT+ Profiles</h2>

<p><em>Since API level 2.2.0</em></p>

<p>The <a href="./doc/Toybox/AntPlus.html"><code>Toybox.AntPlus</code></a> module allows access to information about ANT+ sensors that are paired to a user&#8217;s device without requiring you to set up and manage the ANT channel yourself. All management of ANT+ sensors such as adding, removing, enabling, disabling, and calibrating is managed by the user via the device&#8217;s regular sensor menus.</p>

<p>An extension of a sensor-specific listener is passed into the constructor for a sensor-specific extension of <a href="./doc/Toybox/AntPlus/Device.html"><code>AntPlus.Device</code></a>. If there is a sensor of the given type paired to the user&#8217;s device, information about that sensor can be retrieved using the sensor-specific getters, or through the common data getters such as <a href="./doc/Toybox/AntPlus/Device.html#getBatteryStatus-instance_function"><code>Device.getBatteryStatus()</code></a>. <code>null</code> can be passed in as the identifier for sensor types (like most) that do not support multi-components.</p>

<p>Callbacks in the <a href="./doc/Toybox/AntPlus/DeviceListener.html"><code>AntPlus.DeviceListener</code></a> and extensions of it will be called automatically if a sensor of the given type is paired and the corresponding information is updated via ANT. For example, <a href="./doc/Toybox/AntPlus/DeviceListener.html#onDeviceStateUpdate-instance_function"><code>DeviceListener.onDeviceStateUpdate()</code></a> will be called if a sensor&#8217;s ANT channel goes from connected to searching, or if the user switches the sensor ID of a given type that their device is connected to. Callbacks like <a href="./doc/Toybox/AntPlus/DeviceListener.html#onCalculatedPowerUpdate-instance_function"><code>DeviceListener.onCalculatedPowerUpdate()</code></a> will be called when new pieces of information about a power sensor are received via ANT.</p>

<p>Certain ANT+ sensors, such as bike lights, have special callbacks. For example, the <a href="./doc/Toybox/AntPlus/DeviceListener.html#onLightNetworkStateUpdate-instance_function"><code>DeviceListener.onLightNetworkStateUpdate()</code></a> callback should be used to understand the light network&#8217;s state rather than <a href="./doc/Toybox/AntPlus/DeviceListener.html#onDeviceStateUpdate-instance_function"><code>onDeviceStateUpdate()</code></a>. The <a href="./doc/Toybox/AntPlus/LightNetwork.html"><code>AntPlus.LightNetwork</code></a> class will allow you to make changes to bike light modes, given there are bike lights paired to the user&#8217;s device and a light network is fully formed.</p>

<p>Not all ANT+ profiles provisioned by Monkey C will be supported by every Connect IQ-compatible device.</p>

<h1 id="gettingstartedwithconnectiqbledevelopment">Getting Started with Connect IQ BLE Development</h1>
<figure>
<img src="./resources/programmers-guide/sculptor-monkey.png" style="max-width:300px;" title="It is my finest work." />
</figure>

<h2 id="resources-1">Resources</h2>

<p>When going through this guide, developers will want to keep a few things handy.</p>

<ul>
<li><p><strong>Connect IQ BLE API Documentation</strong></p>

<p>Having the <a href="./doc/Toybox/BluetoothLowEnergy.html">API Documentation</a> close by will be critical (especially in the later steps of this document).</p></li>
<li><p><strong>Nordic nRF52 DK</strong></p>

<p>The Connect IQ team has built out the Connect IQ SDK tools to be compatible with the <a href="https://www.nordicsemi.com/Software-and-Tools/Development-Kits/nRF52-DK">Nordic nRF52 DK</a> Bluetooth 5 and Bluetooth mesh Development Kit for nRF52810.</p></li>
</ul>
<!--    and nRF52832 SoCs and the Nordic [nRF52840 Dongle][dongle]. -->

<ul>
<li><p><strong>Nordic Documentation Page</strong></p>

<p>The <a href="https://www.nordicsemi.com/DocLib?Product=nRF52832%20core%20documentation&amp;tags=nRF52832%2CnRF52+DK">Nordic Documentation</a> has links to all of the resources needed to use the nRF52 DK.</p></li>
<li><p><strong>nRF Connect For Desktop</strong></p>

<p>The <a href="https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Connect-for-desktop">nRF Connect For Desktop</a> application allows developers to flash new firmware to the board, monitor connections, etc. This software is necessary to program the board to work correctly with the Connect IQ simulator.</p></li>
<li><p><strong>An up-to-date Connect IQ SDK</strong></p>

<p>To use the BLE APIs, developers should be working with the current version of the Connect IQ SDK.</p></li>
<li><p><strong>Firmware for the nRF52 DK</strong></p>

<p>The memory layout of the nRF52 DK will need to be flashed to a different firmware for use with the Connect IQ SDK. The correct firmware for the development environment has been provided:</p>

<ul>
<li><a href="https://developer.garmin.com/downloads/connect-iq/connectivity_2.0.1_115k2_with_s132_5.0.zip">nRF52 DK firmware</a></li>
<li><a href="https://developer.garmin.com/downloads/connect-iq/connectivity_1.0.0_usb_with_s132_5.1.0.zip">nRF52840 Dongle firmware</a></li>
</ul></li>
</ul>

<h2 id="windows">Windows</h2>

<p>The drivers and applications needed to communicate with the nRF52 DK are all included in the installation of <a href="https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Connect-for-desktop">nRF Connect for Desktop</a> for the Windows platform. Once this application is installed along with the necessary drivers, the nRF52 DK should be found by the nRF Connect for Desktop application.</p>

<p>At this point, proceed to the <a href="#Using-Nordic-nRF-Connect">Using Nordic nRF Connect</a> section.</p>

<h2 id="mac">Mac</h2>

<p>When using macOS, developers will need to manually install the JLink/JTrace USB drivers to communicate with the nRF52 DK board. To do so, download and install the Segger JLink installer <a href="https://www.segger.com/downloads/jlink/JLink_MacOSX_V622g.pkg">package 6.22g</a> for Mac.</p>

<p>Once this is completed, developers will need to install the <a href="https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Connect-for-desktop">nRF Connect for Desktop</a> for Mac.</p>

<p>At this point, proceed to the <a href="#Using-Nordic-nRF-Connect">Using Nordic nRF Connect</a> section.</p>

<h2 id="linux">Linux</h2>

<p>When using Linux, developers will need to manually install the JLink/JTrace USB drivers to communicate with the nRF52 DK board. To do so, download and install using the appropriate Segger JLink installer for Linux:</p>

<ul>
<li>32-bit: <a href="https://www.segger.com/downloads/jlink/JLink_Linux_V622g_i386.deb">JLink_6.22g - 32</a></li>
<li>64-bit: <a href="https://www.segger.com/downloads/jlink/JLink_Linux_V622g_x86_64.deb">JLink_6.22g - 64</a></li>
</ul>

<p>Once this is completed developers will need to install the <a href="https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Connect-for-desktop">nRF Connect for Desktop</a> for Linux.</p>
<figure>
<img src="./resources/programmers-guide/intent-launched.png" style="max-width:635px;" title="Launched Intent in the Simulator" />
</figure>

<h2 id="usingnordicnrfconnect">Using Nordic nRF Connect</h2>

<p>The nRF Connect Desktop application will need to be installed. Please see the above sections for the appropriate links.</p>

<ol>
<li>Once installed, launch the application. Click <em>Add/remove apps</em>:
<figure>
<img src="./resources/programmers-guide/nRFConnectLaunch.png" style="max-width:450px;" title="The nRF Connect Desktop Launch Screen" />
</figure></li>
<li>Install the <em>Programmer</em> app.</li>
<li>Click <em>Launch App</em>.</li>
<li>Plug in the nRF52 board.</li>
<li><em>Launch</em> the <em>Programmer</em> app.
<figure>
<img src="./resources/programmers-guide/nRFConnectProgrammerLaunch.png" style="max-width:450px;" title="Launching the Programmer App" />
</figure></li>
<li>Near the top left, click <em>Select device</em>.</li>
<li>Select the correct device.</li>
<li>Click <em>Read</em> to see the Memory Layout of the connected device.<a href="#fn:17" id="fnref:17" title="see footnote" class="footnote">[17]</a></li>
<li>Drag and drop or click <em>Add HEX file</em> to prepare the desired Memory Layout with the proper <code>.hex</code> file.
<figure>
<img src="./resources/programmers-guide/nRFConnectPrepMemoryLayout.png" style="max-width:450px;" title="Launching the Programmer App" />
</figure></li>
<li>Click <em>Erase &amp; write</em> to flash the new memory layout.
<figure>
<img src="./resources/programmers-guide/nRFConnectWriteMemoryLayout.png" style="max-width:450px;" title="Launching the Programmer App" />
</figure></li>
</ol>

<h2 id="findingthecomport">Finding The COM Port</h2>

<p>Now that the board is properly communicating with the computer, it&#8217;s time to figure out which port it&#8217;s utilizing.</p>

<h3 id="windows-1">Windows</h3>

<p>Open up Device Manager and find your device under <code>Ports</code>.</p>

<p>It will look something like this:
<figure>
<img src="./resources/programmers-guide/nRFJLinkDevMgr.png" style="max-width:450px;" title="nRF52 DK JLink in Device Manager" />
</figure></p>

<p>The communications port is listed in parentheses. In the example above the communications port is <code>COM4</code>. Copy this to be used in a later step and proceed to <a href="#setting-the-com-port">Setting the COM Port</a>.</p>

<h3 id="mac-1">Mac</h3>

<p>Open up a terminal and type:</p>

<pre><code>ls /dev/tty.usbmodem*
</code></pre>

<p>then press <code>Tab</code>. This should list out the port information in the format <code>/dev/tty.usbmodem&lt;number&gt;</code>. Copy this to be used in a later step and proceed to <a href="#setting-the-com-port">Setting the COM Port</a>.</p>

<h3 id="linux-1">Linux</h3>

<p>Open up a terminal and type:</p>

<pre><code>ls /dev/ttyACM*
</code></pre>

<p>then press <code>Tab</code>. This should list out the port information in the format <code>/dev/ttyACM&lt;number&gt;</code>. Copy this to be used in a later step and proceed to <a href="#setting-the-com-port">Setting the COM Port</a>.</p>

<h3 id="settingthecomport">Setting the COM Port</h3>

<p>At this point the nRF52 is properly communicating with the development environment and the com port information has been retrieved. The final step is to set the COM port in the Connect IQ Simulator.</p>

<ol>
<li><p>Launch the simulator via Visual Studio Code or command line tools.</p></li>
<li><p>Select <em>Settings</em> &gt; <em>BLE Settings</em></p></li>
<li><p>In the dialog box, enter the COM port information from <a href="#finding-the-com-port">Finding the COM Port</a>.
<figure>
<img src="./resources/programmers-guide/nRFSetComPortSim.png" style="max-width:450px;" title="Set the COM Port in Connect IQ Simulator"/>
</figure></p></li>
<li><p>Click <em>OK</em>.</p></li>
</ol>

<p>It&#8217;s possible that developers might encounter an error. This is likely due to a failure to set the COM Port for the Connect IQ simulator. If an error occurs, then developers have a few things they can check.</p>

<ol>
<li><strong>Double check the COM Port assignment:</strong> Follow the steps for the correct environment to <a href="#finding-the-com-port">find</a> and confirm the COM Port.</li>
<li><strong>Ensure there are no copy/paste errors:</strong> Double check the information entered when <a href="#setting-the-com-port">setting the COM Port</a>.</li>
</ol>

<p>That&#8217;s it! If all goes well, then the Connect IQ Simulator will use the nRF52 DK board BLE chipset to communicate with nearby BLE devices per the Connect IQ Bluetooth Low Energy APIs. For more information on the APIs, please refer to the <a href="https://developer.garmin.com/connect-iq/api-docs/">API documentation</a> and the <code>NordicThingy52</code> and <code>NordicThingy52CoinCollector</code> sample applications included in the Connect IQ SDK.</p>

<h1 id="sensors-1">Sensors</h1>

<p>The <a href="./doc/Toybox/Sensor.html"><code>Toybox.Sensor</code></a> module allows the app to enable and receive information from Garmin ANT+ sensors. To receive information, a listener method must be assigned and the sensors enabled:</p>

<pre><code class="typescript">function initialize() {
    Sensor.setEnabledSensors( [Sensor.SENSOR_HEARTRATE] );
    Sensor.enableSensorEvents( method( :onSensor ) );
}

function onSensor(sensorInfo as Sensor.Info) as Void {
    System.println( &quot;Heart Rate: &quot; + sensorInfo.heartRate );
}
</code></pre>

<p>Sensor information is packaged in the <a href="./doc/Toybox/Sensor/Info.html"><code>Sensor.Info</code></a> object:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Sensor Type</th>
	<th>API</th>
	<th>Units</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Accelerometer</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#accel-var"><code>Info.accel</code></a></td>
	<td>Array of x,y,z values in millig-units.</td>
	<td>1.2.0</td>
</tr>
<tr>
	<td>Altitude</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#altitude-var"><code>Info.altitude</code></a></td>
	<td>Altitude above mean sea level in meters (m).</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Cadence</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#cadence-var"><code>Info.cadence</code></a></td>
	<td>Revolutions per minute (rpm).</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Heading</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#heading-var"><code>Info.heading</code></a></td>
	<td>True north in radians.</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Heart Rate</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#heartRate-var"><code>Info.heartRate</code></a></td>
	<td>Beats per minute (bpm).</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Magnetometer</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#mag-var"><code>Info.mag</code></a></td>
	<td>Array of x,y,z values in milliGauss.<a href="#fn:18" id="fnref:18" title="see footnote" class="footnote">[18]</a></td>
	<td>1.2.0</td>
</tr>
<tr>
	<td>Oxygen Saturation</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#oxygenSaturation-var"><code>Info.oxygenSaturation</code></a></td>
	<td>The current oxygen saturation in percent (%).</td>
	<td>3.2.0</td>
</tr>
<tr>
	<td>Power</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#power-var"><code>Info.power</code></a></td>
	<td>Watts.</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Pressure</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#pressure-var"><code>Info.pressure</code></a></td>
	<td>The barometric pressure in Pascals.<a href="#fn:19" id="fnref:19" title="see footnote" class="footnote">[19]</a></td>
	<td>1.0.0</td>
</tr>
<tr>
	<td>Temperature</td>
	<td><a href="./doc/Toybox/Sensor/Info.html#temperature-var"><code>Info.temperature</code></a></td>
	<td>Degrees Celsius (C).</td>
	<td>1.0.0</td>
</tr>
</tbody>
</table>

<p>The simulator can simulate sensor data via the <em>Simulation</em> menu by selecting <em>Fit Data</em> &gt; <em>Simulate Data</em>. This generates valid but random values that can be read in via the sensor interface. For more accurate simulation, the simulator can play back a FIT file and feed the input into the <a href="./doc/Toybox/Sensor.html"><code>Sensor</code></a> module. To do this, select <em>Simulation</em> &gt; <em>Fit Data</em> &gt; <em>Playback File</em> and choose a FIT file from the dialog.</p>

<p>For more, see the <code>AccelMag</code> and <code>Sensor</code> sample apps distributed with the SDK.</p>

<h2 id="highfrequencydata">High Frequency Data</h2>

<p><em>Since API level 2.3.0</em></p>

<p>The <a href="./doc/Toybox/Sensor.html"><code>Toybox.Sensor</code></a> module contains the ability to fetch samples of accelerometer data for a defined period of time with a certain frequency. This feature enables developers to implement their own custom motion detection algorithms within a Connect IQ application.</p>

<p>Accelerometer data can be obtained by registering a sensor data listener, which provides sampling parameters as well as a user-defined callback method that will be executed when new data is available. Sensor data requests are managed via the following <a href="./doc/Toybox/Sensor.html"><code>Sensor</code></a> module methods and classes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Class or Function</th>
	<th>Purpose</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Sensor/SensorData.html"><code>Sensor.SensorData</code></a></td>
	<td>Wrapper for high frequency sensor data</td>
	<td>2.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Sensor/AccelerometerData.html"><code>Sensor.AccelerometerData</code></a></td>
	<td>Wrapper for accelerometer information</td>
	<td>2.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Sensor/GyroscopeData.html"><code>Sensor.GyroscopeData</code></a></td>
	<td>Wrapper for gyroscope information</td>
	<td>3.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Sensor/MagnetometerData.html"><code>Sensor.MagnetometerData</code></a></td>
	<td>Wrapper for magnetometer information</td>
	<td>3.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Sensor.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a></td>
	<td>Register a callback to fetch data from various sensors</td>
	<td>2.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Sensor.html#unregisterSensorDataListener-instance_function"><code>Sensor.unregisterSensorDataListener()</code></a></td>
	<td>Deregister a previously registered data request</td>
	<td>2.3.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Sensor.html#getMaxSampleRate-instance_function"><code>Sensor.getMaxSampleRate()</code></a></td>
	<td>Get the maximum sample rate supported by the system</td>
	<td>2.3.0</td>
</tr>
</tbody>
</table>

<p>Calling <a href="./doc/Toybox/Sensor.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a> will enable your application to receive accelerometer data via the callback that you provide. The type and amount of data provided is configured via the options dictionary parameter, which supports the following fields:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Option</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>:period</code></td>
	<td style="text-align:left;">A <a href="./doc/Toybox/Lang/Number.html"><code>Number</code></a> representing the period of time to request samples in seconds. Maximum is 4 seconds.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:sampleRate</code></td>
	<td style="text-align:left;">A <a href="./doc/Toybox/Lang/Number.html"><code>Number</code></a> representing the samples per second in Hz. Use <a href="./doc/Toybox/Sensor.html#getMaxSampleRate-instance_function"><code>getMaxSampleRate()</code></a> to determine what the system can support.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:accelerometer</code></td>
	<td style="text-align:left;">Options for the accelerometer (see below)</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:heartBeatIntervals</code></td>
	<td style="text-align:left;">Options for beat to beat intervals (see below)</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:gyroscope</code></td>
	<td style="text-align:left;">Options for beat to beat intervals (see below)</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:magnetometer</code></td>
	<td style="text-align:left;">Options for beat to beat intervals (see below)</td>
</tr>
</tbody>
</table>

<p>The <code>:accelerometer</code>, <code>:heartBeatIntervals</code>, <code>:gyroscope</code>, and <code>:magnetometer</code> options allow the following:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Option</th>
	<th style="text-align:left;">Applicable To</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>:enabled</code></td>
	<td style="text-align:left;"><code>:accelerometer</code>, <code>:heartBeatIntervals</code>, <code>:gyroscope</code>, <code>:magnetometer</code></td>
	<td style="text-align:left;">Set to <code>true</code> to enable the sensor</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:sampleRate</code></td>
	<td style="text-align:left;"><code>:accelerometer</code>, <code>:gyroscope</code>, <code>:magnetometer</code></td>
	<td style="text-align:left;">A <a href="./doc/Toybox/Lang/Number.html"><code>Number</code></a> representing the samples per second in Hz. Use <code>getMaxSampleRate()</code> to determine what the system can support.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:includePower</code></td>
	<td style="text-align:left;"><code>:accelerometer</code></td>
	<td style="text-align:left;">Requests that the power array be computed. Default false</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:includePitch</code></td>
	<td style="text-align:left;"><code>:accelerometer</code></td>
	<td style="text-align:left;">Requests that pitch array be computed. Default false</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:includeRoll</code></td>
	<td style="text-align:left;"><code>:accelerometer</code></td>
	<td style="text-align:left;">Requests that roll array be computed. Default false</td>
</tr>
</tbody>
</table>

<p>Additionally, you must provide a callback method that accepts a single parameter, which is invoked by the system when new data is available. This method is passed a <a href="./doc/Toybox/Sensor/SensorData.html"><code>SensorData</code></a> object populated with the requested sensor data. Note that only a single sensor data request can be active at any given time, so if you wish to submit a request while an existing one is active, you must first call <a href="./doc/Toybox/Sensor.html#unregisterSensorDataListener-instance_function"><code>Sensor.unregisterSensorDataListener()</code></a>. After <a href="./doc/Toybox/Sensor.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a> is called, the callback that you provided will be invoked whenever a new set of samples are available. For example, if you request four seconds worth of data at 25Hz, the callback will be invoked every 100 samples taken.</p>

<p>A simplified usage example can be found below:</p>

<pre><code class="typescript">
using Toybox.Sensor;

class MyAccelHistoryClass
{
    private var _samplesX = null;
    private var _samplesY = null;
    private var _samplesZ = null;

    // Initializes the view and registers for accelerometer data
    public function enableAccel() as Void {
        var maxSampleRate = Sensor.getMaxSampleRate();

         // initialize accelerometer to request the maximum amount of data possible
        var options = {:period =&gt; 4000, :sampleRate =&gt; maxSampleRate, :enableAccelerometer =&gt; true};
        try {
            Sensor.registerSensorDataListener(method(:accelHistoryCallback), options);
        }
        catch(e) {
            System.println(e.getErrorMessage());
        }
    }

    // Prints acclerometer data that is recevied from the system
    public function accelHistoryCallback(sensorData as SensorData) as Void {
        _samplesX = sensorData.accelerometerData.x;
        _samplesY = sensorData.accelerometerData.y;
        _samplesZ = sensorData.accelerometerData.z;

        System.println(&quot;Raw samples, X axis: &quot; + _samplesX);
        System.println(&quot;Raw samples, Y axis: &quot; + _samplesY);
        System.println(&quot;Raw samples, Z axis: &quot; + _samplesZ);
    }

    public function disableAccel() as Void {
        Sensor.unregisterSensorDataListener();
    }
}

</code></pre>

<p>For more, see the <code>PitchCounter</code> sample app distributed with the SDK.</p>

<h3 id="filteringaccelerometerdata">Filtering Accelerometer Data</h3>

<p>When processing accelerometer data, you may wish to apply filters to the raw sensor input that your application receives. IIR and FIR filter objects are provided to aid the developer in sample filtering. The following new objects have been added to the Math module:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Class</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Math/FirFilter.html"><code>Math.FirFilter</code></a></td>
	<td style="text-align:left;">Create a FIR filter that can be applied to a sample array</td>
	<td style="text-align:left;">2.3.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Math/IirFilter.html"><code>Math.IirFilter</code></a></td>
	<td style="text-align:left;">Create a IIR filter that can be applied to a sample array</td>
	<td style="text-align:left;">2.3.0</td>
</tr>
</tbody>
</table>

<p>Each filter class requires coefficients to be provided, which is done via the dictionary parameter. The options supported by each filter class are as follows:</p>

<p><strong>FIR Filter</strong></p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Option</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>:coefficients</code></td>
	<td style="text-align:left;">An array of float values that specify the filter coefficients. This can also be a resource ID referring to an embedded JSON resource that defines the array of values.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:gain</code></td>
	<td style="text-align:left;">A float value that specifies a multiplier to be applied to the coefficients.</td>
</tr>
</tbody>
</table>

<p><strong>IIR Filter</strong></p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Option</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>:coefficientList1</code></td>
	<td style="text-align:left;">An array of float values that specify the filter coefficients. This can also be a resource ID referring to an embedded JSON resource that defines the array of values.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:coefficientList2</code></td>
	<td style="text-align:left;">An array of float values that specify the filter coefficients. This can also be a resource ID referring to an embedded JSON resource that defines the array of values.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>:gain</code></td>
	<td style="text-align:left;">A float value that specifies a multiplier to be applied to the coefficients.</td>
</tr>
</tbody>
</table>

<p>Once the filter object has been constructed, the apply function can be called, passing in an array of samples, and an array containing the filtered results will be returned.</p>

<p>A simplified usage example can be found below (for a more detailed sample see the <code>PitchCounter</code> sample app distributed with the SDK).</p>

<pre><code class="typescript">using Toybox.Sensor;

class MyAccelHistoryClass
{
    hidden var mFilter = null;
    hidden var mSamplesX = null;
    hidden var mSamplesY = null;
    hidden var mSamplesZ = null;

    function initialize() {
        mFilter = new Sensor.FirFilter({:coefficients=&gt;[0.22,0.12,0.55], :gain=&gt;1.2);
    }
    // Initializes the view and registers for accelerometer data
    function enableAccel() {
        var maxSampleRate = Sensor.getMaxSampleRate();

         // initialize accelerometer to request the maximum amount of data possible
        var options = {:period =&gt; 4000, :sampleRate =&gt; maxSampleRate, :enableAccelerometer =&gt; true};
        try {
            Sensor.registerSensorDataListener(method(:accelHistoryCallback), options);
        }
        catch(e) {
            System.println(e.getErrorMessage());
        }
    }

    // Prints acclerometer data that is recevied from the system
    function accelHistoryCallback(sensorData) {
        mSamplesX = mFilter.apply(sensorData.accelerometerData.x);
        mSamplesY = sensorData.accelerometerData.y;
        mSamplesZ = sensorData.accelerometerData.z;

        Toybox.System.println(&quot;Filtered samples, X axis: &quot; + mSamplesX);
        Toybox.System.println(&quot;Raw samples, Y axis: &quot; + mSamplesY);
        Toybox.System.println(&quot;Raw samples, Z axis: &quot; + mSamplesZ);
    }

    function disableAccel() {
        Sensor.unregisterSensorDataListener();
    }
}
</code></pre>

<h3 id="loggingaccelerometerdata">Logging Accelerometer Data</h3>

<p>Accelerometer data can also be logged by the device, and can be played back in the simulator for testing applications that use the Accelerometer Data feature. Logging accelerometer data is done by passing a <a href="./doc/Toybox/SensorLogging/SensorLogger.html"><code>SensorLogging.SensorLogger</code></a> object to a FIT recording session.</p>

<p>The <a href="./doc/Toybox/SensorLogging/SensorLogger.html"><code>SensorLogger</code></a> object with the same options provided to the <a href="./doc/Toybox/Sensor.html#registerSensorDataListener-instance_function"><code>Sensor.registerSensorDataListener()</code></a> method. However, the logger will always record at a standard rate for consumption by the simulator.</p>

<p>A simplified usage example can be found below (for a more detailed sample see the <code>samples/PitchCounter</code> sample app distributed with the SDK).</p>

<pre><code class="java">import Toybox.SensorLogging;

class LoggingController {
    private var _logger as SensorLogger;
    private var _session as Session;

    public function initialize() {
        _logger = new SensorLogging.SensorLogger({:enableAccelerometer =&gt; true});
        _session = Fit.createSession({:name=&gt;&quot;mySession&quot;, :sport=&gt;Fit.SPORT_GENERIC, :sensorLogger =&gt; mLogger});
    }

    public function startLogging() {
        _session.start();
    }

    public function stopLogging() {
        _session.stop();
    }

    public function saveLogging() {
        _session.save();
    }
}

</code></pre>

<h2 id="weather">Weather</h2>

<p><em>Since API level 3.2.0</em></p>

<p>Many Garmin devices have access to current weather conditions that are updated every 15 minutes. This information requires that the device has access to a data connection, primarily via a paired smartphone. Weather information is not available in all areas of the world.</p>

<p>Connect IQ provides the following ways to access this information:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Function</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Weather.html#getCurrentConditions-instance_function"><code>Weather.getCurrentConditions()</code></a></td>
	<td style="text-align:left;">Get the most recently cached weather conditions</td>
	<td style="text-align:left;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Weather.html#getDailyForecast-instance_function"><code>Weather.getDailyForecast()</code></a></td>
	<td style="text-align:left;">Get the daily forecast</td>
	<td style="text-align:left;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Weather.html#getHourlyForecast-instance_function"><code>Weather.getHourlyForecast()</code></a></td>
	<td style="text-align:left;">Get the hourly forecast</td>
	<td style="text-align:left;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Weather.html#getSunrise-instance_function"><code>Weather.getSunrise()</code></a></td>
	<td style="text-align:left;">Get the sunrise for a given location</td>
	<td style="text-align:left;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Weather.html#getSunset-instance_function"><code>Weather.getSunset()</code></a></td>
	<td style="text-align:left;">Get the sunset for a given location</td>
	<td style="text-align:left;">3.3.0</td>
</tr>
</tbody>
</table>

<p>Be aware that the user is allowed to choose a specific location for weather updates besides their current location. You cannot assume that the weather conditions returned are the weather conditions for your current location.</p>

<h1 id="positioning">Positioning</h1>
<figure>
<img src="./resources/programmers-guide/archy-monkey.png" style="max-width:300px;" title="Geocache Jones remembered to stop at three movies." />
</figure>

<p>Monkey C provides access to the wearable&#8217;s available sensors, which may include the GPS, altimeter, thermometer, and supported ANT sensors.</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>API</th>
	<th>Purpose</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Position/Location.html"><code>Position.Location</code></a></td>
	<td>Abstraction of a coordinate</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Position.html#enableLocationEvents-instance_function"><code>Position.enableLocationEvents()</code></a></td>
	<td>Allows enabling the GPS and receiving location update events to a callback.Requires the <code>Position</code> permission.</td>
	<td>1.0.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Position.html#getInfo-instance_function"><code>Position.getInfo()</code></a></td>
	<td>Query the position information from the system</td>
	<td>1.0.0</td>
</tr>
</tbody>
</table>

<h2 id="location">Location</h2>

<p>A <a href="./doc/Toybox/Position/Location.html"><code>Position.Location</code></a> is an abstraction of a coordinate. It exposes the ability to retrieve the coordinates in radians or decimal degrees and then provides a method to convert to coordinate formats supported by the Garmin system. The <a href="./doc/Toybox/Position.html"><code>Toybox.Position</code></a> module also exposes string parsing interface to convert from various coordinate formats to a <a href="./doc/Toybox/Position/Location.html"><code>Location</code></a> object.</p>
<!-- TODO: Talk about the difference between a position and a location -->

<h2 id="locationevents">Location Events</h2>

<p>To enable the GPS call the <a href="./doc/Toybox/Position.html#enableLocationEvents-instance_function"><code>Position.enableLocationEvents()</code></a> method. To register a position listener, use the <a href="./doc/Toybox/Object.html#method-instance_function"><code>Object.method()</code></a> call to create a <a href="./doc/Toybox/Lang/Method.html"><code>Lang.Method</code></a> callback:</p>

<pre><code class="java">function onPosition( info as Position.Info ) as Void {
    Sys.println( &quot;Position &quot; + info.position.toGeoString( Position.GEO_DM ) );
}

function initializeListener() as Void {
    Position.enableLocationEvents( Position.LOCATION_CONTINUOUS, method( :onPosition ) );
}
</code></pre>

<p>All of the location information will be sent in an <a href="./doc/Toybox/Position/Info.html"><code>Position.Info</code></a> object. You can also use <a href="./doc/Toybox/Position.html#getInfo-instance_function"><code>Position.getInfo()</code></a> to retrieve an <a href="./doc/Toybox/Position/Info.html"><code>Info</code></a> instance.</p>

<p>For more, see the <code>PositionSample</code> sample app distributed with the SDK.</p>

<h3 id="multi-band">Multi-Band</h3>

<p>There are times where you may want control over what positioning solution is used. The <code>:configuration</code> option of <a href="./doc/Toybox/Position.html#enableLocationEvents-instance_function"><code>Position.enableLocationEvents()</code></a> allows you to specify the which positioning solution you wish to use:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Configuration</th>
	<th style="text-align:left;">GPS Solution</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS</code></a></td>
	<td style="text-align:left;">GPS L1</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS_GLONAS</code></a></td>
	<td style="text-align:left;">GPS L1, GLONASS</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS_GALILEO</code></a></td>
	<td style="text-align:left;">GPS L1, GALILEO L1</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS_BEIDOU</code></a></td>
	<td style="text-align:left;">GPS L1, BEIDOU L1</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS_GLONASS_GALILEO_BEIDOU_L1</code></a></td>
	<td style="text-align:left;">GPS L1, GLONASS, GALILEO L1, BEIDOU L1</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS_GLONASS_GALILEO_BEIDOU_L1</code></a></td>
	<td style="text-align:left;">GPS L1, GLONASS, GALILEO L1, BEIDOU L1</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_GPS_GLONASS_GALILEO_BEIDOU_L1_L5</code></a></td>
	<td style="text-align:left;">GPS L1, GLONASS, GALILEO L1, BEIDOU L1, GPS L5, GALILEO L5, BEIDOU L5</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/Position/Configuration-.htmlmodule"><code>CONFIGURATION_SAT_IQ</code></a></td>
	<td style="text-align:left;">Solution chosen dynamically for optimum power usage</td>
	<td style="text-align:left;">3.3.6</td>
</tr>
</tbody>
</table>

<p>Not every device supports every GPS configuration. You can use <a href="./doc/Toybox/Position.html#hasConfigurationSupport-instance_function"><code>Position.hasConfigurationSupport()</code></a> to determine if the device supports a specific configuration.</p>

<h1 id="activityrecording">Activity Recording</h1>

<p>Imagine that you are trying to create a yoga app. You&#8217;d like the app to record heart rate and calories burned during your yoga workout, just like other Garmin apps. You&#8217;d also like the recording to be displayed on <a href="https://connect.garmin.com">Garmin Connect</a>. Monkey C allows for apps to start and stop recording of FIT files. Controlling the FIT file recording requires a few steps:</p>

<ol>
<li>Enable the sensors to be recorded</li>
<li>Use <a href="./doc/Toybox/ActivityRecording.html#createSession-instance_function"><code>ActivityRecording.createSession()</code></a> to create a session object</li>
<li>Use the <a href="./doc/Toybox/ActivityRecording/Session.html#start-instance_function"><code>Session.start()</code></a> method of the FIT session to begin recording. Data from the enabled sensors will be recorded into the FIT file.</li>
<li>Use <a href="./doc/Toybox/ActivityRecording/Session.html#stop-instance_function"><code>Session.stop()</code></a> to pause the recording</li>
<li>Use <a href="./doc/Toybox/ActivityRecording/Session.html#save-instance_function"><code>Session.save()</code></a> to save the recording, or <a href="./doc/Toybox/ActivityRecording/Session.html#discard-instance_function"><code>Session.discard()</code></a> to delete the recording</li>
</ol>

<p>The FIT file will sync with <a href="https://connect.garmin.com">Garmin Connect</a>. You can use the <a href="https://developer.garmin.com/gc-developer-program/overview/">Garmin Connect Developer Program</a> to process the FIT file from a web service.</p>

<p>For more, see the <code>RecordSample</code> sample app distributed with the SDK.</p>

<h2 id="recordingfitfiles">Recording FIT Files</h2>

<p>In addition to being able to play back existing FIT files, the simulator can also record files using data obtained via the <em>Fit Data</em>&gt;<em>Simulate Data</em> menu option. To begin recording a session you must start the timer; this can be done via the <em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Start Activity</em> menu option, or by clicking the corresponding start button on the device you have selected. The following table describes the different options available for activity recording and provides instructions for how to access them via the menu bar, or the device buttons (where available).</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Option</th>
	<th style="text-align:left;">Menu Button</th>
	<th style="text-align:left;">Device Button</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Start Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Start Activity</em></td>
	<td style="text-align:left;">Start Button</td>
	<td style="text-align:left;">The device start button starts and stops an activity.</td>
</tr>
<tr>
	<td style="text-align:left;">Stop Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Stop Activity</em></td>
	<td style="text-align:left;">Start Button</td>
	<td style="text-align:left;">The device start button starts and stops an activity, and the <em>Start Activity</em> menu item is renamed to <em>Stop Activity</em> when recording is active.</td>
</tr>
<tr>
	<td style="text-align:left;">Lap Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Lap Activity</em></td>
	<td style="text-align:left;">Back Button</td>
	<td style="text-align:left;">Records a lap record in the FIT file.</td>
</tr>
<tr>
	<td style="text-align:left;">Pause Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Pause Activity</em></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Pauses activity recording. Note this option is only available when FIT data simulation is enabled.</td>
</tr>
<tr>
	<td style="text-align:left;">Resume Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Resume Activity</em></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Resumes activity recording. Note this option is only available when FIT data simulation is enabled and activity recording is paused.</td>
</tr>
<tr>
	<td style="text-align:left;">Discard Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Discard Activity</em></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Discards the current recording and deletes the corresponding .fit file. Note this is only enabled if activity recording has been started and subsequently stopped.</td>
</tr>
<tr>
	<td style="text-align:left;">Save Activity</td>
	<td style="text-align:left;"><em>Data Fields</em>&gt;<em>Timer</em>&gt;<em>Save Activity</em></td>
	<td style="text-align:left;">N/A</td>
	<td style="text-align:left;">Saves the recorded activity into a .fit file and resets the timer state. Note this is only enabled if activity recording has been started and subsequently stopped.</td>
</tr>
</tbody>
</table>

<p>Note: the device simulator will not automatically start activity recording when a data field is being run. You must explicitly start and stop activity recording via the menu options described here.</p>

<h2 id="fitdeveloperfields">FIT Developer Fields</h2>

<p>Now imagine you want to add a new metric - Namastes - to the Yoga app<a href="#fn:20" id="fnref:20" title="see footnote" class="footnote">[20]</a>. This metric will combine heart rate, accelerometer, and other sensor data into a single value, and does not have an analog in any Garmin recording metric. To do this we need the <a href="./doc/Toybox/FitContributor.html"><code>Toybox.FitContributor</code></a> module, which allows you to add new metrics to a FIT recording and display it on <a href="https://connect.garmin.com">Garmin Connect</a>.</p>

<p>First, you must enable the <a href="./doc/Toybox/FitContributor.html"><code>FitContributor</code></a> permission in the manifest file (see the <a href="./CoreTopics.html#manifestandpermissions">Manifest and Permissions</a> section for more information). Next, you need to add your field definitions in your resources using the <code>fitContributions</code> block:</p>

<pre><code class="xml">    &lt;strings&gt;
        &lt;string id=&quot;namaste_label&quot;&gt;Namastes&lt;/string&gt;
        &lt;string id=&quot;namaste_graph_label&quot;&gt;Namastes&lt;/string&gt;
        &lt;string id=&quot;namaste_units&quot;&gt;N(s)&lt;/string&gt;
    &lt;/strings&gt;
    &lt;fitContributions&gt;
        &lt;fitField id=&quot;0&quot; displayInChart=&quot;true&quot; sortOrder = &quot;0&quot; precision=&quot;2&quot;
        chartTitle=&quot;@Strings.namaste_graph_label&quot; dataLabel=&quot;@Strings.namaste_label&quot;
        unitLabel=&quot;@Strings.namaste_units&quot; fillColor=&quot;#FF0000&quot; /&gt;
    &lt;/fitContributions&gt;
</code></pre>

<p>The <code>fitField</code> block has a number of configurable options:</p>

<table>
<colgroup>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:center;">Attribute</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:left;">Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:center;"><code>id</code></td>
	<td style="text-align:left;">A numeric value from 0 to 255 used to refer to your field</td>
	<td style="text-align:left;">No duplicates within an app are allowed</td>
</tr>
<tr>
	<td style="text-align:center;"><code>displayInChart</code></td>
	<td style="text-align:left;">Indicates whether or not record level connect IQ data should be rendered in a chart</td>
	<td style="text-align:left;"><code>true</code> if you want this entry to be displayed as a chart, <code>false</code> otherwise. Graph fields can only support numeric data.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>displayInActivityLaps</code></td>
	<td style="text-align:left;">Indicates whether or not lap level connect IQ data should be rendered in the Activity Laps section in the Garmin Connect Activity Details page</td>
	<td style="text-align:left;"><code>true</code> if you want this entry to be displayed in the activity laps, <code>false</code> otherwise</td>
</tr>
<tr>
	<td style="text-align:center;"><code>displayInActivitySummary</code></td>
	<td style="text-align:left;">Indicates whether or not activity (fit session) level connect IQ data should be rendered in the Activity Summary section in the Garmin Connect Activity Details page</td>
	<td style="text-align:left;"><code>true</code> if you want this entry to be displayed in the activity summary data, <code>false</code> otherwise</td>
</tr>
<tr>
	<td style="text-align:center;"><code>sortOrder</code></td>
	<td style="text-align:left;">Determines the order in which the Connect IQ data will appear in the Summary or Lap Sections of the Activity Details page and what order charts will be displayed on the Activity Details page</td>
	<td style="text-align:left;">No duplicates are allowed</td>
</tr>
<tr>
	<td style="text-align:center;"><code>precision</code></td>
	<td style="text-align:left;">Decimal point precision for numeric data</td>
	<td style="text-align:left;">0 for integer, 1 for one decimal point, 2 for two decimal points. Without this attribute the default is no rounding</td>
</tr>
<tr>
	<td style="text-align:center;"><code>chartTitle</code></td>
	<td style="text-align:left;">This is the resources string key to use to render the title of the chart</td>
	<td style="text-align:left;">Optional if <code>displayInChart</code> is <code>false</code>. Must be a string resource.</td>
</tr>
<tr>
	<td style="text-align:center;"><code>dataLabel</code></td>
	<td style="text-align:left;">This is the resources string key to use to render the label of the data field in the Activity Summary or Activity Laps section of the Activity Details page (ex. Cadence, or Heart Rate).</td>
	<td style="text-align:left;">Must be a string resource</td>
</tr>
<tr>
	<td style="text-align:center;"><code>unitLabel</code></td>
	<td style="text-align:left;">This is the key to use to render the unit of the data field in the Activity Summary or Activity Laps section of the Activity Details page (ex. kph, or miles).</td>
	<td style="text-align:left;">Must be a string resource</td>
</tr>
<tr>
	<td style="text-align:center;"><code>fillColor</code></td>
	<td style="text-align:left;">RRGGBB value of color to use for chart</td>
	<td style="text-align:left;">Optional if <code>displayInChart</code> is <code>false</code></td>
</tr>
</tbody>
</table>

<p>This will communicate the metadata to display our chart to <a href="https://connect.garmin.com">Garmin Connect</a>. Now we need to create our Field in the code. You do this by using the <a href="./doc/Toybox/ActivityRecording/Session.html#createField-instance_function"><code>Session.createField()</code></a> method of the <a href="./doc/Toybox/ActivityRecording/Session.html"><code>Session</code></a> object within your source:</p>

<pre><code class="java">// Field ID from resources.
const NAMASTE_FIELD_ID = 0;
hidden var mNamasteField;

// Initializes the new Namaste field in the activity file
function setupField(session as Session) {
    // Create a new field in the session.
    // Current namastes provides an file internal definition of the field
    // Field id _must_ match the fitField id in resources or your data will not display!
    // The field type specifies the kind of data we are going to store. For Record data this must be numeric, for others it can also be a string.
    // The mesgType allows us to say what kind of FIT record we are writing.
    //    FitContributor.MESG_TYPE_RECORD for graph information
    //    FitContributor.MESG_TYPE_LAP for lap information
    //    FitContributor.MESG_TYPE_SESSION` for summary information.
    // Units provides a file internal units field.
    mNamasteField = session.createField(&quot;current_namastes&quot;, NAMASTE_FIELD_ID, FitContributor.DATA_TYPE_FLOAT, { :mesgType=&gt;Fit.MESG_TYPE_RECORD, :units=&gt;&quot;N&quot; });
}
</code></pre>

<p>Now when you call <a href="./doc/Toybox/ActivityRecording/Session.html#setData-instance_function"><code>Session.setData()</code></a> on <code>mNamasteField</code> the value will be recorded into either the Record, Lap, or Session information of the FIT file based on the message type specified when calling <a href="./doc/Toybox/ActivityRecording/Session.html#createField-instance_function"><code>createField()</code></a>. If you are creating a Record (graph), you should update this value once a second. For lap and summary, you should provide constant updates to the current lap or workout value for the metric.</p>

<p>After setting this up, you will want to preview how this will look on <a href="https://connect.garmin.com">Garmin Connect</a>. We can use the Monkey graph tool to create a preview. The <a href="./ReferenceGuides.html#usingthemonkeygraphtool">Monkey graph tool</a> requires the following: a FIT file with the recorded developer data, and an IQ file of the app (you can acquire an IQ file via the <a href="./CoreTopics.html#publishingtotheconnectiqstore">App Export Wizard</a>. The tool will allow you to test how charts will look before uploading your app for review. See how to launch the Monkey graph tool included with the SDK.</p>

<h1 id="quantifyinguserinformation">Quantifying User Information</h1>

<p>Garmin devices collect and quantify numerous metrics about the user<a href="#fn:21" id="fnref:21" title="see footnote" class="footnote">[21]</a>. Connect IQ exposes many of the collected metrics so they can be incorporated into your solutions.</p>

<p>The <a href="./doc/Toybox/ActivityMonitor.html"><code>Toybox.ActivityMonitor</code></a> and <a href="./doc/Toybox/SensorHistory.html"><code>Toybox.SensorHistory</code></a> modules allow apps to access the activity tracking, wellness features, and historical sensor information of Garmin wearable devices.</p>

<h2 id="userprofile">User Profile</h2>

<p>The <a href="./doc/Toybox/UserProfile.html"><code>Toybox.UserProfile</code></a> provides access to personal information about the user, including their gender, birth year, height, weight, and athletic metrics like VO2 Max and activity class. It requires the <code>UserProfile</code> permission to access.</p>

<p>The <a href="./doc/Toybox/UserProfile.html#getProfile-instance_function"><code>UserProfile.getProfile()</code></a> call returns a <a href="./doc/Toybox/UserProfile/Profile.html"><code>UserProfile.Profile</code></a> object, which provides</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Metric</th>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Activity Class</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#activityClass-var"><code>Profile.activityClass</code></a></td>
	<td style="text-align:left;">A quantification of how active the user from 0 to 100</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Average Resting Heart Rate</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#averageRestingHeartRate-var"><code>Profile.averageRestingHeartRate</code></a></td>
	<td style="text-align:left;">The user&#8217;s seven day average resting heart rate (bpm)</td>
	<td style="text-align:center;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Biological Sex</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#gender-var"><code>Profile.gender</code></a></td>
	<td style="text-align:left;">The user&#8217;s biological gender</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Birth Year</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#birthYear-var"><code>Profile.birthYear</code></a></td>
	<td style="text-align:left;">The year the user was born</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Cycling VO2 Max</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#vo2maxCycling-var"><code>Profile.vo2maxCycling</code></a></td>
	<td style="text-align:left;">The user&#8217;s VO2 Max value for a cycling activity</td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Height</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#height-var"><code>Profile.height</code></a></td>
	<td style="text-align:left;">The user&#8217;s height in centimeters (cm)</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Resting Heart Rate</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#restingHeartRate-var"><code>Profile.restingHeartRate</code></a></td>
	<td style="text-align:left;">The user&#8217;s current resting heart rate in beats per minute (bpm)</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Running Step Length</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#runningStepLength-var"><code>Profile.runningStepLength</code></a></td>
	<td style="text-align:left;">The user&#8217;s running step length in millimeters (mm)</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Running VO2 Max</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#vo2maxRunning-var"><code>Profile.vo2maxRunning</code></a></td>
	<td style="text-align:left;">The user&#8217;s VO2 Max value for a running activity</td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Sleep Time</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#sleepTime-var"><code>Profile.sleepTime</code></a></td>
	<td style="text-align:left;">Typical sleep time as configured by the user</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Wake Time</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile/Profile.html#wakeTime-var"><code>Profile.wakeTime</code></a></td>
	<td style="text-align:left;">Typical wake time as configured by the user</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
</tbody>
</table>

<p><a href="./doc/Toybox/UserProfile.html"><code>UserProfile</code></a> provides access to the additional data:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Information</th>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Activity History</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile.html#getUserActivityHistory-instance_function"><code>UserProfile.getUserActivityHistory()</code></a></td>
	<td style="text-align:left;">Record of the activities the user has done</td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Heart Rate Zones</td>
	<td style="text-align:left;"><a href="./doc/Toybox/UserProfile.html#getHeartRateZones-instance_function"><code>UserProfile.getHeartRateZones()</code></a></td>
	<td style="text-align:left;">The user&#8217;s defined heart rate zones for running, cycling, or swimming</td>
	<td style="text-align:center;">1.2.6</td>
</tr>
</tbody>
</table>

<h2 id="activitymonitoring">Activity Monitoring</h2>

<p><a href="./doc/Toybox/ActivityMonitor.html"><code>ActivityMonitor</code></a> provides access to the current day&#8217;s metrics via <a href="./doc/Toybox/ActivityMonitor.html#getInfo-instance_function"><code>ActivityMonitor.getInfo()</code></a> which returns a <a href="./doc/Toybox/ActivityMonitor/Info.html"><code>ActivityMonitor.Info</code></a> object.</p>

<p>You can also get a daily history of some of these metrics with <a href="./doc/Toybox/ActivityMonitor.html#getHistory-instance_function"><code>ActivityMonitor.getHistory()</code></a> which returns an array of <a href="./doc/Toybox/ActivityMonitor/History.html"><code>ActivityMonitor.History</code></a> objects. How far back this history goes can vary by device as well as how long the device has been turned on, but a seven day history is fairly typical.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Metric</th>
	<th style="text-align:left;">API</th>
	<th style="text-align:left;">Value</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Calories Burned</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#calories-var"><code>Info.calories</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#calories-var"><code>History.calories</code></a></td>
	<td style="text-align:left;">The calories burned so far for the current day in kilocalories (kCal)</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Daily Active Minutes</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#activeMinutesDay-var"><code>Info.activeMinutesDay</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#activeMinutes-var"><code>History.activeMinutes</code></a></td>
	<td style="text-align:left;">The number of active minutes for the current day</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Distance Traveled<a href="#fn:22" id="fnref:22" title="see footnote" class="footnote">[22]</a></td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#distance-var"><code>Info.distance</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#distance-var"><code>History.distance</code></a></td>
	<td style="text-align:left;">The distance traveled since midnight of the current day in centimeters (cm)</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Floors Climbed</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#floorsClimbed-var"><code>Info.floorsClimbed</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#floorsClimbed-var"><code>History.floorsClimbed</code></a></td>
	<td style="text-align:left;">The number of floors climbed for the current day</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Floors Climbed Goal</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#floorsClimbedGoal-var"><code>Info.floorsClimbedGoal</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#floorsClimbedGoal-var"><code>History.floorsClimbedGoal</code></a></td>
	<td style="text-align:left;">The goal the user has set for the number of floors climbed in a day</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Floors Descended</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#floorsDescended-var"><code>Info.floorsDescended</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#floorsDescended-var"><code>History.floorsDescended</code></a></td>
	<td style="text-align:left;">The number of floors descended for the current day</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Meters Climbed</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#metersClimbed-var"><code>Info.metersClimbed</code></a></td>
	<td style="text-align:left;">The vertical distance of floors climbed in meters (m)</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Meters Descended</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#metersDescended-var"><code>Info.metersDescended</code></a></td>
	<td style="text-align:left;">The vertical distance of floors descended in meters (m)</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="https://support.garmin.com/en-US/?faq=JwIMwaMTTV0t7r0mvkdA08">Move Bar</a> Level</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#moveBarLevel-var"><code>Info.moveBarLevel</code></a></td>
	<td style="text-align:left;">The current level of the move bar between MOVE_BAR_LEVEL_MIN and MOVE_BAR_LEVEL_MAX</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Respiration Rate</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#respirationRate-var"><code>Info.respirationRate</code></a></td>
	<td style="text-align:left;">Current respiration rate for the user, in breaths per minute</td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Steps</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#steps-var"><code>Info.steps</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#steps-var"><code>History.steps</code></a></td>
	<td style="text-align:left;">The step count since midnight of the current day in number of steps</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Step Goal</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#stepGoal-var"><code>Info.stepGoal</code></a>, <a href="./doc/Toybox/ActivityMonitor/History.html#stepGoal-var"><code>History.stepGoal</code></a></td>
	<td style="text-align:left;">The step goal for the current day in number of steps</td>
	<td style="text-align:center;">1.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Stress</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#stressScore-var"><code>Info.stressScore</code></a></td>
	<td style="text-align:left;">The current stress score based on the last 30 seconds</td>
	<td style="text-align:center;">5.0.0</td>
</tr>
<tr>
	<td style="text-align:left;">Time to Recovery</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#timeToRecovery-var"><code>Info.timeToRecovery</code></a></td>
	<td style="text-align:left;">Time to recovery from the last activity, in hours</td>
	<td style="text-align:center;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;">Weekly Active Minutes</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#activeMinutesWeek-var"><code>Info.activeMinutesWeek</code></a></td>
	<td style="text-align:left;">The number of active minutes for the current week</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Weekly Active Minutes Goal</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#activeMinutesWeekGoal-var"><code>Info.activeMinutesWeekGoal</code></a></td>
	<td style="text-align:left;">The user&#8217;s goal number of weekly active minutes</td>
	<td style="text-align:center;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;">Wheelchair Pushes</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#pushes-var"><code>Info.pushes</code></a></td>
	<td style="text-align:left;">The user&#8217;s number of wheelchair pushes</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">Wheelchair Pushes Goal</td>
	<td style="text-align:left;"><a href="./doc/Toybox/ActivityMonitor/Info.html#pushesGoal-var"><code>Info.pushesGoal</code></a></td>
	<td style="text-align:left;">The user&#8217;s goal number of wheelchair pushes</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<p>When wheelchair mode is enabled, <a href="./doc/Toybox/ActivityMonitor/Info.html"><code>ActivityMonitor.Info</code></a> will have zeroes for <a href="./doc/Toybox/ActivityMonitor/Info.html#steps-var"><code>steps</code></a>, <a href="./doc/Toybox/ActivityMonitor/Info.html#stepGoal-var"><code>stepGoal</code></a>, <a href="./doc/Toybox/ActivityMonitor/Info.html#floorsClimbed-var"><code>floorsClimbed</code></a>, <a href="./doc/Toybox/ActivityMonitor/Info.html#floorsDescended-var"><code>floorsDescended</code></a> and <a href="./doc/Toybox/ActivityMonitor/Info.html#floorsClimbedGoal-var"><code>Info.floorsClimbedGoal</code></a> and will instead have values in <a href="./doc/Toybox/ActivityMonitor/Info.html#pushes-var"><code>pushes</code></a> and <a href="./doc/Toybox/ActivityMonitor/Info.html#pushesGoal-var"><code>pushesGoal</code></a>.</p>

<h2 id="sensorhistory">Sensor History</h2>

<p><em>Since API level 2.1.0</em></p>

<p>The <a href="./doc/Toybox/SensorHistory.html"><code>Toybox.SensorHistory</code></a> module allows the app to access saved sensor history on the device. Data from sensors can be accessed by getting an iterator.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Function</th>
	<th style="text-align:left;">Purpose</th>
	<th style="text-align:left;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getBodyBatteryHistory-instance_function"><code>SensorHistory.getBodyBatteryHistory()</code></a></td>
	<td style="text-align:left;">Get the user&#8217;s body battery samples as recorded over the previous hours on the device. This does not have access to synced data.</td>
	<td style="text-align:left;">3.3.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getHeartRateHistory-instance_function"><code>SensorHistory.getHeartRateHistory()</code></a></td>
	<td style="text-align:left;">Get the user&#8217;s heart rate samples as recorded over the previous hours on the device. This does not have access to synced data.</td>
	<td style="text-align:left;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getTemperatureHistory-instance_function"><code>SensorHistory.getTemperatureHistory()</code></a></td>
	<td style="text-align:left;">Get the temperature as recorded over the previous hours on the device. This does not have access to synced data.</td>
	<td style="text-align:left;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getPressureHistory-instance_function"><code>SensorHistory.getPressureHistory()</code></a></td>
	<td style="text-align:left;">Get the barometric pressure as recorded over the previous hours on the device. This does not have access to synced data.</td>
	<td style="text-align:left;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getElevationHistory-instance_function"><code>SensorHistory.getElevationHistory()</code></a></td>
	<td style="text-align:left;">Get the distance from sea level as recorded over the previous hours on the device. This does not have access to synced data.</td>
	<td style="text-align:left;">2.1.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getOxygenSaturationHistory-instance_function"><code>SensorHistory.getOxygenSaturationHistory()</code></a></td>
	<td style="text-align:left;">Get the user&#8217;s SpO2 as recorded over the previous hours on the device. This does not have access to synced data. Depends on if user has enabled MO2 recording.</td>
	<td style="text-align:left;">3.2.0</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="./doc/Toybox/SensorHistory.html#getStressHistory-instance_function"><code>SensorHistory.getStressHistory()</code></a></td>
	<td style="text-align:left;">Get the user&#8217;s stress as recorded over the previous hours on the device. This does not have access to synced data.</td>
	<td style="text-align:left;">3.3.0</td>
</tr>
</tbody>
</table>

<p>Not all <a href="./doc/Toybox/SensorHistory.html"><code>SensorHistory</code></a> types are available on all devices. Capabilities should be validated using the <code>has</code> operator. The get functions will return a <a href="./doc/Toybox/SensorHistory/SensorHistoryIterator.html"><code>SensorHistory.SensorHistoryIterator</code></a> type.</p>

<p>Calling the <a href="./doc/Toybox/SensorHistory/SensorHistoryIterator.html#next-instance_function"><code>SensorHistoryIterator.next()</code></a> function will iterate through the history values until the end of the data is reached. When there is no more data the iterator will return null. There are no guarantees on the sample interval or that the requested range will be available.</p>

<p>This function returns a <a href="./doc/Toybox/SensorHistory/SensorSample.html"><code>SensorSample</code></a> object. The iterator can be adjusted to provide the newest data values first or the oldest values first by using the enumeration values <a href="./doc/Toybox/SensorHistory.html#Order-module"><code>ORDER_NEWEST_FIRST</code></a> and <a href="./doc/Toybox/SensorHistory.html#Order-module"><code>ORDER_OLDEST_FIRST</code></a></p>

<h1 id="complications">Complications</h1>

<p>Garmin devices collect numerous data points as users wear them. Many of these data points can be summarized and displayed on the watch face as a <a href="https://en.wikipedia.org/wiki/Complication_(horology)">complication</a>. The Connect IQ SDK offers multiple APIs to access user metrics, and has expanded the offerings with every release.</p>

<p>The <a href="./doc/Toybox/Complications.html"><code>Toybox.Complications</code></a> module consolidates the specific metrics typically displayed by Garmin devices into a unified interface. This unified interface gives the developer access to the information typically shown on the watch face for the developer. The complications are exposed using a publish/subscribe model.</p>

<p>In addition, device app and audio content provider developers can now publish up to four complications using this new framework. Complications have public, protected, and private visibility levels with the system.</p>

<p>Finally, Face It will also be a consumer of Connect IQ complications. This allows developers to create information that can be published on Face It watch faces.</p>

<h2 id="publishersandsubscribers">Publishers and Subscribers</h2>

<figure>
<img src="./resources/programmers-guide/complication_publishers_and_subscribers.png" alt="" />
</figure>

<p>At the heart of the complications system is a publisher/subscriber system. The system publishes complication data for subscribers to consume. Connect IQ device apps and audio content providers can publish complication data, but only watch faces can subscribe to complication information.</p>

<h3 id="complicationobjects">Complication Objects</h3>

<p>Data is published as a <a href="./doc/Toybox/Complications/Complication.html"><code>Complications.Complication</code></a> object. The complication object exposes the following information:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Identifier</th>
	<th>Description</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#complicationId-var"><code>complicationId</code></a></td>
	<td>A unique identifier for the type of data being published of type <a href="./doc/Toybox/Complications/Id.html"><code>Complications.Id</code></a></td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#longLabel-var"><code>longLabel</code></a></td>
	<td>A textual name for the complication. The long label is intended for display in a configuration menu.</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#ranges-var"><code>ranges</code></a></td>
	<td>An optional array of numeric values. Ranges allow breakdowns of sets of values that can be integrated into the display.</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#shortLabel-var"><code>shortLabel</code></a></td>
	<td>A five-character string intended to summarize your complication as a radial complication.</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#unit-var"><code>unit</code></a></td>
	<td>The units to use with the value. If this is <code>null</code> then the unit shouldn&#8217;t be displayed. If this is a <code>UNIT</code> identifier, the <code>value</code> is expected to be in a specific unit for conversion. If the <code>unit</code> is a string, the <code>value</code> should be interpreted without conversion.</td>
	<td><code>4.2.0</code></td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#value-var"><code>value</code></a></td>
	<td>A string or numeric value describing the value to be displayed to the user</td>
	<td><code>4.2.0</code></td>
</tr>
</tbody>
</table>

<p>You can query additional information with these accessors:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Method</th>
	<th>Description</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#getIcon-instance_function"><code>Complication.getIcon()</code></a></td>
	<td>For Connect IQ complications, query the icon provided by the app</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/Complication.html#getType-instance_function"><code>Complication.getType()</code></a></td>
	<td>For native complications, returns the <code>COMPLICATION_TYPE</code>. Will return <code>COMPLICATION_TYPE_INVALID</code> for Connect IQ complications.</td>
	<td>4.2.0</td>
</tr>
</tbody>
</table>

<h3 id="units">Units</h3>

<p>Complications are allowed to publish information in units that are configurable by the user in their system settings. When receiving complication values, it is the subscriber&#8217;s role to convert the value to the metric specified in system settings.</p>

<p>Units should be expected to be published as the following:</p>

<table>
<colgroup>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Unit</th>
	<th>Expected Value</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>Complications.UNIT_DISTANCE</code></td>
	<td>Meters</td>
</tr>
<tr>
	<td><code>Complications.UNIT_ELEVATION</code></td>
	<td>Meters</td>
</tr>
<tr>
	<td><code>Complications.UNIT_HEIGHT</code></td>
	<td>Meters</td>
</tr>
<tr>
	<td><code>Complications.UNIT_SPEED</code></td>
	<td>Meters per second</td>
</tr>
<tr>
	<td><code>Complications.UNIT_TEMPERATURE</code></td>
	<td>Degrees Celsius</td>
</tr>
<tr>
	<td><code>Complications.UNIT_WEIGHT</code></td>
	<td>Grams</td>
</tr>
</tbody>
</table>

<h2 id="subscribingtocomplications">Subscribing to Complications</h2>

<p>To publish a complication you need to add the <code>ComplicationSubscriber</code> permission to your manifest file. Subscribing to Complications requires the <a href="./doc/Toybox/Complications/Complication/Id.html"><code>Id</code></a>. You can use <a href="./doc/Toybox/Complications.html#getComplications-instance_function"><code>Complications.getComplications()</code></a> to query the identifiers of all complications supported by the system:</p>

<pre><code class="typescript">// get an iterator over complications available to this app
void iter = Complications.getComplications();
// iterate over them
var complicationId = iter.next();

while (complicationId != null) {
    var complication =
       Complications.getComplication(complicationId);
    complicationId = iter.next();
}
</code></pre>

<p>You can also query a native complication directly by constructing a <a href="./doc/Toybox/Complications/Complication/Id.html"><code>Id</code></a> explicitly:</p>

<pre><code class="typescript">var complication = Complications.getComplication(
    new Id(Complications.COMPLICATION_TYPE_CALORIES)
);
</code></pre>

<p>This only works for native complications. Once you have the complication id, you can persist the id in storage for later use.</p>

<p>You can use <a href="./doc/Toybox/Complications.html#registerComplicationChangeCallback-instance_function"><code>Complications.registerComplicationChangeCallback()</code></a> to subscribe to multiple complication values. All subscriptions are terminated when your app shuts down and must be re-done when your app is launched. When you subscribe, you register a callback to be called when the value updates:</p>

<pre><code class="typescript">function onStart(params as Dictionary) as Void {
    // Retrieve persisted Complication ID
    mComplicationId = Storage.getValue(COMPLICATION_ID_KEY);

    // Register a callback for receiving
    // updates on complication information
    Complications.registerComplicationChangeCallback(
        self.method(:onComplicationChanged));

    // Liking and subscribing
    Complications.subscribeToUpdates(mComplicationId);
}
</code></pre>

<p>In your callback, you can then query the updated information and process it:</p>

<pre><code class="typescript">function onComplicationChanged(
    complicationId as Complication.Id) as Void {
    // Identify the complication being updated
    if (complicationId == mComplicationId) {
        // Get the complication information
        try {
            var data = Complications.getComplication(
                complicationId);
            // Handle the application processing
            updateData(complicationId, data);
        } catch (e instanceof ComplicationNotFoundException) {
            handleComplicationRemoval(complicationId);
        }
    }
}
</code></pre>

<p>If the complication is no longer available, for example the user has uninstalled the publishing app, the system will throw a <a href="./doc/Toybox/Complications/ComplicationNotFoundException.html"><code>ComplicationNotFoundException</code></a>. You should trap this exception and handle it within your app. If a publishing app is uninstalled, the system will send an event to your <code>ComplicationChangeCallback</code> and automatically unsubscribe your app from any subscribed complications.</p>

<p>When wheelchair mode is enabled, <code>COMPLICATION_TYPE_STEPS</code> and <code>COMPLICATION_TYPE_FLOORS_CLIMBED</code> are replaced with <code>COMPLICATION_TYPE_WHEELCHAIR_PUSHES</code>.</p>

<h3 id="holdtolaunch">Hold to Launch</h3>

<p>Some Connect IQ products have a feature where pressing and holding on a complication launches the associated app. You can add this functionality to your watch face by implementing the <a href="./doc/Toybox/WatchUi/WatchFaceDelegate.html#onPress-instance_function"><code>WatchFaceDelegate.onPress()</code></a> method:</p>

<pre><code class="typescript">function onPress(clickEvent as ClickEvent) as Boolean {
    if ((mComplicationId != null) &amp;&amp;
         isClickInside(clickEvent, mBoundingBox)) {

        // launch the app that published the
        // complication
        try {
            Complications.exitTo(mComplicationId);
            return true;
        } catch (e instanceof AppNotInstalledException) {
            // fall through
        }
    }

    return false;
}
</code></pre>

<h2 id="publishingcomplications">Publishing Complications</h2>

<p>If you are developing a device or audio content provider apps, you can publish up to four complications to the framework. To publish a complication you need to add the <code>ComplicationPublisher</code> permission to your manifest file.</p>

<h3 id="resources-2">Resources</h3>

<p>To publish a complication, you have to define each complication in your resources:</p>

<pre><code class="xml">&lt;complications&gt;
    &lt;complication id=&quot;0&quot; access=&quot;public&quot;
                  longLabel=&quot;@Strings.myLongLabel&quot;
                  shortLabel=&quot;@Strings.myShortLabel&quot;
                  icon=&quot;@Drawables.MyComplication&quot;
                  glancePreview=&quot;true&quot;&gt;
        &lt;faceIt defaultText=&quot;@Strings.complicationName&quot; /&gt;
        &lt;range&gt;
            &lt;value&gt;0&lt;/value&gt;
            &lt;value&gt;24&lt;/value&gt;
            &lt;value&gt;33&lt;/value&gt;
            &lt;value&gt;41&lt;/value&gt;
            &lt;value&gt;50&lt;/value&gt;
            &lt;value&gt;53&lt;/value&gt;
        &lt;/range&gt;
    &lt;/complication&gt;
&lt;/complications&gt;
</code></pre>

<p>The <code>complication</code> element has the following attributes:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Description</th>
	<th>Required</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>id</code></td>
	<td>Numerical identifier from 0 - 255. Keep this value stable across versions. Changing this value between versions will impact apps consuming your complication when your app updates.</td>
	<td>Yes</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><code>access</code></td>
	<td><code>public</code>, <code>protected</code>, or <code>private</code></td>
	<td>Yes</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><code>longLabel</code></td>
	<td>A descriptive title for your complication value.</td>
	<td>Yes</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><code>shortLabel</code></td>
	<td>A short string for apps that are displaying your complication as a radial complication.</td>
	<td>No</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><code>icon</code></td>
	<td>A resource identifier for the icon you want to associate with this complication. The specified resource must be an <code>svg</code> if your access is <code>public</code> or <code>protected</code>. The icon cannot be changed at runtime.</td>
	<td>Yes</td>
	<td>4.2.0</td>
</tr>
<tr>
	<td><code>glancePreview</code></td>
	<td>A Boolean value. When users place your glance into a glance folder, you can identify one of your complications to be used as the preview value. Only one of your complications can be demarked as a preview.</td>
	<td>No</td>
	<td>4.2.0</td>
</tr>
</tbody>
</table>

<p>Using the <code>access</code> attribute, you can control if your complications are visible to just apps with your developer key, all apps, and Face It or all of the above:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Access</th>
	<th style="text-align:center;">Your Apps</th>
	<th style="text-align:center;">Face It</th>
	<th style="text-align:center;">All Apps</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>public</code></td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;">X</td>
</tr>
<tr>
	<td style="text-align:left;"><code>protected</code></td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;"></td>
</tr>
<tr>
	<td style="text-align:left;"><code>private</code></td>
	<td style="text-align:center;">X</td>
	<td style="text-align:center;"></td>
	<td style="text-align:center;"></td>
</tr>
</tbody>
</table>

<p>The required <code>faceIt</code> element allows you to provide information for Face it:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Attribute</th>
	<th>Description</th>
	<th>Required</th>
	<th>API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>defaultText</code></td>
	<td>This will be shown in Face It as the name of the complication.</td>
	<td>Yes</td>
	<td>4.2.0</td>
</tr>
</tbody>
</table>

<p>The optional <code>range</code> element allows you to provide an ordered set of numeric values that define different ranges for your value.</p>

<h2 id="publishingvalues">Publishing Values</h2>

<p>Once your complication is defined, you can use the <a href="./doc/Toybox/Complications.html#updateComplication-instance_function"><code>Complications.updateComplication()</code></a> function to publish data:</p>

<pre><code class="typescript">var data = {
    // String, Number, Float, Long, Double, or null
    :value =&gt; newValue,

    // String
    :shortLabel =&gt; newShortLabel,

    // String or Complication.UNITS_* value
    :units =&gt; newUnits,

    // Array&lt;Numeric&gt; with at least 3 elements
    :ranges =&gt; newRanges,
}

// update complication
// 0 is the id of the complication
// from complications.xml
Complications.updateComplication(0, data);
</code></pre>

<h2 id="faceitcomplications">Face It Complications</h2>

<p>Publishing a complication as <code>public</code> allows Face It to integrate your complication. It will always display your complication icon, and will use the following rules to display your complication value:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>If units are&#8230;</th>
	<th>&#8230;then value is expected to be&#8230;</th>
	<th>&#8230;and will be displayed as&#8230;</th>
</tr>
</thead>

<tbody>
<tr>
	<td><code>Complications.UNIT</code> type besides <code>UNIT_INVALID</code></td>
	<td>A numerical value</td>
	<td>A numerical value converted from the default units defined for the unit type to the system units with the appropriate unit abbreviation.</td>
</tr>
<tr>
	<td>String</td>
	<td>A numerical value</td>
	<td>A numerical value with the string units appended.</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Complications/UNIT_.htmlINVALID"><code>Complications.UNIT_INVALID</code></a> or <code>null</code></td>
	<td>A numerical or string value</td>
	<td>A numerical or string value will be displayed without conversion and without any units appended.</td>
</tr>
</tbody>
</table>

<p>Some best practices:
* Make sure your Face It icon is high contrast and will appear well in both light and dark mode in mobile.
* Use Latin characters (A-Z, a-z, 0&#8211;9) for published complication strings.</p>

<h1 id="shareablelibraries">Shareable Libraries</h1>

<p>Developers can create custom Monkey C libraries, called Monkey Barrels, that contain source code and resource information that are easily shared across Connect IQ Projects.</p>

<p>Monkey Barrels provide an easy way to store and reuse common code and resources that developers find useful. For example, many developers want a quick way to calculate time to sunrise or sunset. With Monkey Barrels, developers can store this code along with other common code and pull it into their various projects when useful. This saves time and effort allowing developers the ability to have maximum creativity.</p>

<h2 id="makingamonkeybarrel">Making a Monkey Barrel</h2>

<p>From Visual Studio Code, Barrels can be created as a new project type:</p>

<ol>
<li>Use <em>Ctrl + Shift + P</em> (<em>Command + Shift + P</em> on the Mac) to summon the command palette</li>
<li>Type &#8220;New Project&#8221; and select <em>Monkey C: New Project</em></li>
<li>When prompted with <em>Set Project Name</em>, enter a name for your new project</li>
<li>Select the project type <em>Monkey Barrel</em></li>
<li>Select the minimum API level</li>
<li>Set the parent directory for your new project</li>
</ol>

<p>Once the project is created, you can edit your supported products and permissions in the <em>manifest.xml</em>. See <a href="./ConnectIQBasics.html#editingthesupportedproducts">Editing the Supported Products</a> for more information. A specific check is in place to ensure that developers cannot have a Barrel with the name &#8220;Toybox&#8221;. The Barrel has now been created&mdash;now it&#8217;s time to fill it!</p>

<p>Developers can think of Barrels as custom modules. In fact this is exactly how they should be set up:</p>

<pre><code class="c++">module FooBarrel {

    (:Bars)           // Notice the annotations above the submodule names
    module Bars {
        // Create a counter var for the &quot;Current Bars&quot;
        var currentBars = 0;

        // Draw a &quot;Bar&quot;
        function drawBar() {
           // . . . draw a super awesome &quot;Bar&quot;
           return Bar;
        }

        // Increment the Bar counter
        function addBar(currentBars) {
           bars = currentBars;
           bars ++;
           return bars;
        }

        // Get the current Bars
        function getCurrentBars() {
            return currentBars;
        }
    }

    (:BarsToo)        // Notice this here too
    module BarsToo {
        function fancyBars() {
            // . . . Do a fancy thing
            return somethingFancy;
        }
    }

    (:Empty)          // An empty annotation
    module Empty {

        // A sub-module without an annotation
        module AlsoEmpty {
        }
    }

    // This module throws an error
    module throwsError {
    }
}
</code></pre>

<p>Developers can use annotations to denote sub-modules within their Barrels. Sub-modules with annotations (i.e. the <code>(:Bars)</code> annotation above) allow developers to import certain sections of code without importing the entire Barrel. If a module directly below the namespace is found at compile time that is not decorated with an annotation, a warning will be generated. A module lacking an annotation that is found within a module decorated with an annotation will also generate a warning (i.e. <code>AlsoEmpty</code> module above). See <a href="#howtoincludebarrels">How to Include Barrels</a> for more information on how to include Barrels and specific annotations.</p>

<p>Annotations must also be configured in the manifest for the Barrel project:</p>

<ol>
<li>Double click the Barrel <code>manfest.xml</code></li>
<li>Summon the command palette and run the <em>Monkey C: Edit Annotations</em> command</li>
<li>Select <em>Add Annotation</em></li>
<li>Input your annotation name</li>
</ol>

<p>The annotations will be available to use in the Barrel project.</p>

<p>Barrels can also include resources. Resources are created and held within a Barrel in the same format as a regular application and are defined in XML format. See the <a href="#resourcecompiler">Resource Compiler</a> section of the Programmer&#8217;s Guide for more info on resources.</p>

<p>The compiler will build the resource module as a sub-module of the Barrel&#8217;s module. For example, in a Barrel called, <code>IconLibrary</code> the module will look like this:</p>

<pre><code class="c++">IconLibrary {                       // Barrel Level
    Rez {                           // Rez Level
        Drawables {                 // Drawables Level
            var myIcon = 123;       // Resource
        }
    }
}
</code></pre>

<p>Developers can reference resources within a Barrel by using the following syntax:</p>

<pre><code class="c++">@IconLibrary.Drawables.myIcon
</code></pre>

<p>This makes it easy for developers to pull those resources into their projects without any changes. All files utilized by a Barrel must live in the Barrel project&#8217;s root directory, determined by the directory of the manifest.xml file, as importing files external to the project is not supported.</p>

<h2 id="barrelsandversions">Barrels and Versions</h2>

<p>Each Barrel has a unique version ID number. This follows the same numbering system as The Connect IQ SDK (<code>Major.Minor.Micro.Quailifier</code> or <code>#.#.#.X</code>). The version qualifier can only be comprised of letters, numbers, and underscores.</p>

<h2 id="exportingamonkeybarrel">Exporting a Monkey Barrel</h2>

<p>Monkey Barrels are packaged by the Monkey C compiler in order to satisfy a basic syntactical check of the source code.
<strong>Note:</strong> While Barrels provide the mechanism of code libraries, they contain all of the unmodified source of your Barrel project.</p>

<p>Do the following to export your Monkey Barrel:</p>

<ol>
<li>Make sure the manifest file specifies all products supported by the app</li>
<li>Use the <em>Monkey C: Export Project</em> command to generate an <code>.barrel</code> file.</li>
</ol>

<p>If there are no errors ,the barrel is ready to use!</p>

<h2 id="howtoincludebarrels">How to Include Barrels</h2>

<p>In order to use a Barrel, developers will need to add it to the current project. This can be done through the Visual Studio Code extension or by manually editing a project&#8217;s Jungle and manifest file.</p>

<h3 id="addingbarrelstoaprojectwithvisualstudiocode">Adding Barrels to a Project with Visual Studio Code</h3>

<p>Developers can add new Barrels to their project through the command palette:</p>

<ol>
<li>Use the <em>Monkey C: Configure Monkey Barrel</em> command</li>
<li>Select <em>Add Monkey Barrel</em></li>
<li>Select if you want to add it as a precompiled <code>.barrel</code> file or as a link to the barrel project</li>
<li>Select the precompiled <code>.barrel</code> file or the Monkey Barrel project <code>.jungle</code> file, depending on the previous selection</li>
</ol>

<p>The Barrels and their specified annotations will be added to the default Barrel Jungle file automatically. The manifest file will also be updated with those Barrel dependencies.</p>
<div class="note">See the <a href="./CoreTopics.html#buildconfiguration">Build Configuration</a> section to see how to deal with Barrels in Jungle configuration files directly.</div>

<p>Once this is done, the selected Barrels will be added to your project.</p>

<h2 id="usingmonkeybarrels">Using Monkey Barrels</h2>

<p>Once they have been added to a project, using Barrels is straight forward and simple. It is not necessary for Developers to import Barrels into source files with the <code>using</code> statement, however they will need a using statement if they choose to use aliases for them:</p>

<pre><code class="c++">// This is a normal Toybox &quot;using&quot; statment
using Toybox.System;

// This sets up an alias for a &quot;submodule&quot; within a barrel
using FooBarrel.Bars as Bars;
</code></pre>

<p>At this point, the alias has been set up and the Barrel code has been made available in the project.</p>

<pre><code class="c++">// This is a normal Connect IQ call
System.println(&quot;Cool Bars&quot;);

// This is a general Barrels call (No using statment needed)
FooBarrel.BarsToo.fancyBars();

// This is a specific Barrels call (Alias)
var globalBars = Bars.getCurrentBars();

// This is a call to use a resource held in a Barrel
var icon = UserInterface.loadResource(IconLibrary.Rez.Drawables.myIcon)
</code></pre>

<h2 id="runnoevilandmonkeybarrels">Run No Evil and Monkey Barrels</h2>

<p>Barrels can be used in conjunction with the Run No Evil testing framework to test discrete sections of code. For more information on the Run No Evil testing framework developers can reference the <a href="./CoreTopics.html#unittesting">Run No Evil</a> documentation.</p>

<ol>
<li>Right click on the Barrel project root folder</li>
<li>Select <em>Run Tests</em></li>
</ol>

<p>The Barrel code with the correct testing annotations (See <a href="./CoreTopics.html#unittesting">Run No Evil</a> documentation), will be tested in the Run No Evil testing framework.</p>

<h2 id="barrelsinthecommandline">Barrels In The Command Line</h2>

<p>Barrels can be compiled and tested via the command line.</p>

<dl>
<dt><code>barrelbuild</code></dt>
<dd>Calls the Monkey C Barrel compiler. Much like <code>monkeyc</code> the <code>barrelbuild</code> call takes code from multiple files to be included in the library (.barrel file). The <code>-f</code> argument is required as the manifest file path is specified in one of the Barrel&#8217;s Jungle files. For more info, run <code>barrelbuild</code> without any arguments to see a full list of argument definitions.</dd>
</dl>

<pre><code>&gt; barrelbuild -o &lt;output.barrel&gt; -f &lt;barrel.jungle&gt;
</code></pre>

<dl>
<dt><code>barreltest</code></dt>
<dd>Executes Run No Evil tests on the <code>.barrel</code> file. Requires the <code>-d</code> argument with a valid device id.</dd>
</dl>

<pre><code>&gt; barreltest -o &lt;output.barrel&gt; -f &lt;barrel.jungle&gt; -d &lt;device_id&gt;
</code></pre>

<p>The Connect IQ team has provided a few useful example Barrels for developers to try. To use these Barrels, go to the Garmin Connect IQ <a href="https://github.com/garmin/connectiq-apps">GitHub repository</a>. Clone or download the desired Barrels and add them to the project using one of the previously discussed methods.</p>

<h1 id="testinganddebugging">Testing and Debugging</h1>
<figure>
<img src="./resources/programmers-guide/chopper-monkey.png" style="max-width:300px;" title="Gotta look this world in the eye, gotta live this life till you die" />
</figure>

<p>Connect IQ has a couple of different methods for testing and debugging your apps:</p>

<ol>
<li>Basic debugging with <code>println()</code> statements</li>
<li>Using the Visual Studio Code debugger</li>
<li>Using the command line debugger (<code>mdd</code>)</li>
</ol>

<h2 id="basicdebugging">Basic Debugging</h2>

<p>One way to test Connect IQ apps is to include <a href="./doc/Toybox/System.html#println-instance_function"><code>System.println()</code></a> statements at strategic points in your app. Within Visual Studio Code, these <a href="./doc/Toybox/System.html#println-instance_function"><code>println()</code></a> statements will output to the console. On a device, <a href="./doc/Toybox/System.html#println-instance_function"><code>println()</code></a> statements write to an <code>&lt;APPNAME&gt;.TXT file</code> in the <code>/GARMIN/APPS/LOGS</code> directory in the device file system.</p>

<p>These log files are not automatically created, so they must be manually created on the device and named to match the name of the app&#8217;s corresponding <code>PRG</code> file. For example, to log output from <code>/GARMIN/APPS/MYAPP.PRG</code>, you must create <code>/GARMIN/APPS/LOGS/MYAPP.TXT</code>.</p>

<h2 id="debuggingwithvisualstudiocode">Debugging with Visual Studio Code</h2>

<p>To begin debugging your application select <em>Run &gt; Start Debugging</em>. Make sure you have a source file from the project you wish to debug open in the editor. After selecting the product you want to debug, the app will launch in debug mode in the simulator. Debugging is only supported while running an application on the Connect IQ simulator.</p>

<h3 id="settingabreakpoint">Setting a Breakpoint</h3>

<p>Like other projects in Visual Studio Code, to set a breakpoint in the Monkey C editor, highlight a line in the vertical ruler next to the source code and click to set a breakpoint.</p>
<figure>
<img src="./resources/programmers-guide/vscode-breakpoint.png" style="max-width:418px;" title="Toggle a breakpoint." />
</figure>

<h3 id="viewingapplicationstatus">Viewing Application Status</h3>

<p>When your application hits a breakpoint, you can examine the runtime state in <em>Run and Debug</em>. The <em>Variables</em> view allows you to see your arguments and locals, while the <em>Call Stack</em> allows you to see state at different stack frame.</p>

<p>When your application suspends while debugging you will be prompted to open the native <em>Debug</em> perspective. From here, you can view the stack trace within the native Debug view. Clicking on a stack frame within the stack trace will populate the native Variables view with the applicable variables at that stack frame. Global variables will only be visible in the top stack frame; they appear as the <code>$</code> variable within that stack frame.</p>
<figure>
<img src="./resources/programmers-guide/vscode-debugging.png" style="max-width:1141px;" title="Viewing stack trace and variable values." />
</figure>

<h2 id="debuggingwiththecommandline">Debugging with the Command Line</h2>

<p><code>mdd</code> is the Monkey C command line debugger. Modeled after <code>gdb</code>, <code>mdd</code> allows you to load your executables, set breakpoints, and examine stack frames, local variables, and the global environment.</p>

<h3 id="gettingstarted">Getting Started</h3>

<p>Make sure you have followed the &#8220;Getting Started&#8221; instructions to set up the command line environment. Before you begin, start the simulator:</p>

<pre><code class="bash">&gt; simulator &amp;
[1] 27984
&gt; mdd
</code></pre>

<p>You will be greeted with the following:</p>

<pre><code>Connect IQ Version 3.2.0. Type &quot;help&quot; for more information.
(mdd)
</code></pre>

<p>Help is always available from the command line prompt:</p>

<pre><code>(mdd) help
List of classes of commands:

breakpoints -- Making program stop at certain points.
data -- Examining data.
running -- Running the program.
stack -- Examining the stack.
status -- Status inquiries.
support -- Support facilities.

Type &quot;help&quot; followed by a class name for a list of commands in that class.
Type &quot;help all&quot; for the list of all commands.
Type &quot;help&quot; followed by a command name for full documentation.
Command name abbreviations are allowed if defined.
</code></pre>

<h3 id="loadingandrunninganexecutable">Loading and Running an Executable</h3>

<p>To load an executable into <code>mdd</code>, you need the <code>prg</code>, the debug XML and the product the <code>prg</code> is built for. If you compile your <code>prg</code> using the <code>monkeyc</code> command, the <code>debug.xml</code> will also be generated, and Visual Studio Code typically outputs these files in the <code>bin</code> folder of your project.</p>

<p>You use the <code>file</code> command to load these into the <code>mdd</code> environment.</p>

<pre><code>(mdd) file MyFace.prg MyFace.prg.debug.xml fenix6
</code></pre>

<p>Now you can run the executable using the <code>run</code> command:</p>

<pre><code>(mdd) r
Starting app: C:\Projects\ciq-apps\strava\bin\Strava.prg
</code></pre>

<h3 id="settingbreakpoints">Setting Breakpoints</h3>

<p>Breakpoints can be assigned to a file/line pair with the <code>break</code> command:</p>

<pre><code>(mdd) break \path\to\Thx.mc:1138
</code></pre>

<p>Execution will pause when your program executes that line:</p>

<pre><code>Hit breakpoint 1, initialize () at Thx.mc:1138
(mdd)
</code></pre>

<h3 id="frameinformation">Frame Information</h3>

<p>You can inquire about your current stack frame using <code>info frame</code>:</p>

<pre><code>(mdd) info frame
Stack level 0, frame at 0x10002120
 in initialize() at Thx.mc:1138
 called by frame at 0x10000b48
 Args:
      self = &lt;0x84&gt; (Thx)
 Locals:
      thx = null
      sen = null
</code></pre>

<p>You can also use the <code>print</code> command to output variables as well as expressions.</p>

<pre><code>(mdd) print thx
thx = null
</code></pre>

<h3 id="controllingexecution">Controlling Execution</h3>

<p>You can step to the next line using the <code>next</code> command:</p>

<pre><code>(mdd) next
</code></pre>

<p>The <code>step</code> command will step into a subroutine:</p>

<pre><code>(mdd) step
</code></pre>

<p>The <code>continue</code> command will return to full execution until the next breakpoint is set or the app terminates:</p>

<pre><code>(mdd) continue
</code></pre>

<h2 id="handlingcrashes">Handling Crashes</h2>

<p>Despite the best debugging efforts, crashes will sometimes happen. There are two general types of on-device crash that can occur related to Connect IQ, which each generate log files: <em>app crashes</em> and <em>device crashes</em>.</p>

<h3 id="appcrashes">App Crashes</h3>

<p>App crashes typically result in an app quitting unexpectedly or displaying an &#8216;IQ!&#8217; icon, but does not cause the entire device to crash or reboot. This kind of crash is most commonly due to a bug in an app, though it can also be due to a bug in Connect IQ itself. Whenever an app crash occurs, a <code>CIQ_LOG.YAML</code> file is written or updated to <code>/GARMIN/APPS/LOGS</code> on the device, and contains information related to the crash that app developers may use to address the problem. Here is what a CIQ_LOG generally looks like:</p>

<pre><code class="YAML">Error: ErrorName
Details: Error description.
Time: 2018-02-07T19:07:56Z
Store-Id: 00000000-0000-0000-0000-000000000000
Store-Version: 0
Device-Id: 006-B0000-00
Device-Version: '0.00'
ConnectIQ-Version: 3.0.0
Filename: PRGNAME
Appname: DemoAppName
Stack:
  - pc: 0x100000ef
    File: 'C:\Path\To\source\File.mc'
    Line: 53
    Function: function_causing_error
  - pc: 0x10000080
    File: 'C:\Path\To\source\File2.mc'
    Line: 30
    Function: otherBrokenItems
</code></pre>

<p>The <code>ConnectIQ-Version</code> entry is not the Connect IQ version of the device. Rather, this refers to the SDK version used by the developer when exporting the application.</p>

<p><strong>Note:</strong> For devices before API level 3.0.0, a simplified error log will be printed as <code>CIQ_LOG.TXT</code>.</p>

<h3 id="devicecrashes">Device Crashes</h3>

<p>Device crashes typically cause the device to reboot or freeze. These indicate a Connect IQ or device firmware bug, and should be much less common than app crashes. When a device crash occurs, an <code>ERR_LOG.txt</code> file is written to <code>/GARMIN</code> on the device, containing stack trace information related to the crash. Please provide this file when reporting a crash on our developer forum. Garmin&#8217;s device teams can take a look at the device crash logs to determine the cause of the crash and will typically provide a fix in a future firmware release.</p>

<h3 id="anoteaboutlogfiles">A Note About Log Files</h3>

<p>When any log file on a device exceeds 5kb in size, it will automatically be archived to <code>&lt;LOGNAME&gt;.BAK</code>, and a new log will be started. Any old <code>.BAK</code> files will be overwritten when the archive occurs, so the max space a log can reach is around 10kb.</p>

<h1 id="unittesting">Unit Testing</h1>

<p>The Connect IQ SDK has Run No Evil, an automated unit testing framework found in the Test module. Run No Evil operates only within the Connect IQ simulator and provides the ability to add asserts and unit test methods to your app.</p>

<h2 id="asserts">Asserts</h2>

<p>Asserts are a useful way to check for conditions at critical points in your code and will always execute when your app is launched in the simulator. For example, if your app always expects the value of x and y to not be equal:</p>

<pre><code class="typescript">import Toybox.Test;

function onShow() {
  var x = 1;
  var y = 1;
  // Prints an error to the console when x and y are equal
  Test.assertNotEqualMessage(x, y, &quot;x and y are equal!&quot;);
}
</code></pre>

<p>The code above produces the following output in the console when the app is run in the Simulator:</p>

<pre><code class="bash">Device Version 0.1.0
Device id 1 name &quot;A garmin device&quot;
Shell Version 0.1.0
ASSERTION FAILED: x and y are equal!
</code></pre>

<p>Assert code requires no special compiler commands to execute within the simulator, and are removed by the compiler when building release code. Run No Evil has four different assert flavors:</p>

<table>
<colgroup>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Function</th>
	<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td><a href="./doc/Toybox/Test.html#assert-instance_function"><code>Test.assert()</code></a></td>
	<td>Assert throws an exception if the test is false</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Test.html#assert-instance_function"><code>Test.assertMessage()</code></a></td>
	<td>Assert throws an exception and outputs a message if the test is false</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Test.html#assertNotEqual-instance_function"><code>Test.assertNotEqual()</code></a></td>
	<td>Throws an exception if value1 and value2 are not equal</td>
</tr>
<tr>
	<td><a href="./doc/Toybox/Test.html#assertNotEqualMessage-instance_function"><code>Test.assertNotEqualMessage()</code></a></td>
	<td>Throws an exception and outputs a message if value1 and value2 are not equal</td>
</tr>
</tbody>
</table>

<h2 id="unittests">Unit Tests</h2>

<p>Unit tests are a great way to check discrete pieces of your app for pass/fail criteria. Each test is run independently, so if a test fails or causes a crash, the test will be marked as a failed test and the next test will automatically be executed. This allows an entire suite of tests to be run with a single command in an automated fashion.</p>

<p>Unit tests are written mostly like any other class, module, or function in Monkey C, but have the following requirements:</p>

<ul>
<li>Tests methods must be marked with the <code>:test</code> annotation</li>
<li>Test methods must take a <a href="./doc/Toybox/Test/Logger.html"><code>Test.Logger</code></a> object</li>
<li>Tests methods that are not global (part of a test class or custom test module) must be static methods</li>
</ul>

<p>Here is a simple example of a unit test method:</p>

<pre><code class="typescript">// Unit test to check if 2 + 2 == 4
(:test)
function myUnitTest(logger as Logger) as Boolean {
  var x = 2 + 2; logger.debug(&quot;x = &quot; + x);
  return (x == 4); // returning true indicates pass, false indicates failure
}
</code></pre>

<p>The unit tests include a handy logger with different logging levels for more meaningful error reporting. The sample code above uses a &#8220;debug&#8221; logging level, but the Logger contains a total of three logging levels that can be used to distinguish between different types of errors in your unit test output:</p>

<ul>
<li><a href="./doc/Toybox/Logger.html#debug-instance_function"><code>Logger.debug()</code></a></li>
<li><a href="./doc/Toybox/Logger.html#warning-instance_function"><code>Logger.warning()</code></a></li>
<li><a href="./doc/Toybox/Logger.html#debug-instance_function"><code>Logger.error()</code></a></li>
</ul>

<p>While unit tests are defined in program source code, they are not included in debug or release executables.</p>

<h3 id="runningunittestsfromthemonkeycextension">Running Unit Tests from the Monkey C Extension</h3>

<p>The Monkey C Extension Test Explorer provides a powerful user interface for executing unit tests on your application. You can initiate the test explorer by clicking on the test tube icon on the left. When you start the test explorer, it will enumerate all tests in the code and list them by the module and class they belong to. You can configure which products you want to test by right clicking on an element and selecting <em>Configure Devices</em>.</p>

<p>Hitting the play button on a list element will run that test or the collection of tests contained by that element. The test output will be directed to the <em>Test Results</em> tab next to the terminal section.</p>

<h3 id="runningunittestsfromthecommandline">Running Unit Tests from the Command Line</h3>

<p>If you want to run unit tests on your application, build the app with the <code>--unit-test</code> flag on the build command to compile with unit tests. It&#8217;s usually easiest to copy and paste the build command from the Visual Studio Code console and add the unit test flag. Then use the <code>connectiq</code> script in your SDK&#8217;s bin directory to launch the simulator from the terminal (no arguments required), and use the <code>monkeydo</code> script in your SDK&#8217;s bin directory with the <code>/t</code> flag to run the app with unit tests enabled - <code>monkeydo.bat path\to\projects\bin\MyApp.prg /t</code></p>

<p>You may also supply a function name after /t to run the test associated with a single function. The sample unit test above produces the following output in the console:</p>

<pre><code class="bash">Device Version 0.1.0
Device id 1 name &quot;A garmin device&quot;
Shell Version 0.1.0
\------------------------------------------------------------------------------
Executing test myUnitTest…
DEBUG (14:16): x = 4
Pass
==============================================================================
RESULTS
Test:              Status:
myUnitTest           Pass
Ran 1 test
PASSED (failures=0, errors=0)
Connection Finished
Closing shell and port
</code></pre>

<p>If you want to run tests in your <a href="./CoreTopics.html#shareablelibraries">monkey barrel</a>, you can use the <code>barreltest</code> script. It supports the <a href="./LearningMonkeyC.html/#compileroptions">same options</a> as the compiler, but can output a PRG that can be used by the test system.</p>

<p>Unit test code will not execute unless the compiler is explicitly told to run unit tests. All test code is automatically removed at compile time when your app is exported for use on devices.</p>

<h1 id="errorreportingapplicationera">Error Reporting Application (ERA)</h1>

<p>The ERA tool can be used to view your app&#8217;s crashes after it has been released on the store. If your app crashes on a device the error report will be collected and aggregated by the ERA server. These reports can be viewed for up to 30 days after a crash occurs. This tool is available in the bin folder of the SDK.</p>

<h2 id="gettingstarted-1">Getting Started</h2>

<p>To launch the graphical ERA tool, either run the <em>Monkey C: Start ERA Viewer</em> command from the command palette of Visual Studio Code or run <code>era.jar</code> from the bin/ folder of the SDK. When first running the tool, the <em>Manage Developers</em> window will appear. To use the tool, you must first add a developer identity.</p>

<h3 id="commandline">Command Line</h3>

<p>The ERA tool can be launched from the command line to retrieve crashes for a single app. This will output the crashes for the given app in a JSON format.</p>

<pre><code>&gt; era [-a &lt;arg&gt;] [-k &lt;arg&gt;]

</code></pre>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Argument</th>
	<th style="text-align:left;">Definition</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>-a &lt;arg&gt;</code></td>
	<td style="text-align:left;">The app UUID to retrieve crashes for</td>
</tr>
<tr>
	<td style="text-align:left;"><code>-k &lt;arg&gt;</code></td>
	<td style="text-align:left;">Developer key for the given app</td>
</tr>
</tbody>
</table>

<h2 id="addinganewdeveloper">Adding a New Developer</h2>
<figure>
<img src="./resources/programmers-guide/era_manage_developers.png" style="max-width:563px;" title="Add Developer Window" />
</figure>

<p>The Manage Developers window lists all the known developer identities. In this window, you can add a developer, remove a developer, or get information about a selected developer. You can launch this window by selecting <strong>Settings &gt; Manage Developers</strong> in the menu. If you add any new apps for a developer identity, they will be fetched the next time the ERA viewer is opened.</p>

<p>To add a developer, first click on the <strong>+</strong> button. This will bring up the Add Developer window.</p>
<figure>
<img src="./resources/programmers-guide/era_add_developer.png" style="max-width:563px;" title="Add Developer Window" />
</figure>

<p>In this window, you will need to enter a developer ID and an optional Default Developer Key. If a default developer key is entered, then any new apps for this developer will automatically be assigned this key. If you use multiple keys for your apps, you can override the default key for each app. To obtain your developer ID search for your apps in the app store and click on your developer name. The URL for this page will contain your developer ID. For example, if the URL is https://apps.garmin.com/en-US/developer/e1683f31&#8211;54fe&#8211;45d9&#8211;9aa8-cba39fe7fd1f/apps then the developer ID is e1683f31&#8211;54fe&#8211;45d9&#8211;9aa8-cba39fe7fd1f. To remove a developer click on the <strong>-</strong> button. This will remove the developer and all its apps from the ERA tool. To view information about a developer click on the <strong>+</strong> button. This will bring up the Edit Developer window.</p>
<figure>
<img src="./resources/programmers-guide/debug_variables_view.png" style="max-width:806px;" title="Viewing stack trace and variable values." />
</figure>

<h2 id="viewingappsettings">Viewing App Settings</h2>
<figure>
<img src="./resources/programmers-guide/era_manage_apps.png" style="max-width:563px;" title="Add Developer Window"  />
</figure>

<p>The Manage Apps window allows you to see the apps for all the known developers. You can launch this window by selecting <strong>Settings &gt; Manage Apps</strong> in the menu. The list of apps is color coded to allow easy identification of an app&#8217;s status.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Font Style</th>
	<th style="text-align:left;">App Status</th>
	<th style="text-align:center;">Crashes Viewable</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Normal</td>
	<td style="text-align:left;">Released app</td>
	<td style="text-align:center;">Yes</td>
</tr>
<tr>
	<td style="text-align:left;">Gold</td>
	<td style="text-align:left;">Beta app</td>
	<td style="text-align:center;">Yes</td>
</tr>
<tr>
	<td style="text-align:left;">Red</td>
	<td style="text-align:left;">Invalid key for the app</td>
	<td style="text-align:center;">No</td>
</tr>
<tr>
	<td style="text-align:left;">Strikethrough</td>
	<td style="text-align:left;">App is hidden</td>
	<td style="text-align:center;">No</td>
</tr>
</tbody>
</table>

<p>In this window you can add additional apps, rearrange the apps, and change an app&#8217;s settings. To add new apps, click on the <strong>+</strong> button to bring up the Manage Developers window. After adding a new developer will download all the apps for them to the ERA tool. To rearrange the order of the apps, click on an app and click on the <strong>&and;</strong> or <strong>&or;</strong> buttons. The order of the apps in this window are reflected in the app selection box in the crash report view. To change an app&#8217;s settings choose the app in the list and click on the <strong>i</strong> button.</p>
<figure>
<img src="./resources/programmers-guide/era_app_info.png" style="max-width:563px;" title="Add Developer Window"  />
</figure>

<p>In the Application Settings window you can change the developer key used for this app as well as hide the app from the drop down box in the crash report view. The app&#8217;s developer key will override the default developer key set for the developer. If the <strong>Hide this app</strong> box is checked then the app will not be shown in the crash report view app list.</p>

<h2 id="viewingcrashreports">Viewing Crash Reports</h2>
<figure>
<img src="./resources/programmers-guide/era_report_view.png" style="max-width:563px;" title="ERA report view" />
</figure>

<p>The crash report view allows you to view all uploaded crash reports for an app in the last 30 days. At the top of this window you can select which app&#8217;s crash reports to view. After selecting an app the latest reports will be downlaoded from the server. In the left pane of the window a list of crash reports will be shown. Each unique crash will be identified by file name, function, and line number where the crash occurred. Choosing a crash in the left pane causes the details for the crash to be shown in the right pane. At the top of the right pane the <strong>Fixed</strong> checkbox can be used to indicate that this particular crash has been fixed. The fixed status will persist across application runs and SDK upgrades.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Font Style</th>
	<th style="text-align:left;">Crash Status</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">Normal</td>
	<td style="text-align:left;">Crash has been viewed.</td>
</tr>
<tr>
	<td style="text-align:left;">Bold</td>
	<td style="text-align:left;">Crash has not been viewed.</td>
</tr>
<tr>
	<td style="text-align:left;">Strikethrough</td>
	<td style="text-align:left;">Crash has been marked as fixed.</td>
</tr>
</tbody>
</table>

<h1 id="profilingapplications">Profiling Applications</h1>

<p>The Connect IQ profiler captures time spent in total within a function and for the
code within a function, and lets you examine the different call stacks
profiled. The profiler is integrated into the simulator, and the devices will
allow hardware profiling as well.</p>

<h2 id="profilingfromthesimulator">Profiling from the Simulator</h2>

<p>To launch the profiler from the Simulator, go to <em>File -&gt; View Profiler</em>. You will see the following:</p>
<figure>
<img src="./resources/programmers-guide/profiler-empty.png" style="max-width:1281px;" title="The Connect IQ Profiler" />
</figure>

<p>When you reach the point in your application you wish to profile, hit the “Start”
button to begin data collection and hit “Stop” to finish. The data will then display
in the profiler window:</p>
<figure>
<img src="./resources/programmers-guide/profiler.png" style="max-width:1281px;" title="The Connect IQ Profiler with Numbers" />
</figure>

<p>The data collected is as follows:</p>

<table>
<colgroup>
<col/>
<col/>
<col/>
</colgroup>

<thead>
<tr>
	<th>Name</th>
	<th>Description</th>
	<th>Notes</th>
</tr>
</thead>

<tbody>
<tr>
	<td>Function</td>
	<td>The function signature being called</td>
	<td></td>
</tr>
<tr>
	<td>Total Time (us)</td>
	<td>The total time executing the function in microseconds.</td>
	<td>This includes all calls during the capture duration.</td>
</tr>
<tr>
	<td>Actual Time (us)</td>
	<td>The time spent within the function in microseconds.</td>
	<td>This includes all calls during the capture duration, but ignores time spent calling other functions.</td>
</tr>
<tr>
	<td>Average Time (us)</td>
	<td>The average amount of time per call spent in the function in microseconds</td>
	<td>This is the average of the time to execute the function</td>
</tr>
<tr>
	<td>Call Count</td>
	<td>Number of times the function was called during the sample period</td>
	<td></td>
</tr>
<tr>
	<td>Call Stack</td>
	<td>Indication of which functions invoked the sampled function</td>
	<td></td>
</tr>
</tbody>
</table>

<p>If you only want to sample for a period, you can set a sample period in <em>Profiler -&gt; Settings</em>. This will automatically stop the profiler after the specified period.</p>

<h2 id="profilingonthedevice">Profiling on the Device</h2>

<p>You can profile your app on device by compiling the app with the <code>-k</code> option. To do this in Visual Studio Code, edit the workspace settings edit the Monkey C Compiler Options:</p>
<figure>
<img src="./resources/programmers-guide/profiler-command-line.png" style="max-width:718px" title="-k option" />
</figure>

<p>After you do that, use <em>Monkey C: Build for Device</em> to create an executable. After you side load and run the program, a file named <code>&lt;appname&gt;.PRF</code> will be generated in the <code>GARMIN\APPS\LOGS</code> folder. You can load the PRF file into the simulator profile tool for analysis using the <em>Load</em> button in the profiler window.</p>

<h2 id="bestpractices-1">Best Practices</h2>

<p>You can re-sort the sampled functions based on the total, actual, and average time spent as well as call count. Each can have value in identifying performance bottlenecks. For example, a function that has a low average time but is repeatedly called can sometimes cause performance bottlenecks. See what functions your application are spending the most time running and use that to focus your optimization efforts.</p>

<h1 id="publishingtotheconnectiqstore">Publishing to the Connect IQ Store</h1>
<figure>
<img src="./resources/programmers-guide/captain-monkey.png" style="max-width:300px;" title="Just sit back now and you'll hear a tale; a tale of a fateful trip..." />
</figure>

<p>We&#8217;re glad you want to develop for Garmin devices, and we want you to be successful. Be sure to <a href="http://developer.garmin.com/connect-iq/app-review-guidelines">review our guidelines</a> and keep them in mind as you develop your apps.</p>

<p>Once your apps are fully tested and ready to go, you can publish and promote your apps to the Garmin Connect IQ App Store. Here&#8217;s how to prepare your apps for submission.</p>

<ol>
<li>Make sure the manifest file specifies all products supported by the app</li>
<li>Use the <em>Monkey C: Export Project</em> command to generate an IQ file, which will contain binaries for each supported device</li>
<li>Upload the app to the App Store</li>
</ol>

<h2 id="checksupportedproducts">Check Supported Products</h2>

<p>It is easy to quickly check the products supported by an app by viewing the manifest XML file in the project root:</p>

<pre><code class="xml">&lt;iq:products&gt;
    &lt;iq:product id=&quot;fenix3&quot;/&gt;
    &lt;iq:product id=&quot;vivoactive&quot;/&gt;
    &lt;iq:product id=&quot;fr920xt&quot;/&gt;
    &lt;iq:product id=&quot;epix&quot;/&gt;
&lt;/iq:products&gt;
</code></pre>

<h2 id="exportingtheapp">Exporting the App</h2>

<p>Launch the Export Wizard with the <em>Monkey C: Export Project</em> command in the command palette. After setting the export destination folder the Monkey C extension will generate the <code>.iq</code> file of your project.</p>

<h2 id="publishingthefirstversion">Publishing the First Version</h2>

<p>To upload the IQ file to your developer account, start by visiting the <a href="http://developer.garmin.com/connect-iq/submit-an-app/">Submit an App</a> page of the Garmin Developer site. Click on the <em>Submit an App</em> button to fill out the form shown below:</p>
<figure>
<img src="./resources/programmers-guide/upload_app.png" style="max-width:600px;" title="Uploading an app to the App Store" />
</figure>

<p>Once the IQ file has been validated, add in a description, screen shots, and other details about your app:</p>
<figure>
<img src="./resources/programmers-guide/title_description.png" style="max-width:600px;" title="Adding a title and description" />
</figure>

<h2 id="gdpr">GDPR</h2>

<p>In April of 2016, the EU Parliament passed the <a href="https://publications.europa.eu/en/publication-detail/-/publication/3e485e15-11bd-11e6-ba9a-01aa75ed71a1/language-en">General Data Protection Regulation</a> (GDPR), an act that was designed to harmonize data privacy laws across the European Union (EU). The GDPR provides requirements for the lawful processing of EU Personal Data, including requirements related to data privacy, consent, and digital services. GDPR generally applies to the processing of EU Personal Data, and it may apply to you or your company even if you are not in the EU. Data protection authorities may issue fines up to 4% of annual global turnover or €20 Million, whichever is greater, for non-compliance. . This isn&#8217;t legal advice and we encourage you to consult with your legal counsel for guidance.</p>

<p>Connect IQ is a global platform, and, as stated in the <a href="https://developer.garmin.com/connect-iq/sdk">Connect IQ license agreement</a>, developers are responsible for their apps&#8217; compliance with all applicable laws, including those related to data protection and privacy. Specific responsibilities related to privacy can be found in Section 2 of the <a href="https://developer.garmin.com/connect-iq/sdk">Connect IQ license agreement</a>. Developers should review the GDPR to determine what obligations they may have under the GDPR. These obligations may include the following:</p>

<ul>
<li>Asking for consent for collection of personal data.</li>
<li>Providing access to information on what personal data concerning them is being processed, where and for what purpose.</li>
<li>Providing access to any personal data collected from them free of charge.</li>
<li>Ability for a user to erase their presence entirely within your product, including the ability to halt third party processing of personal data.</li>
</ul>

<p>If your solution collects personal data in any way, including using the <code>Communications</code> permission to collect or retain personal data (potentially in conjunction with <code>Sensor</code>, <code>Sensor History</code>, or <code>Position</code> permissions) or using any other mechanism, you are responsible for ensuring that your solution is in compliance with GDPR.</p>

<h2 id="approvalprocess">Approval Process</h2>

<p>After your app is successfully uploaded to the app store, the Connect IQ team will review your submission. Aside from special circumstances, such as national holidays, reviews are completed within 72 hours.</p>

<p>If you indicate your app uses one or more ANT+ profiles, an additional 48 hours is typically required to complete ANT+ certification. Once certification is complete, we&#8217;ll provide ANT+ branding information and a link to the <a href="https://www.thisisant.com/directory">ANT+ Directory</a> to add to your app&#8217;s description on the store.</p>

<p>While approval is pending, your app will not appear on the Garmin Connect App Store, but you will be able to preview your app and download it yourself for testing. Once it&#8217;s approved, you will receive a notification and it will appear on the Connect IQ App Store for all users to download and load to their devices!</p>

<p>If for some reason your app is rejected, don&#8217;t despair! The Connect IQ team will provide specific reasons for the rejection via email, and may work with you to resolve issues. The app will continue to be available for you to update as needed and re-submit for approval, but it will not be displayed on the Connect IQ App Store until approved.</p>

<h1 id="betaapps">Beta Apps</h1>
<figure>
<img src="./resources/programmers-guide/beta_app.png" style="max-width:275px;" title="This is for testing purposes only" />
</figure>

<p>Connect IQ beta apps allows developers to test app settings and Garmin Connect integration in production without releasing the app.</p>

<p>Uploading a beta app will let you stage your app in production. To use this feature, you will need to create an alternate app id in your manifest using a <a href="https://www.uuidgenerator.net/">UUID creator</a>. Beta apps will show up in your uploaded apps, and you can download them to your Garmin device. Once downloaded you can edit app settings in Garmin Connect and Garmin Express and test your developer fields in Garmin Connect. After you upload the beta app, you can update the beta version as many times as you want. When you are ready to release the app, change the app id to your production version in the manifest and upload it without checking the &#8220;Beta App&#8221; checkbox. Note that the app will have a separate store identifier from your final app, and URLs to the beta will not be visible outside of your account.</p>

<h1 id="apptrials">App Trials</h1>

<p><em>Since API level 2.3.0</em></p>

<p>The app trials feature allows developers to enable a special &#8220;trial&#8221; mode for their app. Enabling trial mode is accomplished by adding a new tag to the manifest under the application tag as follows:</p>

<pre><code class="xml">&lt;iq:application entry=&quot;CommExample&quot; id=&quot;a3421feed289106a538cb9547ab12095&quot;
        name=&quot;AppName&quot; launcherIcon=&quot;LauncherIcon&quot; type=&quot;widget&quot; minSdkVersion=&quot;1.3.1&quot;&gt;
    &lt;iq:trialMode enable=&quot;true&quot;&gt;
        &lt;iq:unlockURL&gt;https://a.custom.unlock.url.info&lt;/iq:unlockURL&gt;
    &lt;/iq:trialMode&gt;
&lt;/iq:application&gt;
</code></pre>

<p>The unlock URL provides an endpoint for the app store to redirect the user to in order go through whatever you want your app &#8220;unlock&#8221; process to be. The app store will only accept secured HTTPS-URLs when uploading your iq-file. Also make sure that the enable-attribute of the <code>trialMode</code> tag is set to &#8220;true&#8221;.</p>

<p>The app trials feature is not supported for watch faces.</p>

<h2 id="trialmodefunctionality">Trial Mode Functionality</h2>

<p>Developers can query the <a href="./doc/Toybox/Application/AppBase.html#isTrial-instance_function"><code>AppBase.isTrial()</code></a> method to determine if trial mode is active for their app, which can be used to trigger special trial-mode functionality. App trials can also be time-based. The method <a href="./doc/Toybox/Application/AppBase.html#getTrialDaysRemaining-instance_function"><code>AppBase.getTrialDaysRemaining()</code></a> should be overridden if you wish to support a time-based trial. <a href="./doc/Toybox/Application/AppBase.html#getTrialDaysRemaining-instance_function"><code>getTrialDaysRemaining()</code></a> must return a <a href="./doc/Toybox/Lang/Number.html"><code>Number</code></a> that represents how many days are remaining in the trial, or null if time-based trials are to be disabled. If <code>0</code> is returned, the app will be prevented from running as the trial will be considered &#8220;expired&#8221;.</p>

<p>By default, when an app is in trial mode, the system will push special trial notifications to the use either to inform them of how many days remain in their trial (if you&#8217;ve overridden <a href="./doc/Toybox/Application/AppBase.html#getTrialDaysRemaining-instance_function"><code>getTrialDaysRemaining()</code></a> to return a non-null value), or more generally that trial mode is active. If you do not wish for these notifications to be displayed to the user, you can override <a href="./doc/Toybox/Application/AppBase.html#allowTrialMessages-instance_function"><code>AppBase.allowTrialMessages()</code></a> to return <code>false</code>.</p>

<h2 id="trialappserverapi">Trial App Server API</h2>

<p>Once the app is available in the store, the user can unlock the app by clicking on the unlock button in the store. At this point, the app store will redirect to the provided unlock-URL, adding these parameters to the URL:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Parameter Name</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><code>callbackUrl</code></td>
	<td style="text-align:left;">The URL that has to be called back when the unlock-process on your side successfully finished.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>appUnlockRequestId</code></td>
	<td style="text-align:left;">The app store&#8217;s internal unlock-ID which can be stored by the app-developer as reference.</td>
</tr>
<tr>
	<td style="text-align:left;"><code>appPageUrl</code></td>
	<td style="text-align:left;">The app details page of the app to be unlocked. You should redirect to this page after a successful call to the callback-URL, and ask the user to download the unlocked app for his desired device.</td>
</tr>
</tbody>
</table>

<p>So this is what a typical/complete call from the app store to your unlock-URL will look like:</p>

<pre><code>https://your.unlock.url.com?appUnlockRequestId=1fe443e5-e76c-4e1c-b82b-2d084bd4c4fe&amp;callbackUrl=https%3A%2F%2Fapps.garmin.com%2FappUnlock%3FappUnlockRequestId%3D1fe443e5-e76c-4e1c-b82b-2d084bd4c4fe&amp;appPageUrl=https%3A%2F%2Fapps.garmin.com%2Fen-US%2Fapps%2Fbf1d944a-8a54-41fa-b7b0-24e651dc88e1
</code></pre>

<p>Both the <code>callbackUrl</code> and the <code>appPageUrl</code> will be passed in URL-encoded form.</p>

<h2 id="howtousethecallbackurl">How to use the <code>callbackUrl</code></h2>

<p>The <code>callbackUrl</code>-endpoint is secured and can only be used with a (one-legged) OAuth1-signed request.</p>

<p>For this you&#8217;ll need to obtain your individual set of key/secret credentials from the app store&#8217;s &#8220;Developer Dashboard&#8221;:</p>

<p>With these credentials you simply create a standard OAuth1-request and fire it to the callback-URL.
(Using a framework which generates all the necessary OAuth-HTTP-Headers is recommended.)</p>

<p>A straightforward Java example (using the Signpost-library, and Apache&#8217;s HttpClient) would look like this:</p>

<pre><code class="java">HttpGet request = new HttpGet(&quot;callbackUrl&quot;);

OAuthConsumer consumer = new CommonsHttpOAuthConsumer(&quot;yourKey&quot;, &quot;yourSecret&quot;);
consumer.sign(request);

HttpClient client = HttpClientBuilder.create().build();
HttpResponse response = client.execute(request);

System.out.println(&quot;Return code: &quot; + org.springframework.http.HttpStatus.valueOf(response.getStatusLine().getStatusCode()));
</code></pre>

<p>The following return-codes can be expected:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Status Code</th>
	<th style="text-align:left;">Status Phrase</th>
	<th style="text-align:left;">Description</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">200</td>
	<td style="text-align:left;">OK</td>
	<td style="text-align:left;">Everything worked just fine; the app got marked as &#8220;unlocked&#8221; for the user.</td>
</tr>
<tr>
	<td style="text-align:left;">202</td>
	<td style="text-align:left;">Accepted</td>
	<td style="text-align:left;">When making a successful test-request (see below).</td>
</tr>
<tr>
	<td style="text-align:left;">401</td>
	<td style="text-align:left;">Unauthorized</td>
	<td style="text-align:left;">When the authorization (OAuth) was incorrect.</td>
</tr>
<tr>
	<td style="text-align:left;">404</td>
	<td style="text-align:left;">Not Found</td>
	<td style="text-align:left;">When the requested unlock item was not found.</td>
</tr>
<tr>
	<td style="text-align:left;">409</td>
	<td style="text-align:left;">Conflict</td>
	<td style="text-align:left;">When an app is already being marked as unlocked in the app store.</td>
</tr>
<tr>
	<td style="text-align:left;">410</td>
	<td style="text-align:left;">Gone</td>
	<td style="text-align:left;">When an app is orphaned (e.g. because the app changed ownership due to GDPR).</td>
</tr>
<tr>
	<td style="text-align:left;">510</td>
	<td style="text-align:left;">Internal Server Error</td>
	<td style="text-align:left;">When an unexpected error occurred.</td>
</tr>
</tbody>
</table>

<p>You can test your OAuth-implementation without the need of an actual unlock-request.</p>

<p>Just make a signed call using your credentials and &#8220;test&#8221; as <code>appUnlockRequestId</code>.</p>

<pre><code>https://apps.garmin.com/appUnlock?appUnlockRequestId=test
</code></pre>

<p>When receiving a 202, you can be sure that your OAuth-handling is working.</p>

<h1 id="requestingreviews">Requesting Reviews</h1>

<p>As a developer, you want your users to review your apps after they&#8217;ve had positive experiences. Ideally this would be a low-friction experience to maximize the number of users who leave positive reviews.</p>

<p>For compatible devices, the steps to leave a review are as follows:</p>

<ul>
<li>Request a review token</li>
<li>Receive a token from the store</li>
<li>Initiate the review process</li>
</ul>

<h2 id="requestingareviewtoken">Requesting a Review Token</h2>

<p>To prevent user harassment, apps must request permission from the app store to perform a review request. The app store validates a number of factors, including if you have recently requested a review from a user and if the user is using the most recent version of the app. The token request can be made with the <a href="./doc/Toybox/WatchUi.html#makeReviewTokenRequest-instance_function"><code>WatchUi.makeReviewTokenRequest()</code></a> call. This call is asynchronous, and you must provide this call with a <a href="./doc/Toybox/Lang/Method.html"><code>Lang.Method</code></a> callback to capture the response.</p>

<h2 id="receivingthetoken">Receiving the Token</h2>

<p>When the server responds to your review request, your callback will be invoked with the server response code and optionally the review tokens. The response codes are as follows:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Response</th>
	<th style="text-align:left;">Description</th>
	<th style="text-align:center;">API Level</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">REVIEW_REQUEST_STATUS_GRANTED</td>
	<td style="text-align:left;">Request is granted, and token has been provided</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">REVIEW_REQUEST_STATUS_DENIED</td>
	<td style="text-align:left;">User does not meet review requirements</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
<tr>
	<td style="text-align:left;">REVIEW_REQUEST_STATUS_FAILED</td>
	<td style="text-align:left;">Cannot make review request at this time</td>
	<td style="text-align:center;">4.2.0</td>
</tr>
</tbody>
</table>

<p>If you receive a token it should be valid for the current day.</p>

<h2 id="requestingthereview">Requesting the Review</h2>

<p>When you are ready for the user to review the app, you can use <a href="./doc/Toybox/WatchUi.html#startUserReview-instance_function"><code>WatchUi.startUserReview()</code></a> with the valid token from a token response. This will transition the user to the review flow.</p>

<h2 id="tips">Tips</h2>

<p>Keep track of the user&#8217;s positive and negative experiences, and request reviews only if the user is having a net positive experience with the app. Harassing the user to leave positive reviews can lead them to leave negative reviews, which defeats the purpose of asking them to review your app.</p>

<div class="footnotes">
<hr />
<ol>

<li id="fn:1">
<p>Communication requires the background permission to be enabled, but Authentication does not <a href="#fnref:1" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:2">
<p>Only widgets and apps are allowed to call <code>enableLocationEvents</code> <a href="#fnref:2" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:3">
<p>I don&#8217;t care if they changed their name; &#8220;Meta&#8221; can&#8217;t take &#8220;meta&#8221; away from us, which admittedly is kind of meta <a href="#fnref:3" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:4">
<p>Connect IQ&#8217;s hottest API is <a href="./doc/Toybox/System.html#getDeviceSettings-instance_function"><code>getDeviceSettings()</code></a>. This API has everything: user alarms, device settings, connection state, units, Connect IQ API level, monkeys&#8230; <a href="#fnref:4" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:5">
<p>Music-capable wearables never skip leg day <a href="#fnref:5" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:6">
<p>Non-music wearables are on RAM keto <a href="#fnref:6" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:7">
<p>Time operates half as fast in the setting within the setting. You might want to spin your top now. <a href="#fnref:7" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:8">
<p>Yes, really. <a href="#fnref:8" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:9">
<p>I&#8217;m so glad I wasn&#8217;t the one <a href="https://www.reddit.com/r/EngineeringStudents/comments/dl6hfz/to_all_my_fellow_civil_engineers_i_give_you_ed/">to come up with this</a>. <a href="#fnref:9" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:10">
<p>Graphical titles are currently only supported via programmatic creation of <code>MenuItem</code> elements in <code>Menu2</code>. Defining a title as a drawable resource will result in compiler error. <a href="#fnref:10" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:11">
<p><code>WatchUi</code> wasn&#8217;t accessible by background services so we moved it. <a href="#fnref:11" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:12">
<p>We stan a sub-screen icon. QUEEN! <a href="#fnref:12" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:13">
<p>Their own language and their own video file format? Who do these people think they are? <a href="#fnref:13" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:14">
<p><code>FLASHLIGHT_STROBE_MODE_FUNKADELIC</code> may come in a future update. <a href="#fnref:14" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:15">
<p>Could also be defined as <code>☀🔆🌥   ☀🔆🌥   ☀🔆🌥</code>. <a href="#fnref:15" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:16">
<p>I can&#8217;t tell you what the differences are. Sometimes our job is to just abstract the thing and not ask questions. <a href="#fnref:16" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:17">
<p>Developers may also check the <em>Auto read memory</em> checkbox to have the device memory read automatically each time an action is taken. <a href="#fnref:17" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:18">
<p>MillivaniliGauss was the authors high school rap duo. <a href="#fnref:18" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:19">
<p>Not to be confused with the Pedropascals used as a measure of &#8220;cool&#8221;. This author measures 20 picoPedropascals. <a href="#fnref:19" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:20">
<p>namaste <a href="#fnref:20" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:21">
<p>Number 6&#8217;s argument of &#8220;I am not a number, I am a free man!&#8221; never met Garmin Connect <a href="#fnref:21" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

<li id="fn:22">
<p>🎵 &#8230;and I would walk five hundred miles / and I would walk five hundred more / just to be the man who walks a thousand miles / and beats my Connect step challenge 🎵 <a href="#fnref:22" title="return to article" class="reversefootnote">&#160;&#8617;</a></p>
</li>

</ol>
</div>


</body>
</html>
